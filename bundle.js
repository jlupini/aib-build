(()=>{"use strict";var t={11:(t,e,o)=>{o.d(e,{A:()=>T});var r=o(601),n=o.n(r),i=o(314),a=o.n(i),s=o(417),l=o.n(s),c=new URL(o(373),o.b),d=new URL(o(29),o.b),u=new URL(o(234),o.b),p=new URL(o(946),o.b),g=new URL(o(489),o.b),f=new URL(o(487),o.b),h=new URL(o(934),o.b),y=new URL(o(728),o.b),O=new URL(o(663),o.b),m=a()(n()),S=l()(c),R=l()(d),w=l()(u),_=l()(p),x=l()(g),k=l()(f),v=l()(h),E=l()(y),b=l()(O);m.push([t.id,`body{background-color:#faf9f7;margin:0;font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;overflow-y:hidden}body.body-scroll{overflow-y:auto}body.body-scroll main{height:auto;overflow-y:unset}nav{background-color:#faf9f7;box-shadow:0 2px 4px 0 rgba(0,0,0,.1);padding:22px 0;position:fixed;left:0;width:100%;z-index:1000;top:0;display:flex;position:sticky;top:0;z-index:1000}main{padding:0 0;position:relative;z-index:500;height:calc(100vh - 100px - 44px);overflow-y:auto}main::after{content:"";border-right:10px dashed #dad9d8;display:block;width:15%;min-width:265px;height:100%;left:17px;top:0;position:absolute}main.side-view>.sticky-wrapper{min-height:1000px;width:30%;margin-left:22px;min-width:530px;position:relative}main.side-view>.sticky-wrapper.extra-long{min-height:1500px}main.side-view>.sticky-wrapper .content-block{position:sticky;top:122px;width:auto;margin:0 0 160px}main.side-view>.sticky-wrapper .minor-trigger{position:absolute;top:100%;left:50%;transform:translateX(-50%);width:20px;height:20px;border-radius:50%;border:5px solid #faf9f7;background-color:#d8d8d8;z-index:100;transition:background-color .5s ease-out}main.side-view>.sticky-wrapper .minor-trigger.active{box-shadow:0 0 10px 0 rgba(0,200,255,.4)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.1"]{margin-top:calc(-90% - 144px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.2"]{margin-top:calc(-80% - 128px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.3"]{margin-top:calc(-70% - 112px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.4"]{margin-top:calc(-60% - 96px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.5"]{margin-top:calc(-50% - 80px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.6"]{margin-top:calc(-40% - 64px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.7"]{margin-top:calc(-30% - 48px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.8"]{margin-top:calc(-20% - 32px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.9"]{margin-top:calc(-10% - 16px)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="1.0"]{margin-top:calc(-5% - 8px)}main.side-view #chart1{top:0;right:0;left:auto;width:calc(100% - 30% - 22px);height:100vh;z-index:-1}main.side-view #progress-bar{position:fixed;top:80px;left:0;width:100%;height:20px;background-color:#eee;opacity:.8;z-index:1000;transition:opacity .3s ease-in-out}main.side-view #progress-bar.hidden{opacity:0}main.side-view #progress-bar #progress-bar-fill{height:100%;width:0;background-color:rgba(255,0,255,.3);transition:width .3s ease-in-out}main .content-block{pointer-events:auto}main .spacer-block{height:1000px}.dot-legend{font-family:"Inter",sans-serif}.scrolling-images{display:flex;position:absolute;left:0;top:100%;width:100%;justify-content:center;gap:20px;align-items:flex-start}.content-block.active .invitations{transition:opacity .3s,transform .3s}.invitations{display:inline-block;border-radius:8px;border:#ffc803 solid 3px;margin:40px 0;width:calc(50% - 20px);opacity:.1;transition:opacity 2s,transform .3s;z-index:1000;flex:1 1 auto;background-color:#ffc803}.invitations:hover{opacity:1;transition:opacity .3s,transform .3s;transform:scale(1.75) translate(20%, -15%);z-index:10000}.invitations:hover .image{height:247px}.invitations:hover .image.liberal-invite{background-image:url(${S})}.invitations:hover .image.conservative-invite{background-image:url(${R});height:205px}.invitations img,.invitations .image{display:block;width:100%;height:150px;max-width:100%;border-radius:7px;background-size:cover;background-position:center top;transition:background-image .5s ease-in-out,height .3s ease-in-out;transition-delay:.1s}.invitations img.liberal-invite,.invitations .image.liberal-invite{background-image:url(${w})}.invitations img.conservative-invite,.invitations .image.conservative-invite{background-image:url(${_})}.invitations .invitation-text{font-size:.8rem;color:#231f20;text-align:center;padding:10px}.content-block{position:relative;top:0;z-index:800;background-color:hsla(0,0%,100%,.5);padding:30px 30px 20px;width:50%;margin:200px auto 1000px;box-shadow:0 0 4px 0 rgba(0,0,0,.1);backdrop-filter:blur(3px);transition:background-color .3s,box-shadow .3s,opacity .3s,transform .3s;transform:translateX(-20px);border-radius:10px;opacity:.9}.content-block h1,.content-block h2,.content-block h3,.content-block h4,.content-block h5{opacity:.3}.content-block h2 .inline-voter-dot{width:26px;height:26px;top:-1px}.content-block h3 .inline-voter-dot{width:15px;height:15px}.content-block a.logo-link img{display:block;width:50%;position:relative;margin:0 auto 10px}.content-block:hover{background-color:hsla(0,0%,100%,.8);opacity:1}.content-block:hover h1,.content-block:hover h2,.content-block:hover h3,.content-block:hover h4,.content-block:hover h5{opacity:1}.content-block .minor-trigger-text{position:relative;transition:opacity .8s ease-in-out,max-height 1s ease-in-out,filter .8s ease-in-out,-webkit-filter .8s ease-in-out;-webkit-filter:blur(10px);filter:blur(10px)}.content-block .minor-trigger-text.active{-webkit-filter:blur(0px);filter:blur(0px)}.content-block.active{transform:translateX(0);box-shadow:0 -2px 4px 0 rgba(0,0,0,.1),1px 1px 19px rgba(0,200,255,.4);backdrop-filter:blur(5px);opacity:1}.content-block.active h1,.content-block.active h2,.content-block.active h3,.content-block.active h4,.content-block.active h5{opacity:1}.content-block.active .invitations{opacity:1}.content-block.active .minor-trigger-text{opacity:.2}.content-block.active .minor-trigger-text.active{opacity:1}.content-block.no-bg{background-color:rgba(0,0,0,0);box-shadow:none;backdrop-filter:none;opacity:1;transform:translateX(0)}.content-block.no-bg h1,.content-block.no-bg h2,.content-block.no-bg h3,.content-block.no-bg h4,.content-block.no-bg h5{opacity:1}.content-block:first-child{margin-top:0;width:90%;line-height:1.1}.content-block.short{margin-bottom:0}.content-block.medium{margin-bottom:100px}.content-block.width-medium{width:70%}.content-block .left-container{width:fit-content;margin:10px auto;padding:10px}.content-block .left-container.legend{background-color:#faf9f7;border:1px solid #231f20;border-radius:4px}.content-block .left-container>*{text-align:left}.content-block .left-container>h1,.content-block .left-container h2,.content-block .left-container h3,.content-block .left-container h4,.content-block .left-container h5{margin:.1em 0}.color-wrapper{display:flex;justify-content:space-between;margin:0 auto 400px;width:100%;min-height:600px;position:relative;z-index:500;backdrop-filter:blur(2px)}.color-wrapper .content-block{max-width:1000px}.color-wrapper .content-block.no-bg{backdrop-filter:none}.color-wrapper.behind{z-index:-200}.color-wrapper>div{flex:1 1 auto;z-index:500}.color-wrapper:first-child{padding-top:100px}.color-wrapper.lavender{background-color:rgba(226,160,255,.7)}.color-wrapper .scroll-arrow::after{opacity:.3}.content-block:hover .scroll-arrow::after{opacity:.3}.content-block:hover .scroll-arrow:hover::after{opacity:1}.scroll-arrow{height:50px;width:100px;position:relative;top:0;left:50%;transform:translateX(-50%);z-index:1000;cursor:pointer}.scroll-arrow::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:url(${x}) no-repeat center;background-size:100% auto;opacity:.3;transition:opacity .3s ease-out}.scroll-arrow.plum::after{background-image:url(${k})}.scroll-arrow.small{height:25px;width:50px}.scroll-arrow:hover::after{opacity:1;animation:move-up-down 1.5s ease-in-out infinite forwards}@keyframes move-up-down{0%,100%{transform:translate(0, 0)}50%{transform:translate(0, 7px)}}.inline-voter-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin:0 5px}.inline-voter-dot.purple{background-color:#833b8d}.inline-voter-dot.blue{background-color:#5899ea}.inline-voter-dot.grey{background-color:#ababab}.inline-voter-dot.cyan{background-color:#67d7be}.inline-voter-dot.gold{background-color:#ffc803}.inline-voter-dot.teal{background-color:#63c1cd}#controls{display:flex;position:relative;width:auto;flex:1 1 auto;text-align:right}#controls>*{flex:1 1 auto;margin:5px 10px}#controls .stop-button{background-color:#f33;color:#fff;font-weight:bold;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}#controls .stop-button:hover{background-color:red}#controls .stop-button.active{background-color:#0a0}#controls .stop-button.active:hover{background-color:#0c0}#controls .save-button{background-color:#36f;color:#fff;font-weight:bold;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}#controls .save-button:hover{background-color:#04c}.aib-logo{text-align:left;height:52px}.aib-logo img{display:inline-block;margin:0 auto;padding:0 20px;height:100%}#chart1{position:fixed;padding-top:100px;left:0;top:0;width:100%;height:100vh;z-index:100}svg{overflow:visible;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}.flow-arrowhead{fill:currentColor}.flow-path{stroke:currentColor;stroke-width:1}.flow-circle{fill:currentColor}.link.highlight-path{stroke-linecap:round;z-index:10}.link.animated-flow .flow-circle-1{animation:flow-animation 2s infinite;animation-delay:0s}.link.animated-flow .flow-circle-2{animation:flow-animation 2s infinite;animation-delay:.5s}.link.animated-flow .flow-circle-3{animation:flow-animation 2s infinite;animation-delay:1s}.link.animated-flow .flow-circle-4{animation:flow-animation 2s infinite;animation-delay:1.5s}.flow-circle{fill:currentColor;stroke:none}.free-sankey-link:not(.static).flow-dashed{stroke-dasharray:70 10;animation:dash-animation 60s linear infinite}.free-sankey-link:not(.static).flow-dashed.reverse-flow{animation:dash-animation-reverse 60s linear infinite}.offset-arrow-path{fill:none;stroke-width:4px;stroke-linecap:butt;stroke-linejoin:round;pointer-events:none}.link.animated-flow-markers{marker-mid:url(#animated-flow);marker-start:url(#animated-flow);marker-end:url(#animated-flow)}@keyframes flow-animation{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes dash-animation{to{stroke-dashoffset:1000}}@keyframes dash-animation-reverse{to{stroke-dashoffset:-1000}}svg text{font-family:"p22-mackinac-pro",serif}svg text.superdot-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.image-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.sankey-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.parties-label{font-size:1.5rem;font-weight:700;fill:#460000}svg text.donors-label{font-size:1.5rem;font-weight:700;fill:#034238}svg text.credit-label{font-size:1.5rem;font-weight:700;fill:#303085}.d3-annotations .annotation-note-bg{fill:hsla(0,0%,100%,.9)}.d3-annotations .annotation-note-title{font-weight:bold;font-family:"p22-mackinac-pro",serif;font-size:1.3rem;fill:#333}.d3-annotations .annotation-note-label{font-family:"p22-mackinac-pro",serif;font-size:.9rem;fill:#555}.d3-annotations .annotation-connector path{stroke:#333;stroke-width:1.5px}.d3-annotations.show-bg .annotation-note-bg{fill:rgba(245,245,245,.9);stroke:#969696;stroke-width:1px}.d3-annotations.superdot-annotation .annotation-note-title{fill:#460000}.d3-annotations.sankey-annotation .annotation-connector path{stroke:#034238}.d3-annotations.annotation-narrow .annotation-note-content{max-width:120px}.d3-annotations.annotation-wide .annotation-note-content{max-width:300px}.d3-annotations .hidden-callout-annotation>.annotation-connector,.d3-annotations .hidden-callout-annotation>.annotation-note{display:none}.d3-annotations .hidden-circle-annotation .annotation-subject path{stroke:hsla(0,0%,100%,0)}.d3-annotations .hidden-line-annotation .annotation-connector path,.d3-annotations .title-only-annotation .annotation-connector path{stroke:hsla(0,0%,100%,0);fill:hsla(0,0%,100%,0)}.d3-annotations .title-only-annotation .annotation-note-bg{fill:hsla(0,0%,100%,0)}.d3-annotations .title-only-annotation .note-line{display:none}.d3-annotations .elite-donors-annotation .annotation-note-title{fill:#034238}.d3-annotations .elite-donors-annotation .annotation-connector path{stroke:#034238;stroke-width:2px}.d3-annotations .elite-donors-annotation .annotation-subject path{stroke:rgba(3,66,56,.5);stroke-width:4px;stroke-dasharray:5,5}.d3-annotations .blue-text .annotation-note-title{fill:#2f4bd8}.d3-annotations .green-text .annotation-note-title{fill:#008001}.d3-annotations .purple-annotation .annotation-note-bg{fill:rgba(251,220,255,.8)}.d3-annotations .gold-annotation .annotation-note-bg{fill:rgba(255,222.2619047619,105,.8)}.d3-annotations .blue-annotation .annotation-note-bg{fill:rgba(88,153,234,.3)}.d3-annotations .teal-annotation .annotation-note-bg{fill:rgba(196,245,233,.8)}.d3-annotations .green-flow-annotation .annotation-note-bg{fill:rgba(200,252,192,.7)}.d3-annotations .blue-flow-annotation .annotation-note-bg{fill:rgba(184,206,250,.7)}.d3-annotations .purple-flow-annotation .annotation-note-bg{fill:rgba(251,220,255,.7)}.d3-annotations .donors-annotation .annotation-note-bg{fill:rgba(213,235,252,.8)}.d3-annotations .other-donors-annotation .annotation-note-title{fill:#460000}.d3-annotations .other-donors-annotation .annotation-connector path{stroke:#460000;stroke-width:2px}.d3-annotations .other-donors-annotation .annotation-subject path{stroke:rgba(70,0,0,.5);stroke-width:4px;stroke-dasharray:5,5}.font-book{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal}.font-book-italic{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:italic}.font-medium{font-family:"p22-mackinac-pro",serif;font-weight:500;font-style:normal}.font-medium-italic{font-family:"p22-mackinac-pro",serif;font-weight:500;font-style:italic}.font-bold{font-family:"p22-mackinac-pro",serif;font-weight:700;font-style:normal}.font-bold-italic{font-family:"p22-mackinac-pro",serif;font-weight:700;font-style:italic}.font-extra-bold{font-family:"p22-mackinac-pro",serif;font-weight:800;font-style:normal}.font-extra-bold-italic{font-family:"p22-mackinac-pro",serif;font-weight:800;font-style:italic}a.source-citation{color:#231f20;text-decoration-color:rgba(3,66,56,.3)}a.source-citation:hover{color:#034238;text-decoration-color:#034238}a.source-citation.super{font-size:.5rem;color:#231f20;text-decoration:none;vertical-align:super}#dot-info{position:fixed;right:0;top:100px;padding:10px;background-color:hsla(0,0%,100%,.2);border-radius:5px;box-shadow:0 0 4px 0 rgba(0,0,0,.1);z-index:1000}footer{background-color:#faf9f7;box-shadow:0 -2px 4px 0 rgba(0,0,0,.1);padding:22px 0;position:fixed;left:0;width:100%;z-index:1000;bottom:0;display:flex;position:sticky;bottom:0;z-index:1000}footer>.footer-data-item{display:flex}footer>.footer-data-item>div{flex:1 1 auto;margin:0 10px}h1{font-family:"ringold-sans",sans-serif;font-weight:400;font-style:normal;font-size:5.5rem;margin:0 0 20px}h2{font-family:"ringold-sans",sans-serif;font-weight:400;font-style:normal;font-size:2.5rem;margin:0 0 20px;line-height:1.1}h2.smaller{font-size:2.3rem}h2 a{color:#231f20}h3{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:1.3rem;margin:0 0 20px}h4{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:1.1rem;margin:0 0 20px}h1,h2,h3,h4,h5,h6,p{text-align:center}ul li{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:.8rem;margin:0 0 10px;text-align:left}.text-lemon{color:#ffdd2b}.text-lavender{color:#e2a0ff}.text-dark{color:#231f20}.text-plum{color:#460000}.text-pear{color:#b5c716}.text-grape{color:#473198}.text-mint{color:#034238}.text-light{color:#faf9f7}.text-gold{color:#e1b100}.text-stroke-dark{-webkit-text-stroke:2px #231f20}.green-highlighter,.blue-highlighter,.purple-highlighter{padding:2px 5px}h2 .green-highlighter,h2 .blue-highlighter,h2 .purple-highlighter{padding:0 5px}.green-highlighter{background-color:rgba(0,255,30,.3)}.blue-highlighter{background-color:rgba(0,106,255,.3);padding:2px 5px}.purple-highlighter{background-color:#833b8d;padding:2px 5px}#year-selector{position:fixed;bottom:80px;right:20px;display:flex;flex-direction:column;align-items:flex-end;gap:5px;z-index:10000}#year-selector .year-selector-title{font-size:12px;font-family:"Inter",sans-serif;color:#231f20}#year-selector.average-active .year-button:not(.average-year){background-color:rgba(88,153,234,.3)}#year-selector.average-active .year-button.election-year::after{background:url(${v}) no-repeat center;background-size:100% auto}#year-selector .year-button{padding:4px 8px;margin:2px;border-radius:4px;cursor:pointer;background-color:#f0f0f0;color:#333;border:none;font-size:12px;font-family:"Inter",sans-serif;transition:background-color .3s ease}#year-selector .year-button:not(.active):hover{background-color:rgba(131,59,141,.3)}#year-selector .year-button:not(.active):hover.election-year::after{background:url(${E}) no-repeat center;background-size:100% auto}#year-selector .year-button::before{content:"";position:absolute;top:2px;right:-23px;width:0;height:0;border-top:10px solid rgba(0,0,0,0);border-bottom:10px solid rgba(0,0,0,0);border-right:13px solid #833b8d;opacity:0;transition:opacity .3s ease}#year-selector .year-button.active{background-color:#833b8d;color:#fff;position:relative}#year-selector .year-button.active::before{opacity:1}#year-selector .year-button.active.average-year{background-color:#5899ea}#year-selector .year-button.active.average-year::before{border-right-color:#5899ea}#year-selector .year-button.active.election-year::after{background:url(${E}) no-repeat center;background-size:100% auto}#year-selector .year-button.election-year{position:relative}#year-selector .year-button.election-year::after{content:"";position:absolute;cursor:default;bottom:-6px;left:-32px;width:25px;height:40px;background:url(${b}) no-repeat center;background-size:100% auto;transition:background-image .3s ease}#year-selector .year-button:disabled{opacity:.3;pointer-events:none}::-webkit-scrollbar{width:12px;background-color:#ffdd2b;z-index:9000}::-webkit-scrollbar-thumb{background-color:#231f20;border-radius:10px;border:3px solid rgba(0,0,0,0)}::-webkit-scrollbar-track{background-color:#ffdd2b;border-radius:10px;z-index:9000}*{scrollbar-width:thin;scrollbar-color:#231f20 #ffdd2b}.dot-legend{font-size:12px;transition:opacity .3s,transform .2s;position:fixed;top:110px;right:20px;background:hsla(0,0%,100%,.9);border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1);z-index:1000;max-width:250px;cursor:default}.dot-legend.dragging{cursor:grabbing;user-select:none}.dot-legend-header{display:flex;justify-content:space-between;align-items:center;padding:5px 10px;border-bottom:1px solid rgba(0,0,0,.1);cursor:grab}.dot-legend-header:active{cursor:grabbing}.dot-legend-header-title{font-weight:bold}.dot-legend-content{padding:10px;overflow:auto;max-height:calc(80vh - 150px)}.dot-legend-size-key{font-size:12px;padding:10px 10px 0 10px;color:#231f20}.dot-legend-toggle{background:none;border:none;cursor:pointer;font-size:16px;width:24px;height:24px;border-radius:50%;display:flex;justify-content:center;align-items:center;padding:0;font-family:"Inter",sans-serif}.dot-legend-toggle:hover{background-color:rgba(0,0,0,.05)}.dot-legend-toggle:active{transform:scale(0.95)}.dot-legend:hover .legend-dot.black{animation:cycle-colors 5s linear infinite}.legend-category{font-weight:bold;margin-top:8px;margin-bottom:4px}.legend-item{display:flex;align-items:center;margin-bottom:4px;transition:opacity .3s}.legend-item img{width:45px;margin:5px 10px 5px 0}.legend-item.inactive{opacity:.5}.legend-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px}.legend-dot.rainbow{background:#ababab;background:linear-gradient(150deg, rgb(171, 171, 171) 10%, rgb(131, 59, 141) 26%, rgb(88, 153, 234) 54%, rgb(103, 215, 190) 80%, rgb(255, 200, 3) 90%)}.legend-dot.black{background:#333;margin-right:0;position:relative;top:1px}@keyframes cycle-colors{0%{background:#833b8d}20%{background:#ababab}40%{background:#5899ea}60%{background:#67d7be}80%{background:#ffc803}100%{background:#833b8d}}.legend-square{display:inline-block;width:10px;height:10px;margin-right:6px}.legend-label{flex:1}`,""]);const T=m},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var o="",r=void 0!==e[5];return e[4]&&(o+="@supports (".concat(e[4],") {")),e[2]&&(o+="@media ".concat(e[2]," {")),r&&(o+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),o+=t(e),r&&(o+="}"),e[2]&&(o+="}"),e[4]&&(o+="}"),o})).join("")},e.i=function(t,o,r,n,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);r&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),e.push(d))}},e}},417:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},601:t=>{t.exports=function(t){return t[1]}},376:(t,e,o)=>{o.r(e),o.d(e,{default:()=>O});var r=o(72),n=o.n(r),i=o(825),a=o.n(i),s=o(659),l=o.n(s),c=o(56),d=o.n(c),u=o(540),p=o.n(u),g=o(113),f=o.n(g),h=o(11),y={};y.styleTagTransform=f(),y.setAttributes=d(),y.insert=l().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=p();n()(h.A,y);const O=h.A&&h.A.locals?h.A.locals:void 0},72:t=>{var e=[];function o(t){for(var o=-1,r=0;r<e.length;r++)if(e[r].identifier===t){o=r;break}return o}function r(t,r){for(var i={},a=[],s=0;s<t.length;s++){var l=t[s],c=r.base?l[0]+r.base:l[0],d=i[c]||0,u="".concat(c," ").concat(d);i[c]=d+1;var p=o(u),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(g);else{var f=n(g,r);r.byIndex=s,e.splice(s,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function n(t,e){var o=e.domAPI(e);o.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;o.update(t=e)}else o.remove()}}t.exports=function(t,n){var i=r(t=t||[],n=n||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var s=o(i[a]);e[s].references--}for(var l=r(t,n),c=0;c<i.length;c++){var d=o(i[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}i=l}}},659:t=>{var e={};t.exports=function(t,o){var r=function(t){if(void 0===e[t]){var o=document.querySelector(t);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(t){o=null}e[t]=o}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(o)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,o)=>{t.exports=function(t){var e=o.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(o){!function(t,e,o){var r="";o.supports&&(r+="@supports (".concat(o.supports,") {")),o.media&&(r+="@media ".concat(o.media," {"));var n=void 0!==o.layer;n&&(r+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),r+=o.css,n&&(r+="}"),o.media&&(r+="}"),o.supports&&(r+="}");var i=o.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,o)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},734:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.renderSvgAnnotations=m,e.updateSvgAnnotationPositions=function(){if(!h||0===f.length)return;const t=y(f),e=r.annotation();e.notePadding(10),t.forEach(((t,e)=>{f[e]&&f[e].note.wrap&&(t.wrap=f[e].note.wrap)})),e.annotations(t),e.textWrap(120),h&&(h.call(e),g(h))},e.updateSvgAnnotationText=S;const r=window.d3,n=(window.d3.annotation,o(569)),i=o(566),a=o(3),s=o(613),l=o(921),c=o(636),d=o(160),u=o(114),p=o(965);function g(t){t.selectAll(".annotation-note-bg").attr("fill-opacity",1).attr("rx",4)}let f=[],h=null;function y(t){return t.map((t=>{const e=function(t){let e={x:0,y:0},o={left:0,right:0,top:0,bottom:0},r={start:{x:0,y:0},end:{x:0,y:0}},l={x:0,y:0};if((0,i.isDotData)(t.target)&&!(0,d.isSuperdot)(t.target))e={x:t.target.x||0,y:t.target.y||0},o={left:e.x-n.state.dotRadius,right:e.x+n.state.dotRadius,top:e.y-n.state.dotRadius,bottom:e.y+n.state.dotRadius};else if((0,d.isSuperdot)(t.target))e={x:t.target.x||0,y:t.target.y||0},o={left:e.x-t.target.radius,right:e.x+t.target.radius,top:e.y-t.target.radius,bottom:e.y+t.target.radius};else if(t.target instanceof c.SimImage){const r=t.target.position;e={x:r.x,y:r.y},o={left:e.x-t.target.size.width/2,right:e.x+t.target.size.width/2,top:e.y-t.target.size.height/2,bottom:e.y+t.target.size.height/2}}else t.target instanceof a.Sankey?(e=t.target.getJunctionCenter(),r=t.target.getEndpointPositions()):t.target instanceof p.FreeSankey?(e=t.target.getJunctionPoint()||{x:0,y:0},r={start:t.target.getAverageSourcePoint(),end:t.target.getDestinationPoint()}):t.target instanceof s.VoterGroup?e=(0,u.calculateGroupCenters)([t.target]).get(t.target):(e=t.target,o={left:e.x,right:e.x,top:e.y,bottom:e.y});if(t.target instanceof a.Sankey)if("start"===t.targetAnchorLink)l=r.start;else if("end"===t.targetAnchorLink)l=r.end;else if("superdot-link"===t.targetAnchorLink&&t.targetFlowGroup){const e=t.targetFlowRatio||.5,o="string"==typeof t.targetFlowGroup?t.targetFlowGroup:t.targetFlowGroup.id;l=t.target.getPositionFromSuperdotToJunction(o,e)}else l=e;else if(t.target instanceof p.FreeSankey)if("superdot-link"===t.targetAnchorLink){const e=t.targetFlowRatio||.5;if(t.targetFlowGroup){if("string"==typeof t.targetFlowGroup)throw new Error("Flow group ID must be a VoterGroup for FreeSankey annotations");const o=(0,d.getSuperdotByGroup)(t.targetFlowGroup);if(!o)throw new Error("Superdot not found for flow group");const r=t.target.linkForDot(o);if(!r)throw new Error("Link not found for superdot");l=r.positionAlongLink(e)}else l={x:(r.start.x+r.end.x)/2,y:(r.start.y+r.end.y)/2}}else l="start"===t.targetAnchorLink?r.start:"end"===t.targetAnchorLink?r.end:e;else"left"===t.targetAnchorX?l.x=o.left:"right"===t.targetAnchorX?l.x=o.right:l.x=e.x,"top"===t.targetAnchorY?l.y=o.top:"bottom"===t.targetAnchorY?l.y=o.bottom:l.y=e.y;return{x:l.x+(t.targetOffset?.x||0),y:l.y+(t.targetOffset?.y||0)}}(t),o={...t.note};"function"==typeof o.title&&(o.title=o.title()),"function"==typeof o.label&&(o.label=o.label());const r={id:t.id||`annotation-${Math.random().toString(36).substr(2,9)}`,note:o,className:t.className||"",type:O(t.type),connector:t.connector||{}};if(t.fixedPosition?(r.x=e.x,r.y=e.y,r.dx=t.fixedPosition.x-e.x,r.dy=t.fixedPosition.y-e.y):(r.x=e.x,r.y=e.y,r.dx=t.dx||0,r.dy=t.dy||0),t.subject)if("calloutCircle"===t.type)if((0,d.isSuperdot)(t.target))r.subject={...t.subject,radius:t.target.radius};else if((0,i.isDotData)(t.target)||t.target instanceof s.VoterGroup||"object"==typeof t.target&&"x"in t.target&&"y"in t.target)if(t.subject.radius)r.subject=t.subject;else{const o=e.x,i=e.y;let a=0;if(t.subject.includeElements&&t.subject.includeElements.length>0)t.subject.includeElements.forEach((t=>{if("string"==typeof t){const e=Object.values(l.VOTER_GROUPS).find((e=>e.id===t));if(e)n.state.displayData.forEach((t=>{if(void 0!==t.x&&void 0!==t.y&&e.shouldIncludeDot(t)){const e=t.x-o,r=t.y-i,s=Math.sqrt(e*e+r*r)+n.state.dotRadius;a=Math.max(a,s)}}));else{const e=n.state.superdots.find((e=>e.id===t));if(e){const t=e.x-o,r=e.y-i,n=Math.sqrt(t*t+r*r)+e.radius;a=Math.max(a,n)}else{const e=Object.values(n.state.images).find((e=>e.id===t));if(e){const t=e.position.x,r=e.position.y,n=t-o,s=r-i,l=Math.sqrt(n*n+s*s)+Math.max(e.size.width,e.size.height)/2;a=Math.max(a,l)}}}}else if(t instanceof s.VoterGroup)n.state.displayData.forEach((e=>{if(void 0!==e.x&&void 0!==e.y&&t.shouldIncludeDot(e)){const t=e.x-o,r=e.y-i,s=Math.sqrt(t*t+r*r)+n.state.dotRadius;a=Math.max(a,s)}}));else if(t instanceof c.SimImage){const e=t.position.x,r=t.position.y,n=e-o,s=r-i,l=Math.sqrt(n*n+s*s)+Math.max(t.size.width,t.size.height)/2;a=Math.max(a,l)}else if("x"in t&&"y"in t){const e=t.x-o,r=t.y-i,n=Math.sqrt(e*e+r*r);a=Math.max(a,n)}}));else{const t=150;n.state.displayData.forEach((e=>{if(void 0!==e.x&&void 0!==e.y){const r=e.x-o,s=e.y-i,l=Math.sqrt(r*r+s*s)+n.state.dotRadius;l<t&&(a=Math.max(a,l))}}))}const d=t.subject.radiusPadding||15,u=60,p=Math.max(a,u)+d;r.subject={...t.subject,radius:p}}else r.subject=t.subject;else r.subject=t.subject;return r}))}function O(t){switch(t){case"label":default:return r.annotationLabel;case"callout":return r.annotationCallout;case"calloutCircle":return r.annotationCalloutCircle;case"calloutRect":return r.annotationCalloutRect;case"threshold":return r.annotationXYThreshold}}function m(t,e=!0){if(!n.state.svg)return;h&&h.remove(),h=n.state.svg.append("g").attr("class","d3-annotations");const o=[];if(t.svgAnnotations&&o.push(...t.svgAnnotations),t.clumps.forEach((e=>{if(e.svgAnnotations){const r=e.svgAnnotations.map((o=>{let r;if(e.superdot){const t=n.state.superdots.find((t=>(0,i.sameTypesInClumps)(e,t.viewClump)));r=t||{x:0,y:0}}else r=e.group;return{...o,target:r,id:o.id||`annotation-${e.group.id}-${t.id}}`}}));o.push(...r)}})),t.sankeyGroups&&t.sankeyGroups.forEach((e=>{if(e.svgAnnotations){const r=e.svgAnnotations.map((o=>({...o,target:e.sankey,id:o.id||`annotation-${e.sankey.id}-${t.id}`})));o.push(...r)}})),t.freeSankeyGroups&&t.freeSankeyGroups.forEach((e=>{if(e.svgAnnotations){const r=e.svgAnnotations.map((o=>({...o,target:e.freeSankey,id:o.id||`annotation-${e.freeSankey.id}-${t.id}`})));o.push(...r)}})),t.images&&t.images.forEach((e=>{if(e.svgAnnotations){const r=e.svgAnnotations.map((o=>({...o,target:e.image,id:o.id||`annotation-${e.image.id}--${t.id}`})));o.push(...r)}})),f=o,0===o.length)return;const a=y(o),s=r.annotation();s.notePadding(10),a.forEach(((t,e)=>{o[e]&&o[e].note.wrap&&(t.wrap=o[e].note.wrap)})),s.annotations(a),s.textWrap(120),h&&(h.call(s),g(h),function(t,e){t.selectAll(".annotation-note-bg").attr("stroke",e??"black")}(h,"black")),e&&h.selectAll(".annotations > .annotation").attr("opacity",0).transition().duration(500).attr("opacity",1)}function S(){if(0===f.length)return;f.some((t=>"function"==typeof t.note.title||"function"==typeof t.note.label))&&n.state.view&&m(n.state.view)}window.updateSvgAnnotationText=S},921:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_RING_RADIUS=e.RING_SPACING=e.MIN_RING_SIZE=e.CURSOR_NODE_DATA=e.VOTER_GROUPS=e.VOTER_TYPES=e.VOTER_TYPE_KEYS=e.flowColors=e.typeColors=e.targetColumn=e.DEFAULT_LINK_THICKNESS=e.MONEY_SCALE=e.COLLIDE_DISTANCE_MULT=e.MOUSE_CHARGE_STRENGTH=e.DOT_CHARGE_STRENGTH=e.GROUPED_FORCE_STRENGTH=e.RADIAL_STRENGTH=e.smallDotRadius=e.largeDotRadius=void 0,e.createVoterGroups=function(){Object.keys(e.VOTER_TYPES).forEach((t=>{e.VOTER_GROUPS[t]=r.VoterGroup.fromType(e.VOTER_TYPES[t])})),e.VOTER_GROUPS.NON_DONATING_VOTERS=r.VoterGroup.fromGroups([e.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,e.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING,e.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Non-donating voters","Non-donating voters"),e.VOTER_GROUPS.NON_DONATING_WITH_REFORM=r.VoterGroup.fromGroups([e.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,e.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Non-donating voters with reform","Non-donating voters with reform"),e.VOTER_GROUPS.ABOVE_TAX_THRESHOLD=r.VoterGroup.fromGroups([e.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,e.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,e.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING],"Above the tax threshold","Above the tax threshold"),e.VOTER_GROUPS.BELOW_TAX_THRESHOLD=r.VoterGroup.fromGroups([e.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Below the tax threshold","Below the tax threshold"),e.VOTER_GROUPS.DONORS_1_999=new r.VoterGroup([e.VOTER_TYPES.DONORS_1_199,e.VOTER_TYPES.DONORS_200_499,e.VOTER_TYPES.DONORS_500_999],"Donors $1-999","Donors $1-999"),e.VOTER_GROUPS.ALL_DONORS=r.VoterGroup.fromGroups([e.VOTER_GROUPS.DONORS_1_999,e.VOTER_GROUPS.DONORS_OVER_1000],"All Donors","All Donors"),e.VOTER_GROUPS.ALL_VOTERS=r.VoterGroup.fromGroups([e.VOTER_GROUPS.ALL_DONORS,e.VOTER_GROUPS.NON_DONATING_VOTERS],"All Voters","All Voters"),e.VOTER_GROUPS.ALL_ELIGIBLE=r.VoterGroup.fromGroups([e.VOTER_GROUPS.NON_DONATING_VOTERS,e.VOTER_GROUPS.ELIGIBLE_NON_VOTERS],"All Eligible","All Eligible"),e.VOTER_GROUPS.EVERYONE=r.VoterGroup.fromGroups([e.VOTER_GROUPS.ALL_VOTERS,e.VOTER_GROUPS.ELIGIBLE_NON_VOTERS],"Everyone","Everyone"),e.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM=r.VoterGroup.fromGroups([e.VOTER_GROUPS.DONORS_1_999,e.VOTER_GROUPS.DONORS_OVER_1000,e.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING],"All donors after reform","All donors after reform")};const r=o(613);e.largeDotRadius=5,e.smallDotRadius=2,e.RADIAL_STRENGTH=.3,e.GROUPED_FORCE_STRENGTH=.1,e.DOT_CHARGE_STRENGTH=-.75,e.MOUSE_CHARGE_STRENGTH=-50,e.COLLIDE_DISTANCE_MULT=1.2,e.MONEY_SCALE=7e5,e.DEFAULT_LINK_THICKNESS=10,e.targetColumn="Average 2016-2022 Dots",e.typeColors={grey:"#ABABAB",purple:"#833B8D",gold:"#FFC803",cyan:"#67D7BE",teal:"#64C1CD",blue:"#5899EA",greal:"#63C1CD"},e.flowColors={blue:"rgba(0, 106, 255, 0.3)",green:"rgba(0, 255, 30, 0.3)",greenStronger:"rgba(0, 255, 30, 0.6)",greenLight:"rgba(0, 255, 100, 0.3)",purple:"rgba(214, 93, 230, 0.3)"},e.VOTER_TYPE_KEYS={"Eligible non-voters":"ELIGIBLE_NON_VOTERS","Remaining Non-donating voters":"REMAINING_NON_DONATING_VOTERS","Donors >$1000":"DONORS_OVER_1000","Donors $500-999":"DONORS_500_999","Donors $200-499":"DONORS_200_499","Donors $1-199":"DONORS_1_199","Non-donating voters below tax threshold":"NON_DONATING_BELOW_TAX_THRESHOLD","Non-donating voters needed for new funding goals":"NON_DONATING_NEEDED_FOR_FUNDING"},e.VOTER_TYPES={ELIGIBLE_NON_VOTERS:new r.VoterType("Eligible non-voters","Eligible voters who don't vote","#ABABAB"),REMAINING_NON_DONATING_VOTERS:new r.VoterType("Remaining Non-donating voters","Non-donating voters","#833B8D"),DONORS_OVER_1000:new r.VoterType("Donors >$1000","Huge Donors (>$1000)","#FFC803"),DONORS_500_999:new r.VoterType("Donors $500-999","Large Donors ($500-$999)","#67D7BE"),DONORS_200_499:new r.VoterType("Donors $200-499","Medium Donors ($200-$499)","#64C1CD"),DONORS_1_199:new r.VoterType("Donors $1-199","Small Donors ($1-$199)","#5899EA"),NON_DONATING_BELOW_TAX_THRESHOLD:new r.VoterType("Below the tax threshold","Eligible voters who don't make enough to pay income tax","#833B8D"),NON_DONATING_NEEDED_FOR_FUNDING:new r.VoterType("Non-donating voters needed for new funding goals","Non-donating voters needed for new funding goals","#833B8D"),SUPERDOT:new r.VoterType("SUPERDOT","Superdot","black"),MOUSE:new r.VoterType("MOUSE","Mouse","green")},e.VOTER_GROUPS={},e.CURSOR_NODE_DATA={id:"cursor-node",type:e.VOTER_TYPES.MOUSE,x:0,y:0,fx:0,fy:0,sankeys:new Map},e.MIN_RING_SIZE=20,e.RING_SPACING=10,e.MAX_RING_RADIUS=150},646:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.loadFlowData=async function(t){const e=await r.csv(t),o=Object.keys(e[0]||{}),a="type",s="voterGroup",l=[];o.forEach(((t,e)=>{t!==a&&t!==s&&l.push(t)}));const c={};return e.forEach((t=>{if(!(0,i.isFlowType)(t[a]))throw new Error(`Invalid flow type: ${t[a]}`);const e=t[a],o=t[s],r=[];l.forEach((o=>{let n=t[o];if(n){if(n=n.replace(/[$,]/g,""),isNaN(+n))throw new Error(`Invalid flow value: ${n}`);r.push({year:o,value:+n,type:e})}})),r.forEach((t=>{c[o]??={},c[o][t.year]??={},c[o][t.year][t.type]=t.value}))})),Object.keys(n.VOTER_GROUPS).forEach((t=>{c[t]&&(n.VOTER_GROUPS[t].dataKey=t,n.VOTER_GROUPS[t].flowData=c[t],n.VOTER_GROUPS[t].dotFlowData=(0,i.flowDataForSingleDot)(c[t]))})),c},e.loadVoterData=async function(t){const e=await r.csv(t),o=/(\d{4}|\bAverage \d{4}-\d{4}\b) Dots/,i=Object.keys(e[0]||{}).filter((t=>o.test(t))).map((t=>t.replace(" Dots","")));a.state.availableYears=i,a.state.yearData={},i.forEach((t=>{a.state.yearData[t]={}})),e.forEach((t=>{const e=t.Group;if(!n.VOTER_TYPE_KEYS[e])return;const o=n.VOTER_TYPE_KEYS[e];i.forEach((e=>{const r=t[`${e} Dots`];r&&!isNaN(+r)&&(a.state.yearData[e][o]=+r)}))}));const s="Average 2016-2022";return a.state.currentYear=s,Object.keys(n.VOTER_TYPES).forEach((t=>{a.state.yearData[s]&&void 0!==a.state.yearData[s][t]&&(n.VOTER_TYPES[t].dotCount=a.state.yearData[s][t])})),Object.keys(n.VOTER_GROUPS).forEach((t=>{n.VOTER_GROUPS[t].updateDotCount()})),Object.values(n.VOTER_TYPES)},e.flattenData=function(t){const e=[];return t.forEach((t=>{for(let o=0;o<t.dotCount;o++)e.push({id:`${t.id}-${o}`,type:t,sankeys:new Map})})),e},e.updateDisplayData=function(t){if(a.state.displayData=a.state.flattenedData.slice(),!t)return void(0,s.addCursorNode)();a.state.displayData=a.state.displayData.filter((e=>e.type.belongsInView(t))),a.state.displayData.forEach((e=>{e.activeClump=e.type.matchedClumpInView(t)})),(0,s.addCursorNode)()};const r=window.d3,n=o(921),i=o(613),a=o(569),s=o(517)},795:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.pointerMoveHandler=function(t){if(!n.state.cursorNode||n.state.disableCursorPush)return;const[e,o]=r.pointer(t);n.state.cursorNode.fx=e,n.state.cursorNode.fy=o,n.state.simulation.alpha(1).restart()},e.pointerOutHandler=function(){n.state.cursorNode&&(n.state.cursorNode.fx=-1e4,n.state.cursorNode.fy=-1e4);n.state.simulation.alpha(1).restart()},e.setViewFromVisibleTriggers=l,e.initEventListeners=function(){r.select(window).on("scroll",(function(){l();const t=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);r.select("#progress-bar-fill").style("width",100*t+"%"),t<=.03?r.select("#progress-bar").classed("hidden",!0):r.select("#progress-bar").classed("hidden",!1)})),r.select("body").on("pointermove mouseover mouseout ",(t=>{n.state.disableCursorPush&&r.select("#dot-info").html((0,a.getDotInfo)(t))})),r.selectAll(".scroll-arrow").on("click",(function(){let t=this?.parentElement;for(;t&&!t.classList.contains("trigger-div");)t=t.parentElement;if(t){const e=Array.from(document.querySelectorAll(".trigger-div")),o=e.indexOf(t);if(o>=0&&o<e.length-1){e[o+1].scrollIntoView({behavior:"smooth",block:"start"})}}})),r.select("#toggle-cursor-push").on("click",(()=>{n.state.disableCursorPush=!n.state.disableCursorPush})),r.select("#stop-everything").on("click",(function(){const t=r.select(this);n.state.isStopped?(n.state.resumeSimulation(),r.selectAll("*").interrupt(),r.select(window).on("scroll",(function(){l();const t=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);r.select("#progress-bar-fill").style("width",100*t+"%")})),t.text("STOP EVERYTHING").classed("active",!1)):(n.state.stopSimulation(),r.selectAll("*").interrupt(),r.select(window).on("scroll",null),t.text("RESUME EVERYTHING").classed("active",!0))})),r.select("#pause-simulation").on("click",(()=>n.state.simulation.stop())),r.select("#resume-simulation").on("click",(()=>n.state.simulation.restart()))};const r=window.d3,n=o(569),i=o(610),a=o(566);var s=null;function l(){const t=document.querySelectorAll(".trigger-div");let e=!1;const o=Array.from(t);for(const r of o){const a=r.getBoundingClientRect();let l=r.getAttribute("data-view");const c=100,d=160,u=o.indexOf(r),p=r.closest(".sticky-wrapper");let g=0,f=null;if(p){f=p.getBoundingClientRect();const t=f.height-a.height-d;g=(a.top-f.top)/t}const h=p?.querySelectorAll(".minor-trigger");h&&h.forEach((t=>{t.classList.remove("active")}));const y=p?.querySelectorAll(".minor-trigger-text");if(y&&y.forEach((t=>{parseFloat(t.getAttribute("data-percentage")||"0")<=g?t.classList.add("active"):t.classList.remove("active")})),a.top>=c||0===u&&o[1].getBoundingClientRect().top>window.innerHeight/2-c){if(l&&i.viewPresets[l]){e=!0;const a=p?.querySelectorAll(".minor-trigger");let c,d;if(a&&f){let t=-1;if(a.forEach((e=>{const o=parseFloat(e.getAttribute("data-percentage")||"0");o<=g&&o>t&&(t=o,c=e,d=o)})),c){c.classList.add("active");const t=c.getAttribute("data-view");t&&(l=t)}}if(s!==l){(0,n.requestView)(i.viewPresets[l]),s=l,t.forEach((t=>{t!==r?t.classList.remove("active"):t.classList.add("active")}));break}if(i.viewPresets[l].tween){if(u+1>=o.length)break;const t=o[u+1].getAttribute("data-view");if(!t||!i.viewPresets[t])break;const e=g/2;(0,n.setTweenView)((0,n.createTweenView)(i.viewPresets[l],i.viewPresets[t],e));break}break}break}}}},965:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeSankey=e.FreeSankeyLink=void 0,e.createFreeSankey=function(t){const e=new d(t);t.voterGroups&&e.createLinks();return e};const r=o(613),n=o(160),i=o(569),a=o(921),s=o(636),l=o(566);class c{source;orientation;thickness;isHighlighted=!1;pathElement=null;color="#000000";flowDirection;multiLinkSortIndex=0;id;constructor(t,e,o,r,n,i,a){this.source=e,this.orientation=o,this.flowDirection=r,this.thickness=n,i&&(this.color=i),a&&(this.multiLinkSortIndex=a),this.id=t}getMultiLinkSortIndex(){return this.multiLinkSortIndex}getFlowDirection(){return this.flowDirection}getSource(){return this.source}getThickness(){return this.thickness}setThickness(t){this.thickness=t,this.pathElement&&d3.select(this.pathElement).attr("stroke-width",this.thickness)}setColor(t){this.color=t,this.pathElement&&d3.select(this.pathElement).attr("stroke",this.isHighlighted?"#ff0000":this.color)}positionAlongLink(t){if(!this.pathElement)return{x:0,y:0};const e=this.pathElement;if(e){const o=e.getTotalLength(),r=e.getPointAtLength(o*t);return{x:r.x,y:r.y}}return{x:0,y:0}}calculatePath(t,e,o,r){const a="horizontal"===this.orientation?d3.linkHorizontal():d3.linkVertical();o||(o={x:0,y:0}),r||(r={x:0,y:0});let s=0;if(s=(0,n.isSuperdot)(this.source)?"incoming"===this.flowDirection?-this.source.radius:this.source.radius:"incoming"===this.flowDirection?-i.state.dotRadius:i.state.dotRadius,e){const n=t.x+o.x,i=t.y+o.y,l=e.x+o.x,c=e.y+o.y;let d=`M${n},${i}`;d+=`L${l},${c}`;const u=(this.source.x??0)+r.x,p=(this.source.y??0)+r.y,g=a({source:[l,c],target:["horizontal"===this.orientation?u+s:u,"horizontal"===this.orientation?p:p+s]})||"";return d+=g.substring(g.indexOf("C")),d+=`L${u},${p}`,d}{const e=(this.source.x??0)+r.x,o=(this.source.y??0)+r.y,n="horizontal"===this.orientation?e+s:e,i="horizontal"===this.orientation?o:o+s;return(a({source:[t.x,t.y],target:[n,i]})||"")+`L${e},${o}`}}render(t){this.pathElement&&d3.select(this.pathElement).remove(),t.multiLinkSortIndex&&(this.multiLinkSortIndex=t.multiLinkSortIndex);const e=this.calculatePath(t.destinationPoint,t.junctionPoint,t.bundleOffset,t.sourceStackOffset),o=i.state.svgGroups.linksGroup;if(!o)return;const r=["free-sankey-link","flow-dashed","static",`free-sankey-link-${this.id}`];"incoming"===this.flowDirection&&r.push("reverse-flow"),this.pathElement=o.append("path").attr("d",e).attr("stroke",this.isHighlighted?"#ff0000":this.color).attr("stroke-width",this.thickness).attr("fill","none").attr("class",r.join(" ")).attr("opacity",0).node(),d3.select(this.pathElement).attr("stroke-dasharray","1000 1000").attr("stroke-dashoffset","-400").transition().duration(1e3).attr("stroke-dashoffset","0").attr("stroke-dasharray","1000 1000").attr("opacity",1).on("end",(()=>{d3.select(this.pathElement).transition().duration(1e3).attr("stroke-dasharray","70 10").attr("stroke-dashoffset","0").on("end",(()=>{d3.select(this.pathElement).attr("stroke-dasharray","").attr("stroke-dashoffset","").classed("static",!1)}))}))}update(t){if(!this.pathElement)return;t.multiLinkSortIndex&&(this.multiLinkSortIndex=t.multiLinkSortIndex),t.highlightColor?this.setHighlighted(!0,t.highlightColor):this.setHighlighted(!1);const e=this.calculatePath(t.destinationPoint,t.junctionPoint,t.bundleOffset,t.sourceStackOffset);t.transitionDuration?d3.select(this.pathElement).transition("update-path").duration(t.transitionDuration).attr("d",e).attr("stroke-width",this.thickness):d3.select(this.pathElement).attr("d",e).attr("stroke-width",this.thickness)}setHighlighted(t,e){this.isHighlighted=t,this.pathElement&&d3.select(this.pathElement).attr("stroke",e||(t?"#ff0000":this.color))}remove(){this.pathElement&&(d3.select(this.pathElement).remove(),this.pathElement=null)}}e.FreeSankeyLink=c;class d{links=[];target;orientation;flowDirection;flowAspect;junctionPoint=null;voterGroups=null;_junctionOffset={x:0,y:0};color="#000000";targetOffset={x:0,y:0};destinationPoint={x:0,y:0};currentDots=[];destinationStackOffset={x:0,y:0};sourceStackOffsets=new Map;destinationSortIndex=0;config;isInTransition=!1;transitionStartTime=0;transitionDuration=0;highlightLinks=[];id;constructor(t){let e;this.config=t,this.target=t.target,this.targetOffset=t.targetOffset||{x:0,y:0},this._junctionOffset=t.junctionOffset,this.orientation=t.orientation,this.flowAspect=t.flowAspect,this.voterGroups=t.voterGroups||null,t.color&&(this.color=t.color),this.flowDirection=t.flowDirection,e=t.target instanceof s.SimImage?t.target.id:`x${t.target.x}-y${t.target.y}`,this.id=`free-sankey-${t.voterGroups?.map((t=>t.typeKey)).join("-")}-${e}-${t.orientation}-${t.flowDirection}-${t.flowAspect}`}get junctionOffset(){return this._junctionOffset}set junctionOffset(t){this._junctionOffset=t,this.updateJunctionPoint(),this.updateDestinationPoint()}resetJunctionOffset(){this._junctionOffset=this.config.junctionOffset,this.updateJunctionPoint(),this.updateDestinationPoint()}resetTargetOffset(){this.targetOffset=this.config.targetOffset||{x:0,y:0},this.updateDestinationPoint()}resetColor(){this.color=this.config.color||"#000000",this.links.forEach((t=>t.setColor(this.color)))}setColor(t){this.color=t,this.links.forEach((e=>e.setColor(t)))}getColor(){return this.color}getTarget(){return this.target}addLink(t){const e=this.calculateThicknessForDot(t),o=new c(t.id,t,this.orientation,this.flowDirection,e,this.color);this.links.push(o),this.updateJunctionPoint(),this.render()}removeLink(t){const e=this.links.findIndex((e=>e.getSource()===t));-1!==e&&(this.links[e].remove(),this.links.splice(e,1),this.updateJunctionPoint(),this.render())}getTargetCoords(){return this.target instanceof s.SimImage?{x:this.target.position.x,y:this.target.position.y}:{x:this.target.x,y:this.target.y}}updateLinkThicknesses(){this.links.forEach((t=>{t.setThickness(this.calculateThicknessForDot(t.getSource()))}))}calculateThicknessForDot(t){let e=a.DEFAULT_LINK_THICKNESS;const o=(0,n.isSuperdot)(t)?t.viewClump?.group:t.activeClump?.group;if(!o)return e;const s=o.flowData;if(!s)return e;const l=s[i.state.currentYear];if(!l)return e;let c;if("credit"===this.flowAspect)c=l?.inflow??0;else if("donation"===this.flowAspect)c=l?.outflow??0;else{if("outOfPocket"!==this.flowAspect)return e;c=(0,r.outOfPocketForYear)(s,i.state.currentYear)??0}return e=c?c/a.MONEY_SCALE:a.DEFAULT_LINK_THICKNESS,e<1&&(e=1),e}updateJunctionPoint(){0!==this.links.length?this.junctionPoint={x:this.destinationPoint.x+this._junctionOffset.x,y:this.destinationPoint.y+this._junctionOffset.y}:this.junctionPoint=null}updateDestinationPoint(){const t=this.getTargetCoords();this.destinationPoint={x:t.x+this.targetOffset.x+this.destinationStackOffset.x,y:t.y+this.targetOffset.y+this.destinationStackOffset.y}}getJunctionPoint(){return this.junctionPoint}getDestinationPoint(){return this.destinationPoint}getAverageSourcePoint(){const t=this.links.map((t=>t.getSource()));return{x:t.reduce(((t,e)=>t+(e.x??0)),0)/t.length,y:t.reduce(((t,e)=>t+(e.y??0)),0)/t.length}}updateSourceStackOffsets(){this.sourceStackOffsets.clear(),this.links.forEach((t=>{const e=t.getSource(),o=(0,l.freeSankeyLinksForDot)(e).filter((t=>t.getFlowDirection()===this.flowDirection));if(1===o.length)return void this.sourceStackOffsets.set(t,{x:0,y:0});const r=o.reduce(((t,e)=>t+e.getThickness()),0),n=t.getThickness(),i=-r/2;let a=0;for(let e=0;e<o.indexOf(t);e++)a+=o[e].getThickness();const s=i+a+n/2;"vertical"===this.orientation?this.sourceStackOffsets.set(t,{x:s,y:0}):this.sourceStackOffsets.set(t,{x:0,y:s})}))}updateDestinationStackOffset(){const t=(0,l.freeSankeysForTarget)(this.target).filter((t=>t.flowDirection===this.flowDirection));if(1===t.length)return void(this.destinationStackOffset={x:0,y:0});const e=t.reduce(((t,e)=>t+e.getTotalThickness()),0),o=this.getTotalThickness(),r=-e/2;let n=0;for(let e=0;e<t.indexOf(this);e++)n+=t[e].getTotalThickness();const i=r+n+o/2;"vertical"===this.orientation?this.destinationStackOffset={x:i,y:0}:this.destinationStackOffset={x:0,y:i}}getTotalThickness(){return this.links.reduce(((t,e)=>t+e.getThickness()),0)}getFirstLinkThickness(){return this.links[0].getThickness()||0}startTransition(t){this.isInTransition=!0,this.transitionStartTime=Date.now(),this.transitionDuration=t}shouldApplyTransition(){if(!this.isInTransition)return!1;return!(Date.now()-this.transitionStartTime>=this.transitionDuration)||(this.isInTransition=!1,!1)}render(){this.updateSourceStackOffsets(),this.updateDestinationStackOffset(),this.updateDestinationPoint(),this.updateJunctionPoint(),this.links.forEach((t=>{t.render({destinationPoint:this.destinationPoint,junctionPoint:this.junctionPoint,bundleOffset:this.bundleOffsetForLink(t),sourceStackOffset:this.sourceStackOffsets.get(t)||null,multiLinkSortIndex:this.destinationSortIndex})}))}bundleOffsetForLink(t){const e=this.links.indexOf(t),o=this.getTotalThickness(),r=t.getThickness(),n=-o/2;let i=0;for(let t=0;t<e;t++)i+=this.links[t].getThickness();const a=n+i+r/2;return"vertical"===this.orientation?{x:a,y:0}:{x:0,y:a}}sortLinks(){"horizontal"===this.orientation?this.links.sort(((t,e)=>{const o=t.getSource(),r=e.getSource();return(o?.y??0)-(r?.y??0)})):this.links.sort(((t,e)=>{const o=t.getSource(),r=e.getSource();return(o?.x??0)-(r?.x??0)}))}update(t){this.sortLinks(),this.updateSourceStackOffsets(),this.updateDestinationStackOffset(),this.updateDestinationPoint(),this.updateJunctionPoint(),void 0!==t&&this.startTransition(t);const e=new Map;this.highlightLinks.forEach((t=>{this.links.forEach((o=>{(t.group.containsType(o.getSource().type)||(0,n.getSuperdotByGroup)(t.group)?.id===o.getSource().id)&&e.set(o,t.color)}))})),this.links.forEach(((t,o)=>{const r=e.get(t)||null;t.update({multiLinkSortIndex:this.destinationSortIndex,destinationPoint:this.destinationPoint,junctionPoint:this.junctionPoint,bundleOffset:this.bundleOffsetForLink(t),sourceStackOffset:this.sourceStackOffsets.get(t)||null,transitionDuration:this.shouldApplyTransition()?this.transitionDuration:void 0,highlightColor:r||void 0})}))}setLinkHighlighted(t,e){const o=this.links.find((e=>e.getSource()===t));o&&o.setHighlighted(e)}clear(){this.links.forEach((t=>t.remove())),this.links=[],this.junctionPoint=null}createLinks(){this.voterGroups&&(this.clear(),this.currentDots=this.getDotsFromVoterGroups(),this.currentDots.forEach((t=>{this.addLink(t)})))}getDotsFromVoterGroups(){if(!this.voterGroups)return[];const t=[];return this.voterGroups.forEach((e=>{const o=(0,n.getSuperdotByGroup)(e);if(o)t.includes(o)||t.push(o);else{const o=r.VoterGroup.activeDots([e]);t.push(...o)}})),t}connectionToDot(t){return this.currentDots.find((e=>e.id===t.id))?this.flowDirection:null}linkForDot(t){return this.links.find((e=>e.getSource().id===t.id))||null}}e.FreeSankey=d},636:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SimImage=void 0;const r=o(569);e.SimImage=class{id;src;alt;rotates=!1;_active=!1;_position={x:0,y:0};_size={width:0,height:0};offset={x:0,y:0};_originalOffset;imageElement;listeners=[];initPosition={x:0,y:0};initSize={width:0,height:0};constructor(t){if(!t.id||""===t.id)throw new Error("ImageConfig must have an id");if(!t.src||""===t.src)throw new Error("ImageConfig must have a source url");if(!t.alt||""===t.alt)throw new Error("ImageConfig must have an alt description");this.id=t.id,this.src=t.src,this.alt=t.alt,this._position=t.position||{x:0,y:0},this.initPosition=t.position||{x:0,y:0},this._size=t.size||{width:0,height:0},this.initSize=t.size||{width:0,height:0},this.offset=t.offset||{x:0,y:0},this.rotates=t.rotates||!1}get position(){return this._position}set position(t){this._position={...t}}updateImage(t=!0){this.imageElement&&("0"!==this.imageElement.style("opacity")&&"none"!==this.imageElement.style("display")&&t?(this.imageElement.transition(`${this.id}-move`).duration(300).attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this.imageElement.transition(`${this.id}-resize`).duration(300).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`)):(this.imageElement.attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this.imageElement.attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`)))}resetPosition(){this.position={...this.initPosition}}resetSize(){this.size={...this.initSize}}get size(){return this._size}set size(t){this._size={...t}}set active(t){this._active=t}get active(){return this._active}addToGroup(t){return!(this.imageElement&&!this.imageElement.empty())&&(this.imageElement=t.append("image").attr("class",`icon-${this.id}`).attr("href",this.src).attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`).attr("width",this.size.width).attr("height",this.size.height).style("transform-box","fill-box").style("transform-origin","center"),this.rotates&&this.addListener("scroll",(()=>{if(this.imageElement){const t=(window.scrollY||window.pageYOffset)/50;this.imageElement.style("transform",`translate(-${this.size.width/2}px, -${this.size.height/2}px) rotate(${t}deg)`)}})),this._active=!0,!0)}removeFromGroup(t){this.imageElement&&(t?this.imageElement.transition().duration(t).style("opacity",0).remove().on("end",(()=>{this.imageElement=void 0})):(this.imageElement.remove(),this.imageElement=void 0),this._active=!1,this.removeListeners())}show(){return new Promise(((t,e)=>{if(!this.imageElement){if(!r.state.svgGroups.imgGroup)return;this.addToGroup(r.state.svgGroups.imgGroup)}this.imageElement?.style("display","block").style("opacity",0).attr("width",this.size.width/2).attr("height",this.size.height/2).attr("transform",`translate(-${this.size.width/4}, -${this.size.height/4})`).transition(`${this.id}-show`).duration(500).style("opacity",1).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this._active=!0,t()}))}hide(){return new Promise(((t,e)=>{this.imageElement?.style("opacity",1).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`).transition(`${this.id}-show`).duration(500).style("opacity",0).attr("width",this.size.width/2).attr("height",this.size.height/2).attr("transform",`translate(-${this.size.width/4}, -${this.size.height/4})`).on("end",(()=>{this.imageElement?.style("display","none")})),this._active=!1,t()}))}addListener(t,e){this.imageElement&&("scroll"===t?window.addEventListener("scroll",e):this.imageElement.on(t,e),this.listeners.push({type:t,callback:e}))}removeListeners(){this.listeners.forEach((t=>{"scroll"===t.type?window.removeEventListener("scroll",t.callback):this.imageElement?.on(t.type,null)}))}}},391:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initLegend=function(){if(!l){l=document.createElement("div"),l.id="dot-legend",l.className="dot-legend",document.body.appendChild(l),l.style.right=`${-S.x+p}px`,l.style.top=`${S.y}px`;const t=document.createElement("div");t.className="dot-legend-header";const e=document.createElement("div");e.textContent="Legend",e.className="dot-legend-header-title",t.appendChild(e);const o=document.createElement("button");o.innerHTML=n.state.legendVisible?"&#8722;":"&#43;",o.title=n.state.legendVisible?"Hide Legend":"Show Legend",o.className="dot-legend-toggle",o.addEventListener("click",R),c=o,t.appendChild(o),l.appendChild(t),u=document.createElement("div"),u.innerHTML='Each <span class="legend-dot black"></span> is ~10,000 people',u.className="dot-legend-size-key",l.appendChild(u),d=document.createElement("div"),d.className="dot-legend-content",d.style.display=n.state.legendVisible?"block":"none",l.appendChild(d);let r,i,a,s,g=!1;t.addEventListener("mousedown",(t=>{g=!0,r=t.clientX,i=t.clientY,a=S.x,s=S.y,l?.classList.add("dragging")})),document.addEventListener("mousemove",(t=>{if(!g)return;const e=t.clientX-r,o=t.clientY-i;S.x=a+e,S.y=s+o,l&&(l.style.right=`${-S.x+p}px`,l.style.top=`${S.y}px`)})),document.addEventListener("mouseup",(()=>{g=!1,l?.classList.remove("dragging")}))}_()},e.updateLegend=_;const r=o(921),n=o(569),i=o(610),a=o(921),s=o(20);let l=null,c=null,d=null,u=null,p=40;const g=new Set(["nonRefundable","nonRefundable2"]),f=new Set(["everyoneRadial"]),h=new Set(["capTheDonationLimit2","bringBackPVS1","capTheDonationLimit2Alt","whatAboutTheTaxCredit","whatAboutTheTaxCredit2"]),y=new Set(["onlyVotersBullseye","capTheDonationLimit1Alt"]),O=new Set(["partiesFocusingOnWealthy","moneyBuysAccess","howTaxCreditWorksOutOfPocket","howTaxCreditWorksPart2","howTaxCreditWorks","benefitsTheAlreadyWealthySetup","outsideLookingIn","exclusiveClub","howTaxCreditWorksOutOfPocket2","bigDonorsGetNearlyHalfOfCredits","capTheDonationLimit2","whatsTheSolutionAlt"]),m=new Set(["capTheDonationLimit2Alt","whatAboutTheTaxCredit","whatAboutTheTaxCredit2","bringBackPVS1","bringBackPVS2"]);let S={x:20,y:110};function R(){n.state.legendVisible=!n.state.legendVisible,d&&(d.style.display=n.state.legendVisible?"block":"none"),u&&(u.style.display=n.state.legendVisible?"block":"none"),c&&(c.innerHTML=n.state.legendVisible?"&#8722;":"&#43;",c.title=n.state.legendVisible?"Hide Legend":"Show Legend")}function w(t){const e=n.state.view;if(!e)return null;for(const o of e.clumps)if(o.groupColorOverride)for(const e of o.groupColorOverride)if(e.group.id===t)return e.color;return null}function _(){if(!l||!d)return;if(0===n.state.seenDotTypes.size)return void(l.style.display="none");if(n.state.view&&f.has(n.state.view.id))return void(l.style.display="none");l.style.display="block",d.style.display=n.state.legendVisible?"block":"none";const t=function(){const t=n.state.view,e=Array.from(n.state.activeDotTypes),o=t&&g.has(t.id),l=t&&h.has(t.id),c=t&&y.has(t.id),d=t&&O.has(t.id),u=t&&m.has(t.id),p=[],f=[],S=[],R=[],_=[];if(e.includes(r.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.id)&&p.push({id:r.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.id,name:"Voters",color:r.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.color,category:"voter",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS)))||!1,shape:"circle"}),e.includes(r.VOTER_TYPES.ELIGIBLE_NON_VOTERS.id)&&p.push({id:r.VOTER_TYPES.ELIGIBLE_NON_VOTERS.id,name:"Non-Voters",color:r.VOTER_TYPES.ELIGIBLE_NON_VOTERS.color,category:"voter",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.ELIGIBLE_NON_VOTERS)))||!1,shape:"circle"}),!e.includes(r.VOTER_TYPES.DONORS_1_199.id)||c||d||u||f.push({id:r.VOTER_TYPES.DONORS_1_199.id,name:"Donated $1-199",color:r.VOTER_TYPES.DONORS_1_199.color,category:"donor",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.DONORS_1_199)))||!1,shape:"circle"}),!e.includes(r.VOTER_TYPES.DONORS_200_499.id)||c||d||u||f.push({id:r.VOTER_TYPES.DONORS_200_499.id,name:"Donated $200-499",color:r.VOTER_TYPES.DONORS_200_499.color,category:"donor",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.DONORS_200_499)))||!1,shape:"circle"}),!e.includes(r.VOTER_TYPES.DONORS_500_999.id)||c||d||u||f.push({id:r.VOTER_TYPES.DONORS_500_999.id,name:"Donated: $500-999",color:r.VOTER_TYPES.DONORS_500_999.color,category:"donor",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.DONORS_500_999)))||!1,shape:"circle"}),!e.includes(r.VOTER_TYPES.DONORS_OVER_1000.id)||c||u||f.push({id:r.VOTER_TYPES.DONORS_OVER_1000.id,name:"Donated $1000+",color:r.VOTER_TYPES.DONORS_OVER_1000.color,category:"donor",isActive:t?.clumps.some((t=>t.group.containsType(r.VOTER_TYPES.DONORS_OVER_1000)))||!1,shape:"circle"}),o){if(e.includes(r.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id)){const e=w(r.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id);S.push({id:r.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id,name:"Above Tax Threshold",color:e||"rgba(0, 0, 0, 0.7)",category:"tax",isActive:t?.clumps.some((t=>t.group.id===r.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id))||!1,shape:"circle"})}if(e.includes(r.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id)){const e=w(r.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id);S.push({id:r.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id,name:"Below Tax Threshold",color:e||"#B5C617",category:"tax",isActive:t?.clumps.some((t=>t.group.id===r.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id))||!1,shape:"circle"})}}if(c){const e=w(r.VOTER_GROUPS.ALL_DONORS.id);f.push({id:r.VOTER_GROUPS.ALL_DONORS.id,name:"All Donors",color:e||a.typeColors.greal,category:"donor",isActive:t?.clumps.some((t=>t.group.id===r.VOTER_GROUPS.ALL_DONORS.id))||!1,shape:"circle"})}if(d){const e=w(r.VOTER_GROUPS.DONORS_1_999.id);f.push({id:r.VOTER_GROUPS.DONORS_1_999.id,name:"Donated $1-999",color:e||a.typeColors.greal,category:"donor",isActive:t?.clumps.some((t=>t.group.id===r.VOTER_GROUPS.DONORS_1_999.id))||!1,shape:"circle"})}const x=e.includes("reform-donor-seen");if(l||x){l&&n.state.seenDotTypes.add("reform-donor-seen");const t=Boolean(l);f.push({id:"reform-donor",name:"With $100 Donor Cap",color:"#B5C617",category:"donor",isActive:t,shape:"circle"})}const k=Object.values(s.viewFreeSankeys).filter((t=>t.getColor()===r.flowColors.green)).map((t=>t.id)),v=Object.values(s.viewFreeSankeys).filter((t=>t.getColor()===r.flowColors.blue)).map((t=>t.id)),E=Object.values(s.viewFreeSankeys).filter((t=>t.getColor()===r.flowColors.purple)).map((t=>t.id));if(t?.freeSankeyGroups&&t.freeSankeyGroups.length>0){const e=t.freeSankeyGroups.some((t=>k.includes(t.freeSankey.id))),o=t.freeSankeyGroups.some((t=>E.includes(t.freeSankey.id))),r=t.freeSankeyGroups.some((t=>v.includes(t.freeSankey.id)));e&&R.push({id:"flow-green",name:"Money Donated",color:"rgba(0, 255, 30, 0.5)",category:"flow",isActive:!0,shape:"square"}),r&&R.push({id:"flow-blue",name:"Tax Refunds for Donating",color:"rgba(0, 106, 255, 0.5)",category:"flow",isActive:!0,shape:"square"}),o&&R.push({id:"flow-purple",name:"Per-Vote Subsidy",color:"rgba(214, 93, 230, 0.5)",category:"flow",isActive:!0,shape:"square"})}return n.state.images.some((t=>"bot-party-icon"===t.id&&t.active))&&_.push({id:"party-icon",name:"Major<br />Federal<br />Parties",image:i.viewImages.partyIcon,category:"icons",isActive:n.state.images.some((t=>"bot-party-icon"===t.id&&t.active))}),n.state.images.some((t=>"parliament-icon-end"===t.id&&t.active))&&_.push({id:"parliament-icon",name:"Canadian<br />Government",image:i.viewImages.parliamentIcon,category:"icons",isActive:n.state.images.some((t=>"parliament-icon-end"===t.id&&t.active))}),[...p,...f,...S,...R,..._]}();let e="",o="";t.forEach((r=>{if(r.category!==o&&t.filter((t=>t.category===r.category)).length>0){o=r.category;let t="";switch(o){case"voter":t="Eligible Voters";break;case"donor":t="Major Party Donors";break;case"tax":t="Tax Threshold";break;case"flow":t="Money Flow";break;case"icons":t="Icons"}e+=`<div class="legend-category">${t}</div>`}const n="square"===r.shape?"legend-square":"legend-dot";r.image?e+=`\n                <div class="legend-item ${r.isActive?"active":"inactive"}">\n                    <img src="${r.image.src}" alt="${r.image.alt}" class="legend-image" />\n                    <span class="legend-label">${r.name}</span>\n                </div>\n            `:e+=`\n                <div class="legend-item ${r.isActive?"active":"inactive"}">\n                    <span class="${n}" style="background-color: ${r.color}"></span>\n                    <span class="legend-label">${r.name}</span>\n                </div>\n            `})),d.innerHTML=e}window.updateLegend=_},185:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkManager=void 0;const r=window.d3,n=o(569),i=o(921),a=o(160),s={colorScheme:{standard:"rgba(80, 255, 100, 0.4)",bundle:"rgba(80, 255, 100, 0.6)"},transitionDurations:{enter:700,update:300,exit:700},bundleLinkDelay:500};e.LinkManager=class{links=[];svgLinkGroup=null;config;verticalLinkGenerator;horizontalLinkGenerator;sankeys=[];constructor(t={}){this.svgLinkGroup=n.state.svgGroups.linksGroup,this.config={...s,...t},this.verticalLinkGenerator=this.createVerticalLinkGenerator(),this.horizontalLinkGenerator=this.createHorizontalLinkGenerator()}activeSankeys(){return this.sankeys.filter((t=>t.active))}createHighlightPath(t){if(!t.flowConfig?.highlightPath)return;const e=t.flowConfig.highlightPath,o=e.fromGroup,r=e.toGroup;if(!o&&!r)return;const i=[];o&&n.state.displayData.forEach((t=>{t.type.id===o&&i.push(t)})),r&&n.state.displayData.forEach((t=>{t.type.id===r&&i.push(t)})),0!==i.length&&this.links.forEach((e=>{e.sankey===t&&e.dot&&i.some((t=>t.id===e.dot?.id))&&(e.highlightPath=!0)}))}calculateOffsetPath(t,e,o=0,r=1){const n=t.getTotalLength();if(n<10)return t.getAttribute("d")||"";const i="number"==typeof e,a=i?0:e.x,s=i?0:e.y,l=i?e:0;o=Math.max(0,Math.min(.99,o)),r=Math.max(o+.01,Math.min(1,r));const c=Math.max(10,Math.floor(n/20)),d=[],u=Math.floor(o*c),p=Math.ceil(r*c);for(let e=u;e<=p;e++){const o=e/c,r=t.getPointAtLength(o*n);d.push({x:r.x,y:r.y})}const g=[];for(let t=0;t<d.length;t++){const e={x:d[t].x,y:d[t].y};if(0!==l){let o=0,r=0;0===t?d.length>1&&(o=d[1].x-d[0].x,r=d[1].y-d[0].y):t===d.length-1?(o=d[t].x-d[t-1].x,r=d[t].y-d[t-1].y):(o=d[t+1].x-d[t-1].x,r=d[t+1].y-d[t-1].y);const n=Math.sqrt(o*o+r*r);n>0&&(o/=n,r/=n);const i=-r,a=o;e.x+=i*l,e.y+=a*l}g.push({x:e.x+a,y:e.y+s})}if(0===g.length)return"";let f=`M${g[0].x},${g[0].y}`;for(let t=1;t<g.length;t++)f+=` L${g[t].x},${g[t].y}`;return f}calculateDotConnectionOffset(t,e){const o=e.allSankeysInSameDirectionForDot(t),r=o.length,n=e.linkThickness(t)||1;if(r<=1)return 0;return-(r*n)/2+o.indexOf(e)*n+n/2}createVerticalLinkGenerator(){const t=r.linkVertical().x((function(t){return t&&"number"==typeof t.x?t.x:0})).y((function(t){return t&&"number"==typeof t.y?t.y:0}));return function(e){if(!e||!e.source||!e.target)return"M0,0L0,0";try{return t(e)??"M0,0L0,0"}catch(t){return"M0,0L0,0"}}}createHorizontalLinkGenerator(){const t=r.linkHorizontal().x((function(t){return t&&"number"==typeof t.x?t.x:0})).y((function(t){return t&&"number"==typeof t.y?t.y:0}));return function(e){if(!e||!e.source||!e.target)return"M0,0L0,0";try{return t(e)??"M0,0L0,0"}catch(t){return"M0,0L0,0"}}}getLinkGenerator(t){return"vertical"===t?this.verticalLinkGenerator:this.horizontalLinkGenerator}setVisibleSankeys(t){const e=[],o=this.activeSankeys();return t?(o.forEach((o=>{t.includes(o)||e.push(this.hideSankey(o))})),t.forEach((t=>{this.sankeyExists(t)||this.sankeys.push(t),e.push(this.showSankey(t))})),Promise.all(e).then((()=>{}))):(o.forEach((t=>{e.push(this.hideSankey(t))})),Promise.all(e).then((()=>{})))}toggleSankey(t){return t.active?this.removeSankey(t):this.addSankey(t)}addSankey(t){return t.active?Promise.resolve():t.validEndpoints()?(this.createLinksForSankey(t),t.active=!0,this.renderLinks()):Promise.resolve()}showSankey(t){return this.sankeyExists(t)&&!t.active?this.addSankey(t):Promise.resolve()}hideSankey(t){return this.sankeyExists(t)&&t.active?this.removeSankey(t):Promise.resolve()}removeSankey(t){return new Promise((e=>{if(0===t.getLinks().length)return t.active=!1,void e();t.removeFromDotData();let o=0,r=0;const n=this.svgLinkGroup?.selectAll("path.link").filter((e=>e.id.startsWith(`${t.id}-`)||e.id.startsWith(`${t.id}-bundle-`)));o=n?.size()||0;o>0&&n?n.style("opacity",0).on("end",(()=>{r++,r>=o&&e()})).remove():e(),this.links=this.links.filter((e=>!e.id.startsWith(`${t.id}-`)&&!e.id.startsWith(`${t.id}-bundle-`))),this.svgLinkGroup&&this.svgLinkGroup.selectAll(`path.offset-arrow-path.sankey-${t.id}`).remove(),t.active=!1}))}sortDotsByPosition(t,e){return"horizontal"===e?[...t].sort(((t,e)=>(t.y??0)-(e.y??0))):[...t].sort(((t,e)=>(t.x??0)-(e.x??0)))}createLinksForSankey(t){if(!t.getWeightedGroups())return;const e=t.getImage();if(!e?.active)return;const o=t.getJunctionCenter(),r=this.calculateJunctionOffsets(t),n=t.flowForDots();if(!n)return;let i=t.getDotsForLinks();if(!i.length)return;i=this.sortDotsByPosition(i,t.orientation),i.forEach(((e,i)=>{const a=t.linkThickness(e)||1,s=r.get(e)||0,l=t.isVertical()?s:0,c=t.isHorizontal()?s:0;e.sankeys.set(t,n);const d=this.calculateDotConnectionOffset(e,t),u=t.isVertical()?d:0,p=t.isHorizontal()?d:0,g={x:(e.x||0)+u,y:(e.y||0)+p},f={x:o.x+l,y:o.y+c},h={x:f.x,y:f.y,isFixed:!0,index:i,sankey:t},y={x:g.x,y:g.y,dot:e,sankey:t},O={id:`${t.id}-link-${i}`,source:t.dotsAreSource()?y:h,target:t.dotsAreSource()?h:y,width:a,sankey:t,dot:e};this.links.push(O)}));const a=t.dotsAreSource()?o:e.position,s=t.dotsAreSource()?e.position:o;this.createBundleLink(t,a,s),t.flowConfig?.highlightPath&&this.createHighlightPath(t)}createBundleLink(t,e,o){const r={id:`${t.id}-bundle-link`,source:{x:e.x,y:e.y,isFixed:!0,sankey:t},target:{x:o.x,y:o.y,isFixed:!0,sankey:t},width:t.totalThickness,sankey:t};this.links.push(r)}calculateJunctionOffsets(t){const e=new Map,o=t.getDotsForLinks(),r=o.length*t.totalThickness,n=t.totalThickness/r;let i=-t.totalThickness/2;return o.forEach((o=>{const r=(t.linkThickness(o)||1)*n;e.set(o,i+r/2),i+=r})),e}groupJunctionsByProximity(){const t=new Map,e=new Set;return this.activeSankeys().forEach((o=>{if(e.has(o))return;const r=o.getJunctionCenter(),n=`junction-group-${t.size}`,i=[o];e.add(o),this.activeSankeys().forEach((t=>{if(o===t||e.has(t))return;const n=t.getJunctionCenter();Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2))<=20&&(i.push(t),e.add(t))})),(i.length>1||this.getSankeyIndividualLinks(i[0]).length>0)&&t.set(n,i)})),t}getSankeyIndividualLinks(t){return this.links.filter((e=>e.id.startsWith(`${t.id}-link-`)&&!e.id.includes("bundle")))}updateSankeyJunctionPositions(){const t=this.groupJunctionsByProximity();let e=0,o=0;this.activeSankeys().forEach((t=>{t.isVertical()?e++:o++}));const r=e>=o;t.forEach(((t,e)=>{if(0===t.length)return;const o=this.sortSankeysByDotPositions(t.map((t=>({link:{},sankey:t}))),r).map((t=>t.sankey)),i=[];if(o.forEach((t=>{const e=this.getSankeyIndividualLinks(t);if(0===e.length)return;const o=t.dotsAreSource(),r=new Map;e.forEach((t=>{t.dot&&(r.has(t.dot)||r.set(t.dot,[]),r.get(t.dot).push(t))}));const a=Array.from(r.keys()).map((t=>n.state.displayData.find((e=>e.id===t.id))||n.state.superdots.find((e=>e.id===t.id)))).filter((t=>void 0!==t));this.sortDotsByPosition(a,t.orientation).forEach((e=>{(r.get(e)||[]).forEach((e=>{const r=o,n=r?e.target:e.source;i.push({link:e,sankey:t,isJunctionTarget:r,vertex:n,width:e.width||1})}))}))})),0===i.length)return;const a=i.reduce(((t,e)=>t+e.width),0),s=o[0].getJunctionCenter();let l=r?s.x:s.y;l-=a/2;const c=r?s.y:s.x;let d=l;i.forEach((t=>{const e=d+t.width/2;t.vertex.x=r?e:c,t.vertex.y=r?c:e,t.vertex.isFixed=!0,d+=t.width}))}))}renderLinks(){if(!this.svgLinkGroup)return Promise.resolve();const t=this.svgLinkGroup;return t.selectAll("path.offset-arrow-path").remove(),new Promise((e=>{const o=t.selectAll("path.link").data(this.links);let n=0,i=0;const a=()=>{i++,i>=n&&(this.createOffsetArrows(),e())},s=t=>(t.each((function(t){const e=r.select(this),o=t.sankey;if(!o)return;e.classed("arrow-start",!1).classed("arrow-end",!1).classed("arrow-mid",!1).classed("flow-dashed",!1).classed("animated-flow",!1).classed("animated-flow-markers",!1).classed("highlight-path",!1);const n=o.flowConfig;"arrow"===n.style&&n.arrowPosition&&("start"!==n.arrowPosition&&"both"!==n.arrowPosition||e.classed("arrow-start",!0),"end"!==n.arrowPosition&&"both"!==n.arrowPosition||e.classed("arrow-end",!0),"mid"===n.arrowPosition&&e.classed("arrow-mid",!0)),"dashed"===n.style&&e.classed("flow-dashed",!0),n.highlightPath&&(t.highlightPath?e.classed("highlight-path",!0).attr("stroke",n.highlightPath.color||o.color).attr("stroke-width",n.highlightPath.width||1.5*t.width):t.id.includes("bundle-link")&&e.attr("stroke",o.color).attr("stroke-width",t.width))})),t),l=o.enter().append("path").lower().attr("class","link").attr("stroke",(t=>t.sankey?.color||this.config.colorScheme.standard)).attr("fill","none").attr("stroke-width",(t=>t.width)).attr("d",(t=>this.getLinkGenerator(t.sankey?.orientation)(t))).attr("id",(t=>t.id)).style("opacity",0).call(s),c=l.size();n+=c,c>0&&l.transition("link-transition-in").duration(this.config.transitionDurations.enter).style("opacity",1);const d=o.attr("id",(t=>t.id)).call(s).transition("link-transition-update").duration(this.config.transitionDurations.update).attr("stroke-width",(t=>t.width)).attr("stroke",(t=>t.sankey?.color||this.config.colorScheme.standard)),u=d.size();n+=u,u>0&&d.attr("d",(t=>this.getLinkGenerator(t.sankey?.orientation)(t))).on("end",a);const p=o.exit(),g=p.size();n+=g,g>0&&p.transition("link-transition-out").duration(this.config.transitionDurations.exit).style("opacity",0).on("end",a).remove(),0===n&&e()}))}clearAll(){this.activeSankeys().forEach((t=>{this.removeSankey(t)})),this.links=[],this.svgLinkGroup&&this.svgLinkGroup.selectAll("path.offset-arrow-path").remove()}sankeyExists(t){return this.sankeys.some((e=>e.id===t.id))}tick(){try{if(this.updateSankeyJunctionPositions(),this.updateBundleLinkPositions(),this.updateLinkPositions(),this.svgLinkGroup){const t=this.svgLinkGroup.selectAll(".link").data(this.links,(t=>t.id)),e=t=>(t.each((function(t){const e=r.select(this),o=t.sankey;if(o){if(!e.classed("flow-dashed")&&!e.classed("animated-flow")){e.classed("flow-dashed",!1).classed("animated-flow",!1).classed("animated-flow-markers",!1).classed("highlight-path",!1);const t=o.flowConfig;("dashed"===t.style||t.dashed)&&e.classed("flow-dashed",!0)}o.flowConfig.highlightPath&&(t.highlightPath?e.classed("highlight-path",!0).attr("stroke",o.flowConfig.highlightPath.color||o.color).attr("stroke-width",o.flowConfig.highlightPath.width||1.5*t.width):t.id.includes("bundle-link")&&e.attr("stroke",o.color).attr("stroke-width",t.width))}})),t);t.attr("d",(t=>this.getLinkGenerator(t.sankey?.orientation)(t))).call(e),this.updateOffsetArrows()}}catch(t){}}trimPathEnd(t,e=.5){if(!t||t.length<5)return t;const o=t.split(/(?=[LMC])/);if(o.length<2)return t;const r=o[o.length-1],n=o[o.length-2];if("L"!==r[0]||"L"!==n[0])return t;const i=r.substring(1).split(",").map(Number),a=n.substring(1).split(",").map(Number);if(2!==i.length||2!==a.length)return t;const s=i[0]-a[0],l=i[1]-a[1],c=Math.sqrt(s*s+l*l);if(c<2*e)return t;const d=(c-e)/c,u=a[0]+s*d,p=a[1]+l*d;return o[o.length-1]=`L${u},${p}`,o.join("")}getArrowStyle(t,e,o=!1){const r={offset:8,trimStart:0,trimEnd:1,opacity:1,width:4,color:t.color};if(!t.flowConfig)return r;if(o&&t.flowConfig.junctionArrowStyle)return{...r,...t.flowConfig.arrowStyle,...t.flowConfig.junctionArrowStyle};let s={...r};if(t.flowConfig.arrowStyle&&(s={...s,...t.flowConfig.arrowStyle}),!t.flowConfig.groupArrowStyles||o)return s;let l="";if(e.dot?.type?.id){if(l=e.dot.type.id,l&&t.flowConfig.groupArrowStyles[l])return{...s,...t.flowConfig.groupArrowStyles[l]};if((0,a.isSuperdot)(e.dot)){const o=e.dot.id,r=n.state.view?.clumps.find((t=>t.superdot&&(0,a.superdotIDForClump)(t)===o));if(r){if(t.flowConfig.groupArrowStyles[r.group.id])return{...s,...t.flowConfig.groupArrowStyles[r.group.id]};const e=Object.keys(t.flowConfig.groupArrowStyles);for(const o of e){const e=i.VOTER_GROUPS[o]||Object.values(i.VOTER_GROUPS).find((t=>t.id===o));if(e&&r.group.sameTypesAs(e))return{...s,...t.flowConfig.groupArrowStyles[o]};if(e&&r.group.containsAllTypesFromGroup(e))return{...s,...t.flowConfig.groupArrowStyles[o]}}}}}return s}updateOffsetArrows(){if(!this.svgLinkGroup)return;this.svgLinkGroup.selectAll("path.link").filter((t=>{const e=t.sankey?.flowConfig;return"arrow"===e?.style||void 0!==e?.arrowStyle||void 0!==e?.groupArrowStyles||void 0!==e?.junctionArrowStyle})).each(((t,e,o)=>{const n=o[e],i=t.sankey;if(!i||!i.flowConfig)return;const a=t.id.includes("bundle-link"),s=this.getArrowStyle(i,t,a);let l=this.calculateOffsetPath(n,s.offset||8,s.trimStart||0,s.trimEnd||1);l=this.trimPathEnd(l,.5);const c=this.svgLinkGroup.selectAll("path.offset-arrow-path").filter((function(){return r.select(this).attr("d")===t.offsetArrowPath})),d=s.color||i.color,u=s.headColor||d,p=this.getOrCreateColoredMarker(u);c.size()>0?c.attr("d",l).attr("stroke",d).attr("stroke-width",s.width||4).style("opacity",s.opacity||1).attr("marker-end",`url(#${p})`):(this.svgLinkGroup.append("path").attr("class",`offset-arrow-path sankey-${i.id}`).attr("d",l).attr("stroke",d).attr("stroke-width",s.width||4).style("opacity",s.opacity||1).attr("marker-end",`url(#${p})`).lower(),this.svgLinkGroup.selectAll("path.link").raise()),t.offsetArrowPath=l}))}updateBundleLinkPositions(){const t=new Map,e=this.groupJunctionsByProximity(),o=new Map;e.forEach(((t,e)=>{t.forEach((t=>{o.set(t.id,t)}))})),this.links.forEach((e=>{if(!e.id.includes("bundle-link")||!e.sankey)return;const o=e.sankey,r=o.getImage();r&&(t.has(r)||t.set(r,[]),t.get(r).push({link:e,sankey:o}))})),t.forEach(((t,e)=>{if(t.length<=1){const{link:o,sankey:r}=t[0],n=e.position,i=e.imageElement;i&&(n.x=parseFloat(i.attr("x"))||n.x,n.y=parseFloat(i.attr("y"))||n.y),r.dotsAreSource()?(o.target.x=n.x,o.target.y=n.y):(o.source.x=n.x,o.source.y=n.y)}else this.distributeImageLinkEndpoints(e,t)})),e.forEach(((t,e)=>{if(t.length<=1)t.forEach((t=>{const e=this.links.find((e=>e.id===`${t.id}-bundle-link`));if(!e)return;const o=t.getJunctionCenter();t.dotsAreSource()?(e.source.x=o.x,e.source.y=o.y):(e.target.x=o.x,e.target.y=o.y)}));else{const e=[];if(t.forEach((t=>{const o=this.links.find((e=>e.id===`${t.id}-bundle-link`));o&&e.push({link:o,sankey:t})})),0===e.length)return;let o=0,r=0;t.forEach((t=>{t.isVertical()?o++:r++}));const n=o>=r,i=this.sortSankeysByDotPositions(e,n),a=i.reduce(((t,{sankey:e})=>t+e.totalThickness),0),s=i[0].sankey.getJunctionCenter();let l=n?s.x:s.y;l-=a/2;const c=n?s.y:s.x;let d=l;i.forEach((({link:t,sankey:e})=>{const o=e.totalThickness,r=d+o/2;if(e.dotsAreSource()){const e=t.source;e.x=n?r:c,e.y=n?c:r}else{const e=t.target;e.x=n?r:c,e.y=n?c:r}d+=o}))}}))}calculateSankeySpatialWeight(t,e){let o=0;if("image"===t.source.type&&t.source.offset?o=e?t.source.offset.x||0:t.source.offset.y||0:"image"===t.target.type&&t.target.offset&&(o=e?t.target.offset.x||0:t.target.offset.y||0),0!==o)return o;const r=t.getDotsForLinks();if(0===r.length)return 0;return r.reduce(((t,o)=>t+(e?o.x||0:o.y||0)),0)/r.length}sortSankeysByDotPositions(t,e){const o=new Map;return t.forEach((({sankey:t})=>{if(!o.has(t)){const r=this.calculateSankeySpatialWeight(t,e);o.set(t,r)}})),[...t].sort(((t,e)=>(o.get(t.sankey)||0)-(o.get(e.sankey)||0)))}distributeImageLinkEndpoints(t,e){if(e.length<=1)return;const o=e.reduce(((t,{sankey:e})=>t+e.totalThickness),0),r=t.position;let n=0,i=0;this.activeSankeys().forEach((t=>{t.isVertical()?n++:i++}));const a=n>=i,s=this.sortSankeysByDotPositions(e,a);let l=a?r.x:r.y;l-=o/2;let c=l;s.forEach((({link:t,sankey:e})=>{const o=e.totalThickness,n=c+o/2,i=e.getJunctionCenter();e.dotsAreSource()?(t.source.x=i.x,t.source.y=i.y,a?(t.target.x=n,t.target.y=r.y):(t.target.x=r.x,t.target.y=n)):(a?(t.source.x=n,t.source.y=r.y):(t.source.x=r.x,t.source.y=n),t.target.x=i.x,t.target.y=i.y),c+=o}))}reorderLinksByDotPositions(){if(!n.state.displayData.length)return;const t=[],e=new Set,o=new Map;this.activeSankeys().forEach((t=>{const e=t.getImage();e&&(o.has(e)||o.set(e,[]),o.get(e).push(t))}));let r=0,i=0;this.activeSankeys().forEach((t=>{t.isVertical()?r++:i++}));const a=r>=i;o.forEach(((t,e)=>{if(t.length<=1)return;const r=this.sortSankeysByDotPositions(t.map((t=>({link:{},sankey:t}))),a).map((t=>t.sankey));o.set(e,r)}));const s=[];o.forEach((t=>{t.forEach((t=>{s.includes(t)||s.push(t)}))})),this.activeSankeys().forEach((t=>{s.includes(t)||s.push(t)})),s.forEach((o=>{this.sortDotsByPosition(o.getDotsForLinks(),o.orientation).forEach(((r,n)=>{const i=o.getLinksForDot(r);0!==i.length&&i.forEach((o=>{t.push(o),e.add(o.id)}))}));const r=this.links.find((t=>t.id===`${o.id}-bundle-link`));r&&!e.has(r.id)&&(t.push(r),e.add(r.id))})),this.links.forEach((o=>{e.has(o.id)||t.push(o)})),this.links=t}updateLinkPositions(){this.reorderLinksByDotPositions(),this.links.forEach((t=>{if(t.id.includes("bundle"))return;if(!t.sankey)return;if(!t.dot)return;const e=t.dot;if(!n.state.displayData.find((t=>t.id===e.id))&&!n.state.superdots.find((t=>t.id===e.id)))return;const o=t.source.dot===t.dot,r=o?t.source:t.target,i=t.sankey.isHorizontal(),a=this.calculateDotConnectionOffset(t.dot,t.sankey);r.x=(t.dot.x||0)+(i?0:a),r.y=(t.dot.y||0)+(i?a:0)}))}getOrCreateColoredMarker(t){const e=`offset-arrow-${t.replace(/[^a-zA-Z0-9]/g,"-")}`;if(!document.getElementById(e)){const o=document.querySelector("svg");let n=o.querySelector("defs");n||(n=document.createElementNS("http://www.w3.org/2000/svg","defs"),o.appendChild(n));r.select(n).append("marker").attr("id",e).attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill",t).attr("stroke","none")}return e}createOffsetArrows(){if(!this.svgLinkGroup)return;this.svgLinkGroup.selectAll("path.offset-arrow-path").remove();this.svgLinkGroup.selectAll("path.link").filter((t=>{const e=t.sankey?.flowConfig;return"arrow"===e?.style||void 0!==e?.arrowStyle||void 0!==e?.groupArrowStyles||void 0!==e?.junctionArrowStyle})).each(((t,e,o)=>{const r=o[e],n=t.sankey;if(!n||!n.flowConfig)return;const i=t.id.includes("bundle-link"),a=this.getArrowStyle(n,t,i);let s=this.calculateOffsetPath(r,a.offset||8,a.trimStart||0,a.trimEnd||1);s=this.trimPathEnd(s,.5),t.offsetArrowPath=s;const l=a.color||n.color,c=a.headColor||l,d=this.getOrCreateColoredMarker(c);this.svgLinkGroup.append("path").attr("class",`offset-arrow-path sankey-${n.id}`).attr("d",s).attr("stroke",l).attr("stroke-width",a.width||4).style("opacity",a.opacity||1).attr("marker-end",`url(#${d})`).lower()})),this.svgLinkGroup.selectAll("path.link").raise()}ensureLinkVisibility(){try{this.svgLinkGroup?.selectAll(".link").style("display","block").style("visibility","visible"),this.svgLinkGroup?.selectAll(".offset-arrow-path").style("display","block").style("visibility","visible")}catch(t){}}getLinks(){return this.links}}},114:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initVisualization=function(t){const e=r.select(`#${t}`).append("svg").attr("width",n.state.svgWidth).attr("height",n.state.svgHeight),o=e.append("defs");o.append("marker").attr("id","offset-arrow").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#00c000").attr("stroke","none");const a=o.append("marker").attr("id","animated-flow").attr("viewBox","0 0 40 10").attr("refX",20).attr("refY",5).attr("markerWidth",20).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","userSpaceOnUse");a.append("path").attr("d","M0,5L40,5").attr("class","flow-path"),a.append("circle").attr("cx",5).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-1"),a.append("circle").attr("cx",15).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-2"),a.append("circle").attr("cx",25).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-3"),a.append("circle").attr("cx",35).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-4"),n.state.svgGroups.rearAnnotationsGroup=e.append("g").attr("class","rear-annotations"),n.state.svgGroups.linksGroup=e.append("g").attr("class","links"),n.state.svgGroups.dotsGroup=e.append("g").attr("class","dots"),n.state.svgGroups.imgGroup=e.append("g").attr("class","images"),n.state.svgGroups.frontAnnotationsGroup=e.append("g").attr("class","front-annotations"),function(){if(!n.state.svgGroups.dotsGroup)return;n.state.svgGroups.linksGroup?.lower(),n.state.svgGroups.dotsGroup.selectAll("circle.superdot").lower(),n.state.svgGroups.dotsGroup.selectAll("circle:not(.superdot)").raise()}(),n.state.svg=e;e.selectAll("circle").data(n.state.displayData.slice(1)).enter().append("circle").attr("r",n.state.dotRadius).attr("fill",(function(t){return t.primaryGroup.color||"#000"}));e.on("pointermove",c.pointerMoveHandler),e.on("pointerout",c.pointerOutHandler),u=n.state.linkManager=new i.LinkManager,u&&u.ensureLinkVisibility();return e.on("transitionend",(function(){u&&u.ensureLinkVisibility()})),e},e.cleanupVisualization=function(t){if(!t)return;u&&u.clearAll()},e.renderView=function(t,e=!0,o=!1){if(!n.state.svgGroups.dotsGroup)return;n.state.dotRadius=t.dotRadius;const i=t.clumps.filter((t=>!0===t.superdot)),c=(t.clumps.filter((t=>!0!==t.superdot)),n.state.displayData.slice(1).filter((t=>!(0,a.isSuperdot)(t))));n.state.svgGroups.dotsGroup.selectAll("circle:not(.superdot)").data(c,(t=>t.id)).join((t=>{const o=t.append("circle").attr("r",0).attr("fill",(t=>g(t))).style("opacity",0);return e?o.transition("voter-circles").duration(500).ease(r.easeCubicInOut).attr("r",n.state.dotRadius).style("opacity",(t=>null!=t.activeClump?.render?.opacity?t.activeClump.render.opacity:1)):o.attr("r",n.state.dotRadius).style("opacity",(t=>null!=t.activeClump?.render?.opacity?t.activeClump.render.opacity:1))}),(t=>e?t.transition("voter-circles").duration(500).ease(r.easeCubicInOut).attr("fill",(t=>g(t))).attr("r",n.state.dotRadius).style("opacity",(t=>null!=t.activeClump?.render?.opacity?t.activeClump.render.opacity:1)):t.attr("fill",(t=>g(t))).attr("r",n.state.dotRadius).style("opacity",(t=>null!=t.activeClump?.render?.opacity?t.activeClump.render.opacity:1))),(t=>e?t.transition("voter-circles").duration(500).ease(r.easeCubicInOut).style("opacity",0).remove():t.remove())),(0,a.renderSuperdotsFromClumps)(i,e),t.freeSankeyGroups&&t.freeSankeyGroups.forEach((t=>{const r=t.freeSankey;t.offset?r.junctionOffset=t.offset:r.resetJunctionOffset(),t.highlightLinks?r.highlightLinks=t.highlightLinks:r.highlightLinks=[],n.state.freeSankeys.includes(r)?(r.update(e?100:void 0),o&&r.updateLinkThicknesses()):(n.state.freeSankeys.push(r),r.createLinks())}));n.state.freeSankeys&&(n.state.freeSankeys.forEach((e=>{t.freeSankeyGroups?.some((t=>t.freeSankey===e))||e.clear()})),n.state.freeSankeys=n.state.freeSankeys.filter((e=>t.freeSankeyGroups?.some((t=>t.freeSankey===e)))));if(t.images){const o=n.state.images.filter((t=>t.active));t.images.forEach((t=>{t.position?t.image.position=t.position:t.image.resetPosition(),t.size?t.image.size=t.size:t.image.resetSize(),t.offset?(t.image._originalOffset||(t.image._originalOffset={...t.image.offset}),t.image.offset=t.offset):t.image._originalOffset&&(t.image.offset=t.image._originalOffset),n.state.images.includes(t.image)||n.state.images.push(t.image),o.includes(t.image)||t.image.show(),t.image.updateImage(e)}))}n.state.images.forEach((e=>{t.images?.some((t=>t.image===e))||e.hide()})),u?.setVisibleSankeys(t.sankeyGroups?.map((t=>t.sankey))||[]),(0,s.setTextForView)(t),(0,l.renderSvgAnnotations)(t,e)},e.renderAnnotations=function(){const t=r.annotationCallout,e=(r.timeParse("%d-%b-%y"),r.timeFormat("%d-%b-%y"),r.scaleTime().range([0,800]),r.scaleLinear().range([300,0]),r.annotation());e.editMode(!0).notePadding(15).type(t).annotations([{note:{label:"Longer text to show text wrapping",bgPadding:{top:15,left:10,right:10,bottom:10},title:"Annotations :)"},data:{date:"18-Sep-09",close:185.02},className:"show-bg",dy:137,dx:162}]),r.select("svg").append("g").attr("class","annotation-group").call(e)},e.ticked=function(){try{if(n.state.isStopped)return;n.state.svgGroups.dotsGroup?.selectAll("circle:not(.superdot)").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})),n.state.superdots.length>0&&n.state.view&&function(){if(!n.state.view)return;n.state.view.clumps.filter((t=>!0===t.superdot)).forEach((t=>{let e=0,o=0,r=0;if(n.state.displayData.forEach((n=>{n.activeClump===t&&(e+=n.x||0,o+=n.y||0,r++)})),r>0){const i=e/r,s=o/r;n.state.superdots.find((e=>e.id===(0,a.superdotIDForClump)(t)))&&(0,a.updateSuperdot)(i,s,t)}}))}(),n.state.view?.freeSankeyGroups&&n.state.view.freeSankeyGroups.forEach((t=>{t.freeSankey.update()})),(0,s.updateTextPositions)(),(0,l.updateSvgAnnotationPositions)();const t=document.getElementById("simulation-info");t&&(t.innerHTML=`\n                <div>Alpha: ${n.state.simulation.alpha().toFixed(2)}</div>\n                <div>Dots: ${n.state.displayData.length}</div>\n                <div>Links: ${u?.getLinks().length}</div>\n                <div>Superdots: ${n.state.superdots.length}</div>\n                <div>Status: ${n.state.isStopped?"STOPPED":"Running"}</div>\n            `)}catch(t){}},e.calculateGroupCenters=p,e.getColorForDot=g,e.calculateClumpGroupCenters=function(t){const e=[],o=p(t.map((t=>t.group)));return t.forEach(((t,r)=>{const n=t.group,i=o.get(n);i&&e.push({groupIndex:r,x:i.x,y:i.y})})),e};const r=window.d3;window.d3.annotation;const n=o(569),i=o(185),a=o(160),s=o(297),l=o(734),c=o(795),d=o(566);let u=null;function p(t){const e=new Map;return t.forEach((t=>{let o=0,r=0,i=0;n.state.displayData.forEach((e=>{t.shouldIncludeDot(e)&&(o+=e.x||0,r+=e.y||0,i++)})),i>0&&e.set(t,{x:o/i,y:r/i})})),e}function g(t){const e=n.state.view?.id;if(e&&void 0!==t.x&&void 0!==t.y){const o=d.gradientConfigs.filter((o=>o.viewId===e&&o.groupIds.includes(t.type.id)));if(o.length>0)return(0,d.calculateGradientColor)(t,o[0])}if(t.activeClump?.groupColorOverride){const e=new Map;if(t.activeClump?.groupColorOverride.forEach((t=>{t.group.types.forEach((o=>{e.set(o,t.color)}))})),e.has(t.type))return e.get(t.type)||"#000"}return t.type.color||"#000"}},3:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sankey=void 0;const r=window.d3,n=o(613),i=o(114),a=o(160),s=o(569);e.Sankey=class{id;description;orientation;totalThickness;color;source;target;active;flowConfig;constructor(t){this.id=t.id,this.description=t.description,this.orientation=t.orientation||"vertical",this.totalThickness=t.totalThickness,this.color=t.color||"rgba(255, 80, 176, 0.4)",this.source=t.source,this.target=t.target,this.active=t.active||!1,this.flowConfig=t.flowConfig||{style:"normal",animated:!1},this.validEndpoints()}getImage(){return"image"===this.source.type?this.source.image:"image"===this.target.type?this.target.image:void 0}getImageOffset(){return"image"===this.source.type?this.source.offset||{x:0,y:0}:"image"===this.target.type?this.target.offset||{x:0,y:0}:void 0}getJunctionCenter(){const t=this.getImage();if(!t)return{x:0,y:0};const e=this.getImageOffset()||{x:0,y:0};return{x:t.position.x+e.x,y:t.position.y+e.y}}getEndpointPositions(){let t={x:0,y:0},e={x:0,y:0};if("position"===this.source.type&&this.source.position&&(t=this.source.position),"position"===this.target.type&&this.target.position&&(e=this.target.position),"groups"===this.source.type){const e=this.source.groups;if(e){const o=e.map((t=>t.group)),r=n.VoterGroup.fromGroups(o),a=(0,i.calculateGroupCenters)([r]).get(r);a&&(t={x:a.x,y:a.y})}}if("groups"===this.target.type){const t=this.target.groups;if(t){const o=t.map((t=>t.group)),r=n.VoterGroup.fromGroups(o),a=(0,i.calculateGroupCenters)([r]).get(r);a&&(e={x:a.x,y:a.y})}}if("image"===this.source.type){const e=this.source.image,o=this.source.offset||{x:0,y:0};e&&(t={x:e.position.x+o.x,y:e.position.y+o.y})}if("image"===this.target.type){const t=this.target.image,o=this.target.offset||{x:0,y:0};t&&(e={x:t.position.x+o.x,y:t.position.y+o.y})}return{start:t,end:e}}getWeightedGroups(){return"groups"===this.source.type?this.source.groups:"groups"===this.target.type?this.target.groups:void 0}isHorizontal(){return"horizontal"===this.orientation}isVertical(){return"vertical"===this.orientation}linkThickness(t){const e=this.getWeightedGroups();if(!e)return 0;let o=[];if(e.forEach((e=>{if(e.useSuperdot){const r=(0,a.getSuperdotByGroup)(e.group);r&&(0,a.isSuperdot)(t)&&r===t&&o.push(e)}e.group.containsType(t.type)&&o.push(e)})),0==o.length)return 0;const r=(0,a.isSuperdot)(t)?1:o[0].group.dotCount,n=o.reduce(((t,e)=>t+e.percentage),0);return this.totalThickness*n/r}dotsAreSource(){return"groups"===this.source.type}dotsAreTarget(){return"groups"===this.target.type}isDotsToImage(){return"groups"===this.source.type&&"image"===this.target.type}isImageToDots(){return"image"===this.source.type&&"groups"===this.target.type}getLinks(){return s.state.linkManager?.getLinks().filter((t=>t.id.startsWith(`${this.id}-`)||t.id.startsWith(`${this.id}-bundle-`)))||[]}getLinksForDot(t){return this.getLinks().filter((e=>e.source.dot?.id===t.id||e.target.dot?.id===t.id))}ownsLink(t){return t.id.startsWith(`${this.id}-`)||t.id.startsWith(`${this.id}-bundle-`)}getPositionFromSuperdotToJunction(t,e=.5){let o=[],n="target";if("groups"===this.target.type&&this.target.groups&&(o=this.target.groups.filter((e=>e.group.id===t||e.group.name===t))),0===o.length&&"groups"===this.source.type&&this.source.groups&&(o=this.source.groups.filter((e=>e.group.id===t||e.group.name===t)),n="source"),0===o.length)return this.getJunctionCenter();o.length;const i=o[0].group,s=(0,a.getSuperdotByGroup)(i);if(s){const t=this.getLinksForDot(s);if(t.length>0){const o=t[0],n=r.select(`#${o.id}`);if(n.empty())return this.getJunctionCenter();const i=n.node();if(i){const t=i.getTotalLength(),o=i.getPointAtLength(t*e);return{x:o.x,y:o.y}}}return this.getJunctionCenter()}return{x:0,y:0}}getAllDots(){const t=this.getWeightedGroups();return t?s.state.displayData.filter((e=>e.type.belongsInGroups(t.map((t=>t.group))))):[]}getDotsForLinks(){const t=this.getWeightedGroups();if(!t)return[];const e=t.filter((t=>t.useSuperdot));if(e.length){const o=t.filter((t=>!t.useSuperdot)),r=[];return r.push(...n.VoterGroup.activeDots(o.map((t=>t.group)))),e.forEach((t=>{const e=(0,a.getSuperdotByGroup)(t.group);e?r.includes(e)||r.push(e):r.push(...n.VoterGroup.activeDots([t.group]))})),r}return this.getAllDots()}flowForDots(){return this.dotsAreSource()?"outgoing":this.dotsAreTarget()?"incoming":void 0}removeFromDotData(){this.getAllDots().forEach((t=>t.sankeys.delete(this)))}addToDotData(){const t=this.getAllDots(),e=this.flowForDots();e&&t.forEach((t=>t.sankeys.set(this,e)))}allSankeysInSameDirectionForDot(t){return Array.from(t.sankeys.entries()).filter((([t,e])=>e===this.flowForDots()&&t.active)).map((([t])=>t))}validEndpoints(){return(!this.isDotsToImage()||!this.isImageToDots())&&!(!this.dotsAreSource()&&!this.dotsAreTarget())}}},517:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initSimulation=function(){(0,s.updateDisplayData)(),i.state.simulation=r.forceSimulation(i.state.displayData).alpha(1).alphaTarget(.1).velocityDecay(.3).on("tick",n.ticked);r.select("body")},e.simulateView=function(t,e=!0){if(!t)return;i.state.dotRadius=t.dotRadius;let o=t.forceStrength?.collide||i.state.dotRadius*a.COLLIDE_DISTANCE_MULT,n=t.forceStrength?.charge||i.state.dotRadius*a.DOT_CHARGE_STRENGTH;t.forceStrength?.chargeMultiplier&&(n*=t.forceStrength.chargeMultiplier);t.forceStrength?.collideMultiplier&&(o*=t.forceStrength.collideMultiplier);const s=t.forceStrength?.standard||a.GROUPED_FORCE_STRENGTH,c=t.forceStrength?.radial||a.RADIAL_STRENGTH;if(i.state.simulation.force("x",r.forceX((e=>e.activeClump&&!e.activeClump.force?i.state.svgWidth/2:(0,l.isCustomForce)(e.activeClump?.force)?e.activeClump.force.center?.x??i.state.svgWidth/2:t.center?t.center.x:i.state.svgWidth/2)).strength((t=>t.activeClump&&!t.activeClump.force?s:(0,l.isCustomForce)(t.activeClump?.force)?t.activeClump&&t.activeClump.force?.strength?t.activeClump.force.strength:s:0))).force("y",r.forceY((e=>e.activeClump&&!e.activeClump.force?i.state.svgHeight/2:(0,l.isCustomForce)(e.activeClump?.force)?e.activeClump.force.center?.y??i.state.svgHeight/2:t.center?t.center.y:i.state.svgHeight/2)).strength((t=>t.activeClump&&!t.activeClump.force?s:(0,l.isCustomForce)(t.activeClump?.force)?t.activeClump&&t.activeClump.force?.strength?t.activeClump.force.strength:s:0))).force("radial",r.forceRadial((t=>{if((0,l.isRadialForce)(t.activeClump?.force)){t.radialAssignment||=Math.random();const e=t.activeClump.force.boundary;return e.inner+t.radialAssignment*(e.outer-e.inner)}return 0}),t.center?.x||i.state.svgWidth/2,t.center?.y||i.state.svgHeight/2).strength((t=>(0,l.isRadialForce)(t.activeClump?.force)?t.activeClump&&t.activeClump.force?.strength?t.activeClump.force.strength:c:0))),i.state.simulation.force("collide",r.forceCollide(o).iterations(3)).force("charge",r.forceManyBody().strength(((t,e)=>0===e?i.state.dotRadius*a.MOUSE_CHARGE_STRENGTH:n))),i.state.simulation.nodes(i.state.displayData),e){const t=1;i.state.simulation.alpha(t).restart()}else i.state.simulation.tick(1)},e.addCursorNode=function(){const t=a.CURSOR_NODE_DATA;i.state.displayData.unshift(t),i.state.cursorNode=t},e.removeCursorNode=function(){if(!i.state.cursorNode)return;i.state.displayData=i.state.displayData.slice(1),i.state.cursorNode=null};const r=window.d3,n=o(114),i=o(569),a=o(921),s=o(646),l=o(566)},569:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.state=void 0,e.setTweenView=function(t){e.state.view=t,(0,s.updateDisplayData)(t),(0,n.renderView)(t,!e.state.isTweening),(0,r.simulateView)(t,!e.state.isTweening),e.state.isTweening=!0},e.createTweenView=function(t,o,r){const n=[],i=[];t.clumps.forEach((t=>{let e=!1;o.clumps.forEach((o=>{t.group.sameTypesAs(o.group)&&t.force?.type===o.force?.type&&(n.push([t,o]),e=!0)})),e||i.push(t)}));const s=n.map((([t,o])=>{const n={...t},i=t.render?.opacity??1,s=o.render?.opacity??1;let l,c,u,p;n.render={...n.render,opacity:i+(s-i)*r};const g=(0,d.isCustomForce)(t.force)?a.GROUPED_FORCE_STRENGTH:a.RADIAL_STRENGTH,f=t.force?.strength,h=o.force?.strength??g;let y;if(f&&(y=f+(h-f)*r),t.force?.type&&"custom"!==t.force.type||o.force?.type&&"custom"!==o.force.type){if("radial"!==t.force?.type||"radial"!==o.force?.type)return n;l=t.force.boundary.inner,c=t.force.boundary.outer,u=o.force.boundary.inner,p=o.force.boundary.outer}else t.force?.center&&o.force?.center?(l=t.force.center.x,c=t.force.center.y,u=o.force.center.x,p=o.force.center.y):(l=u=e.state.svgWidth/2,c=p=e.state.svgHeight/2);const O=l+(u-l)*r,m=c+(p-c)*r;return n.force?.type&&"custom"!==n.force.type?"radial"===n.force.type&&(n.force={...n.force,boundary:{inner:O,outer:m}}):n.force={...n.force,type:"custom",strength:y,center:{x:O,y:m}},n}));let l=t.forceStrength?.charge??0;if(t.forceStrength?.charge&&o.forceStrength?.charge){const e=t.forceStrength.charge;l=e+(o.forceStrength.charge-e)*r}let c=t.forceStrength?.collide??0;if(t.forceStrength?.collide&&o.forceStrength?.collide){const e=t.forceStrength.collide;c=e+(o.forceStrength.collide-e)*r}const u=[];t.images&&o.images&&t.images.forEach((t=>{const e=o.images?.find((e=>e.image.id===t.image.id));e&&u.push([t,e])}));const p=u.map((([t,e])=>{const o={image:t.image,position:{x:t.image.position.x||t.image.initPosition.x,y:t.image.position.y||t.image.initPosition.y},size:{width:t.image.size.width||t.image.initSize.width,height:t.image.size.height||t.image.initSize.height}},n=t.position??t.image.initPosition,i=e.position??e.image.initPosition;o.position={x:n.x+(i.x-n.x)*r,y:n.y+(i.y-n.y)*r},o.image.position=o.position;const a=t.size??t.image.initSize,s=e.size??e.image.initSize;return o.size={width:a.width+(s.width-a.width)*r,height:a.height+(s.height-a.height)*r},o.image.size=o.size,o})),g=t.images?.filter((t=>!u.some((([e,o])=>e.image.id===t.image.id))))||[];return{...t,id:t.id+"_tweened_"+r,clumps:[...s,...i],dotRadius:t.dotRadius+(o.dotRadius-t.dotRadius)*r,forceStrength:{...t.forceStrength,charge:l,collide:c},images:[...p,...g]}},e.requestView=function t(o){if(e.state.view?.id===o.id)return;if(e.state.upcomingView=o,e.state.viewThrottle)return;(function(t){e.state.isTweening=!1;const o=e.state.view;o&&t!==o&&(0,n.cleanupVisualization)(o);if(e.state.lockedToAverageYears=t.requireAverageYears||!1,e.state.lockedToAverageYears&&"Average 2016-2022"!==e.state.currentYear)return void e.state.setYear("Average 2016-2022");if(!e.state.lockedToAverageYears){const o=new Set;t.clumps.forEach((t=>{t.ignoreYear||t.group.types.forEach((t=>{const e=Object.keys(a.VOTER_TYPES).find((e=>a.VOTER_TYPES[e].id===t.id));e&&o.add(e)}))}));let r=!0;for(const t of o)if(void 0===e.state.yearData[e.state.currentYear][t]){r=!1;break}if(!r)return void e.state.setYear("Average 2016-2022")}e.state.view=t,(0,s.updateDisplayData)(t),(0,n.renderView)(t),(0,r.simulateView)(t),e.state.activeDotTypes=new Set,t.clumps.forEach((t=>{t.group.types.forEach((t=>{e.state.seenDotTypes.add(t.id),e.state.activeDotTypes.add(t.id)})),"Above the tax threshold"!==t.group.id&&"Below the tax threshold"!==t.group.id||(e.state.seenDotTypes.add(t.group.id),e.state.activeDotTypes.add(t.group.id))})),"function"==typeof c.updateLegend&&(0,c.updateLegend)();t.onLoad&&t.onLoad();"function"==typeof window.updateYearSelectorUI&&setTimeout(window.updateYearSelectorUI,100)})(o),e.state.upcomingView=null,e.state.viewThrottle=!0,setTimeout((()=>{e.state.viewThrottle=!1,e.state.upcomingView&&t(e.state.upcomingView)}),600)};const r=o(517),n=o(114),i=o(613),a=o(921),s=o(646),l=o(610),c=o(391),d=o(566);e.state={importedData:[],displayData:[],flattenedData:[],isDistributed:!1,isSeparate:!1,isAutoRadius:!0,outlinesVisible:!1,view:null,dotRadius:2,superdots:[],images:[],svg:null,svgWidth:700,svgHeight:700,simulation:null,cursorNode:null,svgGroups:{},linkManager:null,freeSankeys:[],disableCursorPush:!1,isStopped:!1,upcomingView:null,viewThrottle:!1,isTweening:!1,seenDotTypes:new Set,activeDotTypes:new Set,legendVisible:!0,currentYear:"Average 2016-2022",availableYears:[],yearData:{},flowData:{},freeFlowData:{},lockedToAverageYears:!1,toggleGrouping(){this.isDistributed=!this.isDistributed},setDisplayData(t){this.displayData=t},setDotRadius(t){this.dotRadius=t},stopSimulation(){this.simulation&&(this.simulation.alphaTarget(0).stop(),this.isStopped=!0)},resumeSimulation(){this.simulation&&(this.simulation.alphaTarget(.1).restart(),this.isStopped=!1)},setYear(t){if(this.lockedToAverageYears&&"Average 2016-2022"!==t)return;if(!this.yearData[t])return;this.currentYear=t;const o=new Map;if(e.state.displayData.forEach((t=>{"number"==typeof t.x&&"number"==typeof t.y&&o.set(t.id,{x:t.x,y:t.y,vx:t.vx||0,vy:t.vy||0})})),Object.keys(a.VOTER_TYPES).forEach((e=>{void 0!==this.yearData[t][e]&&(a.VOTER_TYPES[e].dotCount=this.yearData[t][e])})),Object.keys(a.VOTER_GROUPS).forEach((t=>{a.VOTER_GROUPS[t].updateDotCount()})),e.state.flattenedData=(0,s.flattenData)(Object.values(a.VOTER_TYPES)),this.flowData[t]&&(0,l.updateFlowSankeys)(),this.view){const t={...this.view};(0,s.updateDisplayData)(t),e.state.displayData.forEach((t=>{const e=o.get(t.id);e&&(t.x=e.x,t.y=e.y,t.vx=e.vx,t.vy=e.vy)})),(0,n.renderView)(t,!0,!0),(0,r.simulateView)(t)}"function"==typeof window.updateYearSelectorUI&&window.updateYearSelectorUI(),"function"==typeof window.updateSvgAnnotationText&&window.updateSvgAnnotationText()},yearHasDataForActiveTypes(t){if(!this.view)return!1;const e=new Set,o=new Set;if(this.view.clumps.forEach((t=>{t.ignoreYear&&t.group.types.forEach((t=>{o.add(t.id)}))})),this.displayData.forEach((t=>{t.type.id===a.VOTER_TYPES.SUPERDOT.id||t.type.id===a.VOTER_TYPES.MOUSE.id||o.has(t.type.id)||e.add(t.type.id)})),0===e.size)return!0;for(const o of e){const e=Object.keys(a.VOTER_TYPES).find((t=>a.VOTER_TYPES[t].id===o));if(!e||void 0===this.yearData[t][e])return!1}return!0},getFlowPercentages(t,e,o){if(!this.flowData[t])return{};const r={},n=o?this.flowData[t][o]:e.reduce(((e,o)=>e+(this.flowData[t][o]||0)),0);return n<=0?{}:(e.forEach((e=>{void 0!==this.flowData[t][e]?r[e]=this.flowData[t][e]/n:r[e]=0})),r)},formatFlowAmount(t,e,o){if(!this.flowData[t]||void 0===this.flowData[t][e])return"$0";if(o){return`$${(this.flowData[t][e]/1e6).toFixed(1)} Million`}return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(this.flowData[t][e])},formatFreeFlowAmount(t,e,o,r){if(!e.dataKey)return"No data key";if(!this.freeFlowData[e.dataKey]||!this.freeFlowData[e.dataKey][t])return"Can't find data";const n=this.freeFlowData[e.dataKey],a=n[t];let s=0;if("credit"===o||"inflow"===o)s=a.inflow??0;else if("donation"===o||"outflow"===o)s=a.outflow??0;else if("count"===o)s=a.count??0;else{if("outOfPocket"!==o)return"Unknown flow type";s=(0,i.outOfPocketForYear)(n,t)}return r?(s/1e6).toFixed(1)+" Million":"count"===o?s.toLocaleString():new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(s)},formatPercentageOfFreeFlow(t,e,o,r){if(!e.dataKey||!o.dataKey)return"No data key";let n=0,a=0;if("donation"===r)n=this.freeFlowData[e.dataKey][t].outflow??0,a=this.freeFlowData[o.dataKey][t].outflow??0;else if("credit"===r)n=this.freeFlowData[e.dataKey][t].inflow??0,a=this.freeFlowData[o.dataKey][t].inflow??0;else if("outOfPocket"===r)n=(0,i.outOfPocketForYear)(this.freeFlowData[e.dataKey],t),a=(0,i.outOfPocketForYear)(this.freeFlowData[o.dataKey],t);else{if("count"!==r)return"Unknown flow type";n=this.freeFlowData[e.dataKey][t].count??0,a=this.freeFlowData[o.dataKey][t].count??0}return 0===n||0===a?"No data":(n/a*100).toFixed(0)+"%"}}},160:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isSuperdot=function(t){return(0,s.isDotData)(t)&&t.type===i.VOTER_TYPES.SUPERDOT},e.getSuperdotByGroup=function(t){return n.state.superdots.find((e=>e.viewClump.group.containsAllTypesFromGroup(t)))},e.createSuperdots=l,e.createSuperdot=c,e.superdotIDForClump=d,e.superdotIDForGroup=u,e.clearAllSuperdots=function(){n.state.svgGroups.dotsGroup?.selectAll("circle.superdot").transition("superdot-remove").duration(650).ease(r.easePolyInOut).attr("r",0).style("opacity",0).remove(),n.state.svgGroups.dotsGroup?.selectAll("circle.superdot").remove(),n.state.superdots=[]},e.renderSuperdotsFromClumps=function(t,e=!0){const o=[],r=[];t.forEach((t=>{if(t.render?.disable)return;const e=n.state.superdots.find((e=>e.id===d(t)));e?t.superdot&&(e.viewClump=t,r.push(e)):o.push(t)}));const i=l(o);p([...r,...i],e)},e.renderSuperdots=p,e.updateSuperdot=function(t,e,o){try{const r=d(o),i=n.state.svgGroups.dotsGroup?.select(`#${r}`);let a=0;n.state.displayData.forEach((r=>{if(r.activeClump===o){const o=(r.x||0)-t,i=(r.y||0)-e,s=Math.sqrt(o*o+i*i)+n.state.dotRadius;a=Math.max(a,s)}}));const s=Math.max(25,2*n.state.dotRadius);let l=0;n.state.displayData.forEach((t=>{t.activeClump===o&&l++}));let c=1.05;const u=Math.max(s,a*c),p=Math.sqrt(l)*n.state.dotRadius*1.5,g=1.8,f=n.state.superdots.find((t=>t.id===r)),h=g*p;let y;if(f)if(u<h)y=u;else{const t=.1;y=h+(u-h)*Math.exp(-t*(u-h))}else y=u;i&&!i.empty()&&(i.attr("cx",t).attr("cy",e).attr("r",y).attr("stroke-width",4).lower(),f&&(f.x=t,f.y=e,f.radius=y))}catch(t){}};const r=window.d3,n=o(569),i=o(921),a=o(114),s=o(566);function l(t){if(0===t.length)return[];const e=(0,a.calculateClumpGroupCenters)(t),o=[];return e.forEach((e=>{const r=t[e.groupIndex];r.render?.disable||o.push(c(e,r))})),o}function c(t,e){const o=n.state.superdots.find((t=>t.id===d(e)));if(o)return o.x=t.x,o.y=t.y,o;let s=0;const l=e,c=n.state.displayData.filter((t=>t.activeClump===l)),u=c.length;c.forEach((e=>{const o=(e.x||0)-t.x,r=(e.y||0)-t.y,i=Math.sqrt(o*o+r*r)+n.state.dotRadius;s=Math.max(s,i)}));const p=Math.max(25,2*n.state.dotRadius);let g=1.05;u>100&&(g=1.03),u>500&&(g=1.02);const f=Math.max(p,s*g);let h=1.8*Math.sqrt(u);u>1e3&&(h=2.2*Math.sqrt(u));const y=Math.max(f,h,p);let O,m="rgba(246, 246, 246, 0.95)";l.groupColorOverride&&l.groupColorOverride?.forEach((t=>{if(t.group.types.includes(i.VOTER_TYPES.SUPERDOT)){const e=r.color(t.color);e&&(m=e.toString(),O=m)}}));let S="#999",R=0,w=0,_=0,x=0;if(c.forEach((t=>{const e=r.color((0,a.getColorForDot)(t));if(e){const t=r.rgb(e);R+=t.r,w+=t.g,_+=t.b,x++}})),x>0){const t=Math.round(R/x),e=Math.round(w/x),o=Math.round(_/x),n=.5;S=r.rgb(Math.min(255,t*(1-n)+255*n),Math.min(255,e*(1-n)+255*n),Math.min(255,o*(1-n)+255*n)).toString()}const k={id:d(l),viewClump:l,x:t.x,y:t.y,type:i.VOTER_TYPES.SUPERDOT,radius:y,fillColor:m,strokeColor:S,sankeys:new Map};return n.state.superdots.push(k),k}function d(t){return u(t.group)}function u(t){return`superdot-${t.typeKey}`}function p(t,e=!0){if(!n.state.svgGroups.dotsGroup)return;n.state.svgGroups.dotsGroup.selectAll("circle.superdot").data();const o=n.state.svgGroups.dotsGroup.selectAll("circle.superdot").data(t,(t=>t.id)),i=o.enter().append("circle").attr("class","superdot").attr("id",(t=>t.id)).attr("cx",(t=>isNaN(t.x)?0:t.x)).attr("cy",(t=>isNaN(t.y)?0:t.y)).attr("r",(t=>isNaN(t.radius)?25:t.radius)).attr("fill",(t=>t.fillColor)).attr("stroke",(t=>{if(t.viewClump?.render&&1!=t.viewClump.render.opacity){return r.hsl(t.strokeColor||"#999").brighter(.4).formatRgb()}return t.strokeColor||"#999"})).attr("stroke-width",4).style("opacity",0).style("transform-box","fill-box").style("transform-origin","center").style("transform","scale(0.01)");e?i.transition("superdot-in").duration(800).ease(r.easeCubicInOut).style("transform","scale(1)").style("opacity",1):i.style("transform","scale(1)").style("opacity",(t=>1)),o.attr("cx",(t=>isNaN(t.x)?0:t.x)).attr("cy",(t=>isNaN(t.y)?0:t.y)).attr("r",(t=>isNaN(t.radius)?25:t.radius)).attr("fill",(t=>t.fillColor)).attr("stroke",(t=>{if(t.viewClump?.render&&1!=t.viewClump.render.opacity){return r.hsl(t.strokeColor||"#999").brighter(.4).formatRgb()}return t.strokeColor||"#999"})).lower(),e?o.transition("superdot-update").duration(800).ease(r.easeCubicInOut).style("transform","scale(1)").style("opacity",(t=>1)):o.style("transform","scale(1)").style("opacity",(t=>1));o.exit().transition("superdot-out").duration(400).ease(r.easeCubicInOut).style("transform","scale(0)").style("opacity",0).on("end",(function(){const t=r.select(this).attr("id");n.state.superdots.find((e=>e.id===t))||r.select(this).remove()})).each((function(t){const e=n.state.superdots.findIndex((e=>e.id===t.id));-1!==e&&n.state.superdots.splice(e,1)}))}},297:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setTextForView=function(t){if(!n.state.svgGroups.frontAnnotationsGroup)return;const e=[],o=[],a=p();t.sankeyGroups?.length&&t.sankeyGroups.some((t=>t.textAnnotations?.length))&&t.sankeyGroups.forEach((t=>{const r=t.textAnnotations||[];if(r.length>0){const n=t.sankey;r.forEach((t=>{const r=a?.filter((e=>e.id===t.id));if(r&&r.size()>0)return void o.push(r);const i="function"==typeof t.text?t.text():t.text||n.id,s=g({target:n,text:t.text||i,id:t.id||`text-${n.id}-${i.replace(/\s/g,"-")}`,targetAnchorLink:t.targetAnchorLink||"junction",textAnchor:t.textAnchor||"end",targetOffset:t.targetOffset||{x:0,y:0},classes:["sankey-label"],color:t.color||"green"});s&&e.push(s)}))}}));t.clumps.length&&t.clumps.some((t=>t.textAnnotations?.length))&&t.clumps.forEach((t=>{const r=t.textAnnotations||[];r.length>0&&r.forEach((r=>{const s=r.text||t.group.name;if(t.superdot){const c=n.state.superdots.find((e=>(0,i.sameTypesInClumps)(t,e.viewClump)));if(!c)return;const d=a?.filter((t=>t.id===r.id));if(d&&d.size()>0)return void o.push(d);const u="function"==typeof s?s():s,p=g({target:c,text:s,id:r.id||`text-${t.group.name}-${u.replace(/\s/g,"-")}`,targetAnchorX:r.targetAnchorX||"middle",targetAnchorY:r.targetAnchorY||"middle",textAnchor:r.textAnchor||"middle",targetOffset:r.targetOffset||{x:0,y:0},classes:["superdot-label"],color:r.color||l.typeColors.purple});p&&e.push(p)}else{const n=a?.filter((t=>t.id===r.id));if(n&&n.size()>0)return void o.push(n);const i="function"==typeof s?s():s,c=g({target:t.group,text:s,id:r.id||`text-${t.group.name}-${i.replace(/\s/g,"-")}`,targetAnchorX:r.targetAnchorX||"middle",targetAnchorY:r.targetAnchorY||"middle",textAnchor:r.textAnchor||"middle",targetOffset:r.targetOffset||{x:0,y:0},classes:["clump-label"],color:r.color||l.typeColors.purple});c&&e.push(c)}}))}));t.textAnnotations?.length&&t.textAnnotations.forEach((t=>{const r=a?.filter((e=>e.id===t.id));if(r&&r.size()>0)return void o.push(r);const n=g(t);n&&e.push(n)}));h();const s=o.map((t=>t.datum().id));a?.filter((t=>!s.includes(t.id))).transition("text-out").duration(500).style("opacity",0).on("end",(function(){r.select(this).remove()}))},e.addText=g,e.updateTextPositions=h;const r=window.d3,n=o(569),i=o(566),a=o(3),s=o(613),l=o(921),c=o(636),d=o(160),u=o(114);function p(){return n.state.svgGroups.frontAnnotationsGroup?n.state.svgGroups.frontAnnotationsGroup.selectAll("text"):null}function g(t){if(!n.state.svgGroups.frontAnnotationsGroup)return null;const e=f(t),o="function"==typeof t.text?t.text():t.text,r="string"==typeof o?o.replace(/\s/g,"-"):"dynamic-text";t.id=t.id||`text-${r}`;const i=n.state.svgGroups.frontAnnotationsGroup.append("text").attr("id",t.id).attr("class",t.classes?.join(" ")||"").datum(t).attr("x",e.x).attr("y",e.y).text(o).attr("text-anchor",t.textAnchor||"middle").style("font-size",t.size||"").style("fill",t.color||"").style("font-family",t.font||"").style("opacity",0);return i.transition(`text-in-${t.id}`).duration(500).style("opacity",1),i}function f(t){let e={x:0,y:0},o={left:0,right:0,top:0,bottom:0},r={start:{x:0,y:0},end:{x:0,y:0}},l={x:0,y:0};if((0,i.isDotData)(t.target)&&!(0,d.isSuperdot)(t.target))e={x:t.target.x||0,y:t.target.y||0},o={left:e.x-n.state.dotRadius,right:e.x+n.state.dotRadius,top:e.y-n.state.dotRadius,bottom:e.y+n.state.dotRadius};else if((0,d.isSuperdot)(t.target))e={x:t.target.x||0,y:t.target.y||0},o={left:e.x-t.target.radius,right:e.x+t.target.radius,top:e.y-t.target.radius,bottom:e.y+t.target.radius};else if(t.target instanceof c.SimImage){const r=t.target.position;e={x:r.x,y:r.y},o={left:e.x-t.target.size.width/2,right:e.x+t.target.size.width/2,top:e.y-t.target.size.height/2,bottom:e.y+t.target.size.height/2}}else t.target instanceof a.Sankey?(e=t.target.getJunctionCenter(),r=t.target.getEndpointPositions()):t.target instanceof s.VoterGroup?e=(0,u.calculateGroupCenters)([t.target]).get(t.target):(e=t.target,o={left:e.x,right:e.x,top:e.y,bottom:e.y});return t.target instanceof a.Sankey?l="start"===t.targetAnchorLink?r.start:"end"===t.targetAnchorLink?r.end:e:("left"===t.targetAnchorX?l.x=o.left:"right"===t.targetAnchorX?l.x=o.right:l.x=e.x,"top"===t.targetAnchorY?l.y=o.top:"bottom"===t.targetAnchorY?l.y=o.bottom:l.y=e.y),{x:l.x+(t.targetOffset?.x||0),y:l.y+(t.targetOffset?.y||0)}}function h(){const t=p();if(t){const e=new Map;t?.each((t=>{if(e.set(t.id,f(t)),"function"==typeof t.text){const e=t.text(),o=r.select(`#${t.id}`);o.empty()||o.text(e)}})),t.attr("x",(t=>e.get(t.id).x)).attr("y",(t=>e.get(t.id).y))}}},613:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VoterGroup=e.VoterType=void 0,e.sumFlowData=n,e.flowDataForSingleDot=function(t){const e=Object.keys(t),o={};return e.forEach((e=>{o[e]={inflow:(t[e].inflow??0)/(t[e].count??1),outflow:(t[e].outflow??0)/(t[e].count??1),count:1}})),o},e.isFlowType=function(t){return"inflow"===t||"outflow"===t||"count"===t},e.outOfPocketForYear=function(t,e){return(t[e].outflow??0)-(t[e].inflow??0)};window.d3;const r=o(569);function n(t){if(0===t.length)return{};if(1===t.length)return t[0];const e={};return t.forEach((t=>{Object.keys(t).forEach((o=>{e[o]??={},e[o]={inflow:(e[o].inflow??0)+(t[o].inflow??0),outflow:(e[o].outflow??0)+(t[o].outflow??0),count:(e[o].count??0)+(t[o].count??0)}}))})),e}e.VoterType=class{id;name;color;dotCount;constructor(t,e,o){this.id=t,this.name=e,this.color=o,this.dotCount=0}belongsInClump(t){return t.group.containsType(this)&&!t.render?.disable}belongsInView(t){return t.clumps.some((t=>this.belongsInClump(t)))}matchedClumpInView(t){return t.clumps.find((t=>this.belongsInClump(t)))}belongsInGroups(t){return t.some((t=>t.containsType(this)))}};class i{types;id;typeKey;dataKey;name;dotCount;flowData;dotFlowData;constructor(t,e,o){this.types=t,this.id=e,this.name=o,this.dotCount=this.getDotCount();const r=this.types.slice().sort(((t,e)=>t.id.localeCompare(e.id)));this.typeKey=r.map((t=>t.id.replace(/[^a-zA-Z0-9]/g,"-"))).join("-")}updateDotCount(){this.dotCount=this.getDotCount()}getDotCount(){return this.types.reduce(((t,e)=>t+e.dotCount),0)}containsType(t){return this.types.includes(t)}shouldIncludeDot(t){return this.types.includes(t.type)}belongsInView(t){return t.clumps.some((t=>this.belongsInClump(t)))}belongsInClump(t){return this.types.some((e=>t.group.containsType(e)))}indexInClump(t){return t.group.types.findIndex((e=>t.group.containsType(e)))}sameTypesAs(t){return this.types.length===t.types.length&&this.types.every((e=>t.containsType(e)))}containsAllTypesFromGroup(t){return t.types.every((t=>this.containsType(t)))}activeDots(){return r.state.displayData.filter((t=>this.shouldIncludeDot(t)))}static fromType(t){return new i([t],t.id,t.name)}static fromTypes(t,e,o){return new i(t,e??t.map((t=>t.id)).join("-"),o??t.map((t=>t.name)).join(" + "))}static fromGroups(t,e,o){const r=new i(t.flatMap((t=>t.types)),e??t.map((t=>t.id)).join("-"),o??t.map((t=>t.name)).join(" + "));return r.flowData=n(t.map((t=>t.flowData??{}))),r.dotFlowData=n(t.map((t=>t.dotFlowData??{}))),r}static activeDots(t){const e=[];return t.forEach((t=>e.push(...t.activeDots()))),e}}e.VoterGroup=i},566:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.gradientConfigs=void 0,e.fadeHexColor=function(t,e){const o=r.rgb(t);return o.opacity=e,o.toString()},e.forceType=s,e.isCustomForce=function(t){return"custom"===s(t)},e.isRadialForce=function(t){return"radial"===s(t)},e.isDotData=function(t){return t&&t.id&&t.type&&t.type instanceof n.VoterType},e.freeSankeyLinksForDot=function(t){const e=i.state.view;if(!e)return[];const o=e.freeSankeyGroups;if(!o)return[];const r=o.flatMap((t=>t.freeSankey)).flatMap((e=>{const o=e.linkForDot(t);return o?[o]:[]}));return r},e.freeSankeysForTarget=function(t){const e=i.state.view;if(!e)return[];const o=e.freeSankeyGroups;if(!o)return[];const r=t instanceof a.SimImage,n=o.flatMap((t=>t.freeSankey)).filter((e=>{const o=e.getTarget(),n=o instanceof a.SimImage;return!(n&&!r||!n&&r)&&(r&&n?t===o:!r&&!n&&(t.x===o.x&&t.y===o.y))}));return n},e.interpolateColor=l,e.calculateGradientColor=function(t,e){const o=e.center||{x:i.state.svgWidth/2,y:i.state.svgHeight/2},r=void 0!==t.x?t.x:o.x,n=void 0!==t.y?t.y:o.y,a=Math.sqrt(Math.pow(r-o.x,2)+Math.pow(n-o.y,2)),s=e.maxDistance||350,c=void 0!==e.threshold?e.threshold:1,d=e.power||1;let u=Math.min(a/s,1);if(u>c)return e.outerColor;1!==d&&(u=Math.pow(u,d));return l(e.innerColor,e.outerColor,u)},e.sameTypesInClumps=function(t,e){return t.group.sameTypesAs(e.group)},e.getDotInfo=function(t){const e=document.querySelector("svg"),[o,n]=r.pointer(t,e),a=r.select(e).selectAll("circle").filter((function(){const t=parseFloat(this.getAttribute("cx")||"0"),e=parseFloat(this.getAttribute("cy")||"0"),r=parseFloat(this.getAttribute("r")||"0");return Math.sqrt((o-t)**2+(n-e)**2)<=r})).node();if(a){const t=r.select(a).datum();let e;return e=-1!==t.id.indexOf("superdot")?t.fillColor:t.type.color,r.select(a).attr("fill","red"),setTimeout((()=>{r.select(a).attr("fill",e)}),1e3),`ID: ${t.id}<br />\n                Type: ${t.type.name}<br />\n                Clump: ${t.type.matchedClumpInView(i.state.view)?.group.name}<br />\n                Sankeys: ${t.sankeys.size}<br />`}return"No circle found"};const r=window.d3,n=o(613),i=o(569),a=o(636);function s(t){return t?void 0===t.type||"custom"===t.type?"custom":t.type:null}function l(t,e,o){const r=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16),a=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),l=parseInt(e.slice(5,7),16),c=Math.round(r+(a-r)*o),d=Math.round(n+(s-n)*o),u=Math.round(i+(l-i)*o);return`#${c.toString(16).padStart(2,"0")}${d.toString(16).padStart(2,"0")}${u.toString(16).padStart(2,"0")}`}e.gradientConfigs=[{viewId:"bringBackPVS4",groupIds:["Remaining Non-donating voters","Below the tax threshold","Non-donating voters needed for new funding goals"],innerColor:"#833B8D",outerColor:"#833B8D",maxDistance:350,threshold:1,power:1},{viewId:"bringBackPVS4",groupIds:["Eligible non-voters"],innerColor:"#833B8D",outerColor:"#CCCCCC",maxDistance:1350,threshold:1,power:1},{viewId:"finalFootnote",groupIds:["Remaining Non-donating voters","Below the tax threshold","Non-donating voters needed for new funding goals"],innerColor:"#833B8D",outerColor:"#833B8D",maxDistance:350,threshold:1,power:1},{viewId:"finalFootnote",groupIds:["Eligible non-voters"],innerColor:"#833B8D",outerColor:"#CCCCCC",maxDistance:1e3,threshold:1,power:1}]},263:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.viewPresets=void 0,e.initializeViews=function(){(0,n.initSetupViews)(e.viewPresets),(0,r.initProblemViews)(e.viewPresets),(0,i.initSolutionViews)(e.viewPresets)};const r=o(777),n=o(39),i=o(657);e.viewPresets={}},777:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initProblemViews=function(t){t.exclusiveClub={id:"exclusiveClub",description:"The exclusive club of big donors",dotRadius:20,forceStrength:{charge:-18},tween:!0,images:[{image:i.viewImages.partyIcon,position:{x:(0,n.getCenter)().x,y:(0,n.getCenter)().y+10},size:{width:170,height:170}}],clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:(0,n.getCenter)().x,y:(0,n.getCenter)().y-120}}},{group:r.VOTER_GROUPS.DONORS_1_999,render:{opacity:.3},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}],force:{type:"radial",boundary:{inner:250,outer:300}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:2e3}},render:{opacity:.1},ignoreYear:!0}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,n.getCenter)().y-10},fixedPosition:{x:120,y:(0,n.getCenter)().y-60},note:{title:"The Inner Circle",label:"Parties host private events for these elite donors",wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:50,includeElements:[r.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation hidden-callout-annotation"}]},t.outsideLookingIn={id:"outsideLookingIn",description:"Leaving the rest of us outside looking in",dotRadius:3,forceStrength:{charge:-3},tween:!0,images:[{image:i.viewImages.partyIcon,position:{x:(0,n.getCenter)().x,y:(0,n.getCenter)().y},size:{width:70,height:70}}],clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000,force:{type:"radial",boundary:{inner:50,outer:50}}},{group:r.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:80,outer:90}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:100,outer:260}}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:110,outer:260}}}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,n.getCenter)().y},fixedPosition:{x:120,y:(0,n.getCenter)().y-60},note:{},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10,includeElements:[r.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation hidden-callout-annotation"}]},t.benefitsTheAlreadyWealthySetup={id:"benefitsTheAlreadyWealthySetup",description:"For those with enough money to buy in...",dotRadius:7,forceStrength:{charge:-7},images:[{image:i.viewImages.partyIcon,position:{x:350,y:(0,n.getCenter)().y+40},size:{width:70,height:70}},{image:i.viewImages.parliamentIcon,position:{x:350,y:(0,n.getCenter)().y-140},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:(0,n.getCenter)().x,y:(0,n.getCenter)().y-20}}},{group:r.VOTER_GROUPS.DONORS_1_999,render:{opacity:1},force:{type:"radial",boundary:{inner:220,outer:230}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.4},force:{type:"radial",boundary:{inner:300,outer:700}}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:0,disable:!0},force:{type:"radial",boundary:{inner:700,outer:1e3}}}]},t.howTaxCreditWorks={id:"howTaxCreditWorks",description:"how tax credits work",dotRadius:7,tween:!0,forceStrength:{},images:[{image:i.viewImages.partyIcon,position:{x:400,y:570}},{image:i.viewImages.parliamentIcon}],freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.donorsToPartyFree,svgAnnotations:[{id:"donations-annotation",type:"callout",target:a.viewFreeSankeys.donorsToPartyFree,targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_1_999,targetFlowRatio:.7,fixedPosition:{x:(0,n.getCenter)().x-180,y:(0,n.getCenter)().y+130},note:{title:"Donations",label:"Donations made to parties by individual donors",wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation"}]}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,superdot:!0,force:{center:{x:250,y:350}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:450,y:350}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:500,outer:1500}},ignoreYear:!0}],textAnnotations:[{id:"total-donation-amount",target:{x:(0,n.getCenter)().x+40,y:(0,n.getCenter)().y+120},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,n.getCenter)().x+40,y:(0,n.getCenter)().y+150},text:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}]},t.howTaxCreditWorksPart2={id:"howTaxCreditWorksPart2",description:"Part 2 of the tax credit flow visualization",dotRadius:7,tween:!0,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.donorsToPartyFree,svgAnnotations:[{id:"donations-annotation",type:"callout",target:a.viewFreeSankeys.donorsToPartyFree,targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_1_999,targetFlowRatio:.7,fixedPosition:{x:(0,n.getCenter)().x-180,y:(0,n.getCenter)().y+130},note:{title:"Donations",label:"Donations made to parties by individual donors",wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree,svgAnnotations:[{id:"tax-credit-annotation",type:"callout",target:a.viewFreeSankeys.parliamentToDonorsFree,targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.5,fixedPosition:{x:(0,n.getCenter)().x+160,y:(0,n.getCenter)().y-100},note:{title:"Tax credits",label:"Public money given back to donors through the Federal Political Contributions Tax Credit",wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"blue-flow-annotation"}]}],images:[{image:i.viewImages.partyIcon,position:{x:400,y:570}},{image:i.viewImages.parliamentIcon}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,superdot:!0,force:{center:{x:250,y:350}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:450,y:350}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:500,outer:1500}},ignoreYear:!0}],textAnnotations:[{id:"total-donation-amount",target:{x:(0,n.getCenter)().x+40,y:(0,n.getCenter)().y+120},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,n.getCenter)().x+40,y:(0,n.getCenter)().y+150},text:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-credit-amount",target:{x:(0,n.getCenter)().x-120,y:(0,n.getCenter)().y-120},text:"Total Tax Credits:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["credit-label"]},{id:"total-credit-amount-2",target:{x:(0,n.getCenter)().x-120,y:(0,n.getCenter)().y-90},text:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"inflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["credit-label"]}]},t.howTaxCreditWorksOutOfPocket={id:"howTaxCreditWorksOutOfPocket",description:"View for the current donor flow visualization showing out-of-pocket portion",dotRadius:7,tween:!1,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.donorsToPartyOOPFree,svgAnnotations:[{id:"out-of-pocket-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_1_999,targetFlowRatio:.25,fixedPosition:{x:100,y:470},note:{title:()=>`Out-of-Pocket: $${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"outOfPocket",!0)}`,label:"You had to spend some of your own money, even after the tax credit",wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation dynamic-text-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartySubsidizedFree},{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree}],images:[{image:i.viewImages.partyIcon,position:{x:400,y:570},svgAnnotations:[]},{image:i.viewImages.parliamentIcon}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,superdot:!0,force:{center:{x:250,y:350}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}],svgAnnotations:[]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:450,y:350}},svgAnnotations:[]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:500,outer:1500}},ignoreYear:!0}],textAnnotations:[{id:"total-credit-amount",target:{x:(0,n.getCenter)().x-120,y:(0,n.getCenter)().y-120},text:"Total Tax Credits:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["credit-label"]},{id:"total-credit-amount-2",target:{x:(0,n.getCenter)().x-120,y:(0,n.getCenter)().y-90},text:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"inflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["credit-label"]}]},t.howTaxCreditWorksOutOfPocket2={id:"howTaxCreditWorksOutOfPocket2",description:"View for the current donor flow visualization showing out-of-pocket portion 2",dotRadius:7,tween:!1,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.donorsToPartyOOPFree,svgAnnotations:[{id:"out-of-pocket-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_1_999,targetFlowRatio:.25,fixedPosition:{x:100,y:470},note:{title:()=>`Out-of-Pocket: $${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"outOfPocket",!0)}`,label:"You had to spend some of your own money, even after the tax credit",wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation dynamic-text-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartySubsidizedFree,svgAnnotations:[{id:"subsidized-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.25,fixedPosition:{x:600,y:500},note:{title:()=>`Subsidized Amount: $${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.ALL_DONORS,"inflow",!0)}`,label:"But the tax credit still covers a lot of your donation",wrap:210,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"blue-flow-annotation dynamic-text-annotation"}]},{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree}],images:[{image:i.viewImages.partyIcon,position:{x:400,y:570},svgAnnotations:[]},{image:i.viewImages.parliamentIcon}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,superdot:!0,force:{center:{x:250,y:350}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}],svgAnnotations:[]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:450,y:350}},svgAnnotations:[]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:500,outer:1500}},ignoreYear:!0}]},t.bigDonorsGetNearlyHalfOfCredits={id:"bigDonorsGetNearlyHalfOfCredits",description:"Big donors get nearly half of the tax credits",dotRadius:7,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree,svgAnnotations:[{id:"nearly-half-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,n.getCenter)().x+50,y:(0,n.getCenter)().y-150},note:{title:()=>`${s.state.formatPercentageOfFreeFlow(s.state.currentYear,r.VOTER_GROUPS.DONORS_OVER_1000,r.VOTER_GROUPS.ALL_DONORS,"credit")} of Public Money`,label:()=>"About a third of the tax credits go back to the superdonors",wrap:240,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"nearly-half-flow-annotation blue-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartyOOPFree,svgAnnotations:[{id:"nearly-half-oop-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.7,fixedPosition:{x:(0,n.getCenter)().x+30,y:(0,n.getCenter)().y+30},note:{title:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.DONORS_OVER_1000,"outOfPocket",!0)}`,label:()=>`So despite their large donations, they pay a relatively small portion of their own money (${s.state.formatPercentageOfFreeFlow(s.state.currentYear,r.VOTER_GROUPS.DONORS_OVER_1000,r.VOTER_GROUPS.ALL_DONORS,"outOfPocket")} of their donation)`,wrap:240,bgPadding:10,align:"left"},connector:{end:"arrow",type:"line"},className:"nearly-half-subsidized-annotation green-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartySubsidizedFree,svgAnnotations:[{id:"nearly-half-subsidized-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,n.getCenter)().x+100,y:(0,n.getCenter)().y+140},note:{title:()=>`$${s.state.formatFreeFlowAmount(s.state.currentYear,r.VOTER_GROUPS.DONORS_OVER_1000,"inflow",!0)}`,label:"And the rest is covered by the taxpayer — subsidizing not only their donation, but also the access it buys them",wrap:210,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"nearly-half-flow-annotation blue-flow-annotation"}]}],images:[{image:i.viewImages.partyIcon,position:{x:250,y:550}},{image:i.viewImages.parliamentIcon,position:{x:150,y:100}}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,render:{opacity:.5},superdot:!0,force:{center:{x:150,y:350}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:250,y:350}},superdot:!0},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:500,outer:1500}},ignoreYear:!0}]}};const r=o(921),n=o(635),i=o(850),a=o(20),s=o(569)},39:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initSetupViews=function(t){t.everyoneCloud={id:"everyoneCloud",description:"Everyone in a single big cloud",dotRadius:3,forceStrength:{charge:-1.5,collide:3},tween:!0,clumps:[{group:n.VOTER_GROUPS.ALL_ELIGIBLE,force:{center:(0,i.getCenter)()}}],svgAnnotations:[{id:"voters-annotation",type:"calloutCircle",fixedPosition:{x:150,y:(0,i.getCenter)().y-180},target:{x:0,y:0},note:{title:()=>`All ${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_ELIGIBLE,"count",!0)} eligible Canadian voters`,wrap:250,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation hidden-line-annotation"}]},t.govtIsPayingThemToDoSo={id:"govtIsPayingThemToDoSo",description:"And the government is paying them to do so",dotRadius:1,tween:!0,forceStrength:{charge:-.2},images:[{image:a.viewImages.partyIcon,position:{x:650,y:(0,i.getCenter)().y+130}},{image:a.viewImages.parliamentIcon,position:{x:60,y:(0,i.getCenter)().y+0}}],clumps:[{group:n.VOTER_GROUPS.ALL_ELIGIBLE,superdot:!0,textAnnotations:[{text:"Eligible Voters",targetAnchorY:"top",targetOffset:{x:0,y:-20}}],force:{center:{x:350,y:(0,i.getCenter)().y}}}],svgAnnotations:[{id:"tax-credit-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:85,y:(0,i.getCenter)().y-18},note:{title:()=>`${c.state.formatFlowAmount(c.state.currentYear,"Total tax credit",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation blue-text dynamic-text-annotation"},{id:"donation-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:485,y:(0,i.getCenter)().y+18},note:{title:()=>`${c.state.formatFlowAmount(c.state.currentYear,"Total donated to all parties",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation green-text dynamic-text-annotation"}],textAnnotations:[{text:"Political Parties",target:a.viewImages.partyIcon,targetOffset:{x:0,y:40},targetAnchorY:"bottom",classes:["parties-label"]}]},t.allThatMoney={id:"allThatMoney",description:"Where is all that money going?",dotRadius:2,tween:!0,forceStrength:{charge:-1},images:[{image:a.viewImages.parliamentIcon,position:{x:60,y:(0,i.getCenter)().y+0}}],clumps:[{group:n.VOTER_GROUPS.ALL_ELIGIBLE,superdot:!0,textAnnotations:[],force:{center:{x:500,y:(0,i.getCenter)().y}}}],svgAnnotations:[{id:"tax-credit-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:85,y:(0,i.getCenter)().y-18},note:{title:()=>`${c.state.formatFlowAmount(c.state.currentYear,"Total tax credit",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation blue-text dynamic-text-annotation"}]},t.everyoneRadial={id:"everyoneRadial",description:"Everyone mixed in a single big radial",dotRadius:2,tween:!0,forceStrength:{charge:-3,collide:3},clumps:[{group:n.VOTER_GROUPS.ALL_ELIGIBLE,force:{type:"radial",boundary:{inner:0,outer:1500}}}]},t.allVotersCloud={id:"allVotersCloud",description:"All Voters in a single cloud, with non-voters orbiting paler",dotRadius:3,forceStrength:{charge:-1.5,collide:3},clumps:[{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:140,outer:240}},render:{opacity:.9}},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,superdot:!0,svgAnnotations:[{id:"voters-annotation",type:"calloutCircle",fixedPosition:{x:80,y:(0,i.getCenter)().y-180},note:{title:()=>`All ${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_VOTERS,"count",!0)} Canadian voters`,wrap:170,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation purple-annotation"}]}]},t.onlyVotersBullseye={id:"onlyVotersBullseye",description:"Only a fraction donate",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:n.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS,color:n.typeColors.greal}],svgAnnotations:[{id:"all-donors-annotation",type:"calloutCircle",fixedPosition:{x:180,y:(0,i.getCenter)().y-180},note:{title:()=>`All ${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"count")} Donors to Major Federal Parties`,wrap:250,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},subject:{radiusPadding:0},className:"hidden-circle-annotation donors-annotation"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:40,outer:150}},ignoreYear:!0,render:{opacity:.5}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:160,outer:260}},ignoreYear:!0,render:{opacity:.5}}]},t.highlightGolds={id:"highlightGolds",description:"and only a few of them can afford to donate big",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{},svgAnnotations:[{id:"gold-donors-1-annotation",type:"calloutCircle",fixedPosition:{x:220,y:(0,i.getCenter)().y-120},note:{title:"Gold Donors",label:"These are the superdonors who give over $1000",wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation gold-annotation"}]},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:30,outer:50}}},{group:n.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},render:{disable:!0},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS,color:"#63C1CD"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,ignoreYear:!0,force:{type:"radial",boundary:{inner:60,outer:160}},render:{opacity:.3}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:170,outer:300}},ignoreYear:!0,render:{opacity:.3}}]},t.highlightGoldsBigger={id:"highlightGoldsBigger",description:"and only a few of them can afford to donate big",dotRadius:12,tween:!0,forceStrength:{charge:-12},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{},svgAnnotations:[{id:"gold-donors-1-annotation",type:"calloutCircle",fixedPosition:{x:220,y:(0,i.getCenter)().y-120},note:{title:"Gold Donors",label:"These are the superdonors who give over $1000",wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation gold-annotation"}]},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:60,outer:100}}},{group:n.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},render:{disable:!0},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS,color:"#63C1CD"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,ignoreYear:!0,force:{type:"radial",boundary:{inner:150,outer:1e3}},render:{opacity:.2}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:5e3}},ignoreYear:!0,render:{disable:!0,opacity:0}}]},t.goldProportionOfDonations1={id:"goldProportionOfDonations1",description:"These superdonors are responsible for nearly half of donations to parties",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:n.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-150}},textAnnotations:[{text:"All Donors",color:n.typeColors.blue,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartyFree,svgAnnotations:[{id:"all-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.5,fixedPosition:{x:(0,i.getCenter)().x-200,y:(0,i.getCenter)().y-50},note:{title:"Donations",label:"The thickness of this line corresponds to the amount donated",wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}],svgAnnotations:[{id:"party-icon-annotation",type:"callout",target:a.viewImages.partyIcon,targetOffset:{x:-45,y:-0},fixedPosition:{x:(0,i.getCenter)().x-140,y:(0,i.getCenter)().y+120},note:{title:"All Major Federal Political Parties",label:"This icon represents the parties receiving donations from individual donors",wrap:200,bgPadding:10,align:"right"},connector:{end:"arrow",type:"elbow"}}]},t.goldProportionOfDonations2={id:"goldProportionOfDonations2",description:"These superdonors are responsible for nearly half of donations to parties",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:n.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,i.getCenter)().x-220,y:(0,i.getCenter)().y-120}},textAnnotations:[{text:"$1-199",color:n.typeColors.blue,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:r.VoterGroup.fromGroups([n.VOTER_GROUPS.DONORS_200_499,n.VOTER_GROUPS.DONORS_500_999,n.VOTER_GROUPS.DONORS_OVER_1000]),render:{opacity:.4},superdot:!0,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-150}},textAnnotations:[{text:"$200+",color:(0,l.fadeHexColor)(n.typeColors.teal,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartySplit1Free,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_1_199,color:n.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_1_199,targetFlowRatio:.7,fixedPosition:{x:(0,i.getCenter)().x-200,y:(0,i.getCenter)().y+50},note:{title:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_1_199,"outflow",!0)}`,label:()=>`${c.state.formatPercentageOfFreeFlow(c.state.currentYear,n.VOTER_GROUPS.DONORS_1_199,n.VOTER_GROUPS.ALL_DONORS,"donation")} of all donations`,wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[{text:"Individual Donation Amount:",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-230},targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}],svgAnnotations:[]},t.goldProportionOfDonations3={id:"goldProportionOfDonations3",description:"These superdonors are responsible for nearly half of donations to parties",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:n.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,i.getCenter)().x-220,y:(0,i.getCenter)().y-120}},render:{opacity:.4},textAnnotations:[{text:"$1-199",color:(0,l.fadeHexColor)(n.typeColors.blue,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,i.getCenter)().x-100,y:(0,i.getCenter)().y-100}},textAnnotations:[{text:"$200-499",color:n.typeColors.teal,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:r.VoterGroup.fromGroups([n.VOTER_GROUPS.DONORS_500_999,n.VOTER_GROUPS.DONORS_OVER_1000]),render:{opacity:.4},superdot:!0,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-150}},textAnnotations:[{text:"$500+",color:(0,l.fadeHexColor)(n.typeColors.cyan,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartySplit2Free,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_200_499,color:n.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation-2",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_200_499,targetFlowRatio:.7,fixedPosition:{x:(0,i.getCenter)().x-200,y:(0,i.getCenter)().y+0},note:{title:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_200_499,"outflow",!0)}`,label:()=>`${c.state.formatPercentageOfFreeFlow(c.state.currentYear,n.VOTER_GROUPS.DONORS_200_499,n.VOTER_GROUPS.ALL_DONORS,"donation")} of all donations`,wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[{text:"Individual Donation Amount:",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-230},targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}],svgAnnotations:[]},t.goldProportionOfDonations4={id:"goldProportionOfDonations4",description:"These superdonors are responsible for nearly half of donations to parties",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:n.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,i.getCenter)().x-220,y:(0,i.getCenter)().y-120}},render:{opacity:.4},textAnnotations:[{text:"$1-199",color:(0,l.fadeHexColor)(n.typeColors.blue,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,i.getCenter)().x-100,y:(0,i.getCenter)().y-100}},render:{opacity:.4},textAnnotations:[{text:"$200-499",color:(0,l.fadeHexColor)(n.typeColors.teal,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_500_999,superdot:!0,force:{center:{x:(0,i.getCenter)().x+10,y:(0,i.getCenter)().y-130}},textAnnotations:[{text:"$500-999",color:n.typeColors.cyan,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,i.getCenter)().x+120,y:(0,i.getCenter)().y-100}},render:{opacity:.4},textAnnotations:[{text:"$1000+",color:(0,l.fadeHexColor)(n.typeColors.gold,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorGroupsToPartyFree,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_500_999,color:n.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation-3",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_500_999,targetFlowRatio:.7,fixedPosition:{x:(0,i.getCenter)().x-210,y:(0,i.getCenter)().y-10},note:{title:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_500_999,"outflow",!0)}`,label:()=>`${c.state.formatPercentageOfFreeFlow(c.state.currentYear,n.VOTER_GROUPS.DONORS_500_999,n.VOTER_GROUPS.ALL_DONORS,"donation")} of all donations`,wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[{text:"Individual Donation Amount:",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-230},targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}],svgAnnotations:[]},t.goldProportionOfDonations={id:"goldProportionOfDonations",description:"These superdonors are responsible for nearly half of donations to parties",dotRadius:8,tween:!0,forceStrength:{charge:-8},clumps:[{group:n.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,i.getCenter)().x-220,y:(0,i.getCenter)().y-120}},textAnnotations:[{text:"$1-199",color:n.typeColors.blue,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,i.getCenter)().x-100,y:(0,i.getCenter)().y-100}},textAnnotations:[{text:"$200-499",color:n.typeColors.teal,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_500_999,superdot:!0,force:{center:{x:(0,i.getCenter)().x+10,y:(0,i.getCenter)().y-130}},textAnnotations:[{text:"$500-999",color:n.typeColors.cyan,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,i.getCenter)().x+120,y:(0,i.getCenter)().y-100}},textAnnotations:[{text:"$1000+",color:n.typeColors.gold,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}],svgAnnotations:[{id:"gold-donors-circle-annotation",type:"calloutCircle",fixedPosition:{x:(0,i.getCenter)().x+290,y:(0,i.getCenter)().y-30},note:{title:()=>`${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,"count")} Superdonors`,label:()=>`That's just ${c.state.formatPercentageOfFreeFlow(c.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,n.VOTER_GROUPS.ALL_DONORS,"count")} of the of the people who donated`,wrap:210,bgPadding:10,align:"middle"},subject:{radiusPadding:3},connector:{end:"arrow",type:"elbow"},className:"gold-annotation gold-donors-flow-annotation hidden-circle-annotation"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:100,outer:250}},render:{disable:!0}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorGroupsToPartyFree,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,color:n.typeColors.gold}],svgAnnotations:[{id:"gold-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,i.getCenter)().x+200,y:(0,i.getCenter)().y+80},note:{title:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,"outflow",!0)} in Superdonations`,label:()=>`That's ${c.state.formatPercentageOfFreeFlow(c.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,n.VOTER_GROUPS.ALL_DONORS,"donation")} of the total donations, from a tiny group of people`,wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation gold-flow-annotation"}]}],textAnnotations:[{text:"Individual Donation Amount:",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-230},targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:"Total Donations:",targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}],svgAnnotations:[]},t.partiesFocusingOnWealthy={id:"partiesFocusingOnWealthy",description:"Parties are focusing on wealthy donors",dotRadius:8,tween:!0,forceStrength:{charge:-8},images:[{image:a.viewImages.partyIcon},{image:a.viewImages.leafsLogo,position:{x:490,y:(0,i.getCenter)().y-40},size:{width:100,height:100},svgAnnotations:[{id:"maple-leafs-comparison-leafs-annotation",type:"calloutCircle",targetOffset:{x:0,y:-0},fixedPosition:{x:(0,i.getCenter)().x+300,y:(0,i.getCenter)().y+50},note:{title:"~15,000 Maple Leafs Season Ticket Holders",wrap:190,bgPadding:10,align:"right"},connector:{end:"arrow",type:"elbow"},className:"blue-annotation hidden-circle-annotation",subject:{radiusPadding:20}}]}],clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:370,y:(0,i.getCenter)().y-50}},textAnnotations:[{text:"$1000+",color:n.typeColors.gold,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}],svgAnnotations:[{id:"maple-leafs-comparison-superdot-annotation",type:"calloutCircle",targetOffset:{x:0,y:-0},fixedPosition:{x:(0,i.getCenter)().x-60,y:(0,i.getCenter)().y-160},note:{title:()=>`${c.state.formatFreeFlowAmount(c.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,"count")} Superdonors`,wrap:260,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"hidden-circle-annotation gold-annotation",subject:{radiusPadding:2}}]},{group:n.VOTER_GROUPS.DONORS_1_999,superdot:!0,render:{opacity:.5},force:{center:{x:150,y:(0,i.getCenter)().y-150}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}],textAnnotations:[{text:"$1-$999",color:n.typeColors.greal,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorsToPartyFree,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,color:n.typeColors.gold}]}],textAnnotations:[]},t.moneyBuysAccess={id:"moneyBuysAccess",description:"Money buys access to government",dotRadius:10,tween:!0,forceStrength:{charge:-9},images:[{image:a.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+10}}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorsToPartyFree}],clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,i.getCenter)().x+28,y:(0,i.getCenter)().y-100}}},{group:n.VOTER_GROUPS.DONORS_1_999,superdot:!0,render:{opacity:.5},force:{center:{x:330,y:(0,i.getCenter)().y-230}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:"#63C1CD"}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:300,outer:1e3}},render:{opacity:.4},ignoreYear:!0}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,i.getCenter)().y-10},fixedPosition:{x:570,y:(0,i.getCenter)().y+80},note:{title:"The Inner Circle",label:"Parties frequently host private events for large donors",wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:25,includeElements:[n.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation"},{id:"other-donors-annotation",type:"callout",target:{x:340,y:(0,i.getCenter)().y-150},fixedPosition:{x:530,y:(0,i.getCenter)().y-170},note:{title:"On the Outside",label:"The overwhelming majority of donors can't compete",wrap:160,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:20,includeElements:[n.VOTER_GROUPS.DONORS_1_999]},className:"hidden-line-annotation teal-annotation"}]}};const r=o(613),n=o(921),i=o(635),a=o(850),s=o(20),l=o(566),c=o(569)},657:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initSolutionViews=function(t){t.whatsTheSolutionAlt={id:"whatsTheSolutionAlt",description:"What's the solution?",dotRadius:4,tween:!0,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree,offset:{x:0,y:20}},{freeSankey:a.viewFreeSankeys.donorsToPartyOOPFree,offset:{x:0,y:-20}},{freeSankey:a.viewFreeSankeys.donorsToPartySubsidizedFree,offset:{x:0,y:-20}}],images:[{image:n.viewImages.partyIcon,position:{x:340,y:520},size:{width:90,height:90}},{image:n.viewImages.parliamentIcon,position:{x:340,y:150},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.DONORS_1_999,render:{opacity:1},superdot:!0,force:{center:{x:330,y:360}},groupColorOverride:[{group:r.VOTER_GROUPS.DONORS_1_999,color:r.typeColors.greal}]},{group:r.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:380,y:360}},superdot:!0},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}},ignoreYear:!0},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},t.whatsTheSolution={id:"whatsTheSolution",description:"So what can we do about it?",dotRadius:5,tween:!0,forceStrength:{charge:-5},clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000},{group:r.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:60,outer:100}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:150,outer:300}},render:{opacity:1}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1500}},render:{opacity:.3}}]},t.capTheDonationLimit1={id:"capTheDonationLimit1",description:"Cap the donation limit to $100",dotRadius:5,tween:!0,forceStrength:{charge:-5},images:[{image:n.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y},size:{width:70,height:70}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS,force:{type:"radial",boundary:{inner:50,outer:100}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:150,outer:300}},render:{opacity:.3}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1500}},render:{opacity:.3}}],svgAnnotations:[{id:"right-now-donor-count",type:"calloutCircle",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y},fixedPosition:{x:100,y:(0,i.getCenter)().y-160},note:{title:"Fundraising Focus",label:"With the current donation limits, parties only need to appeal to this many people to fundraise",wrap:250,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:5,includeElements:[r.VOTER_GROUPS.DONORS_OVER_1000,r.VOTER_GROUPS.DONORS_1_999,"bot-party-icon"]},className:"elite-donors-annotation"}]},t.capTheDonationLimit1Alt={id:"capTheDonationLimit1Alt",description:"Cap the donation limit to $100",dotRadius:5,tween:!0,freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsToPartyFree},{freeSankey:a.viewFreeSankeys.parliamentToAllDonorsFree}],images:[{image:n.viewImages.partyIcon,position:{x:340,y:520},size:{width:90,height:90}},{image:n.viewImages.parliamentIcon,position:{x:340,y:150},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS,render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS,color:r.typeColors.greal}],svgAnnotations:[{id:"right-now-donor-count",type:"calloutCircle",target:r.VOTER_GROUPS.ALL_DONORS,fixedPosition:{x:100,y:(0,i.getCenter)().y-160},note:{title:"Fundraising Focus",label:"With the current donation limits, parties only need to appeal to this many people to fundraise",wrap:250,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10,includeElements:[r.VOTER_GROUPS.ALL_DONORS]},className:"all-donors-annotation hidden-circle-annotation"}]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}},ignoreYear:!0},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},t.capTheDonationLimit2={id:"capTheDonationLimit2",description:"Then they have to connect to more voters",dotRadius:6,forceStrength:{charge:-6},requireAverageYears:!0,images:[{image:n.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y},size:{width:70,height:70}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,force:{type:"radial",boundary:{inner:50,outer:100}},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:r.VOTER_GROUPS.NON_DONATING_WITH_REFORM,force:{type:"radial",boundary:{inner:150,outer:400}},render:{opacity:.3}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:420,outer:1500}},render:{opacity:.3}}],svgAnnotations:[{id:"with-reform-donor-count",type:"calloutCircle",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y},fixedPosition:{x:100,y:(0,i.getCenter)().y-160},note:{title:"Double the Donors",label:"To make the same amount of money with the reduced limit, parties would need to attract twice as many donors as they do now",wrap:250,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:5,includeElements:[r.VOTER_GROUPS.DONORS_OVER_1000,r.VOTER_GROUPS.DONORS_1_999,r.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING,"bot-party-icon"]},className:"elite-donors-annotation"}]},t.capTheDonationLimit2Alt={id:"capTheDonationLimit2Alt",description:"Then they have to connect to more voters",dotRadius:5,tween:!0,freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:a.viewFreeSankeys.parliamentToAfterReformDonorsFree}],images:[{image:n.viewImages.partyIcon,position:{x:340,y:520},size:{width:90,height:90}},{image:n.viewImages.parliamentIcon,position:{x:340,y:150},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}},svgAnnotations:[{id:"with-reform-donor-count",type:"calloutCircle",fixedPosition:{x:100,y:(0,i.getCenter)().y+100},note:{title:"Double the Donors",label:"With a $100 cap, parties would need to attract twice as many donors to make the same amount of money",wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},subject:{radiusPadding:10,includeElements:[r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM]},className:"final-donors-annotation hidden-circle-annotation"}]},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}},ignoreYear:!0},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},t.whatAboutTheTaxCredit={id:"whatAboutTheTaxCredit",description:"What about the tax credit?",dotRadius:5,tween:!1,freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:a.viewFreeSankeys.parliamentToAfterReformDonorsFree}],images:[{image:n.viewImages.partyIcon,position:{x:340,y:520},size:{width:90,height:90}},{image:n.viewImages.parliamentIcon,position:{x:340,y:150},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}},ignoreYear:!0},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},t.whatAboutTheTaxCredit2={id:"whatAboutTheTaxCredit2",description:"What about the tax credit?",dotRadius:5,tween:!1,freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:a.viewFreeSankeys.parliamentToAfterReformDonorsFree,svgAnnotations:[{id:"tax-credit-annotation",type:"callout",targetAnchorLink:"junction",fixedPosition:{x:100,y:(0,i.getCenter)().y-50},note:{title:"Eliminate the Tax Credit",label:"We have a better idea for this money",wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10},className:"blue-flow-annotation"}]}],images:[{image:n.viewImages.partyIcon,position:{x:340,y:520},size:{width:90,height:90}},{image:n.viewImages.parliamentIcon,position:{x:340,y:150},size:{width:200,height:200}}],clumps:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}},ignoreYear:!0},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},t.bringBackPVS1={id:"bringBackPVS1",description:"Bring back the per-vote subsidy 1",dotRadius:2,tween:!0,forceStrength:{charge:-.7,collide:.5},images:[{image:n.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+240},size:{width:100,height:100}},{image:n.viewImages.parliamentIcon,position:{x:(0,i.getCenter)().x+50,y:(0,i.getCenter)().y-270},size:{width:200,height:200}}],freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsAfterReformToPartyOOPFree,offset:{x:0,y:0}},{freeSankey:a.viewFreeSankeys.parliamentToVotersAndDonorsSuperdotPurpleFree,offset:{x:0,y:0},svgAnnotations:[{id:"per-vote-subsidy-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:r.VOTER_GROUPS.NON_DONATING_VOTERS,targetFlowRatio:.3,fixedPosition:{x:100,y:(0,i.getCenter)().y-100},note:{title:"Per-Vote Subsidy",label:"For every vote a party gets, they get a small amount of public funding — Say around $2 per year",wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"purple-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.votersAndDonorsSuperdotToPartiesPurpleFree,offset:{x:0,y:0}}],clumps:[{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{center:{x:(0,i.getCenter)().x+45,y:(0,i.getCenter)().y}},superdot:!0},{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,superdot:!0,force:{center:{x:(0,i.getCenter)().x-30,y:(0,i.getCenter)().y}},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:200,outer:1e3}},render:{opacity:1}},{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,force:{type:"radial",boundary:{inner:50,outer:70}},render:{disable:!0},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:r.VOTER_GROUPS.NON_DONATING_WITH_REFORM,force:{type:"radial",boundary:{inner:50,outer:100}},render:{opacity:1,disable:!0}}]},t.bringBackPVS2={id:"bringBackPVS2",description:"Bring back the per-vote subsidy 2",dotRadius:2,forceStrength:{charge:-.7,collide:.5},images:[{image:n.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+240},size:{width:100,height:100}},{image:n.viewImages.parliamentIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-270},size:{width:200,height:200}}],freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.parliamentToVotersAndDonorsSuperdotPurpleFree,offset:{x:0,y:0},svgAnnotations:[]},{freeSankey:a.viewFreeSankeys.votersAndDonorsSuperdotToPartiesPurpleFree,offset:{x:0,y:0}}],clumps:[{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y}},superdot:!0},{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,superdot:!0,force:{center:{x:(0,i.getCenter)().x+200,y:(0,i.getCenter)().y}},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:0,disable:!0}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:200,outer:1e3}},render:{opacity:1}},{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,force:{type:"radial",boundary:{inner:50,outer:70}},render:{disable:!0},groupColorOverride:[{group:r.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:r.VOTER_GROUPS.NON_DONATING_WITH_REFORM,force:{type:"radial",boundary:{inner:50,outer:100}},render:{opacity:1,disable:!0}}]},t.bringBackPVS3={id:"bringBackPVS3",description:"Bring back the per-vote subsidy 3",dotRadius:5,tween:!0,forceStrength:{charge:-5},clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000},{group:r.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:40,outer:50}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:100,outer:300}}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1500}},render:{opacity:.2}}],svgAnnotations:[{id:"per-vote-subsidy-annotation",type:"callout",target:{x:(0,i.getCenter)().x-200,y:(0,i.getCenter)().y-200},note:{title:"The Current System",label:"Wouldn't it be nice if we could all have an equal influence on the outcome of an election, instead of needing to spend a lot of money to have our voices heard?",wrap:200,bgPadding:10,align:"middle"}}]},t.bringBackPVS4={id:"bringBackPVS4",description:"Bring back the per-vote subsidy 4",dotRadius:4,tween:!0,forceStrength:{charge:-3},clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000},{group:r.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:30,outer:40}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:60,outer:230}}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:260,outer:800}},render:{opacity:1}}]},t.finalFootnote={id:"finalFootnote",description:"finalFootnote",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:r.VOTER_GROUPS.DONORS_OVER_1000},{group:r.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:10,outer:30}}},{group:r.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:35,outer:170}}},{group:r.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:180,outer:330}},render:{opacity:1}}]}};const r=o(921),n=o(850),i=o(635),a=o(20)},635:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getCenter=void 0;const r=o(569);e.getCenter=()=>({x:r.state.svgWidth/2,y:r.state.svgHeight/2})},850:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.viewImages=void 0,e.initializeImages=function(){const t={partyIcon:new r.SimImage({id:"bot-party-icon",src:"assets/img/parties-icon-v03.svg",alt:"Political party icon",position:{x:350,y:500},size:{width:100,height:100},rotates:!0}),parliamentIcon:new r.SimImage({id:"parliament-icon-end",src:"assets/img/parliament-v01.svg",alt:"Parliament icon",position:{x:250,y:100},size:{width:600,height:200}}),leafsLogo:new r.SimImage({id:"leafs-logo",src:"assets/img/leafs-logo.svg",alt:"Leafs logo",position:{x:100,y:100},size:{width:200,height:200}})},o=Object.values(t).map((t=>t.id));if(new Set(o).size!==o.length)throw new Error("Duplicate image IDs found");for(const o in t){const r=t[o];e.viewImages[o]=r}};const r=o(636);e.viewImages={}},610:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getCenter=e.viewPresets=e.updateFlowSankeys=e.viewSankeys=e.viewImages=void 0,e.initializeViewComponents=function(){(0,s.initializeImages)(),(0,l.initializeSankeys)(),(0,c.initializeViews)()};var r=o(850);Object.defineProperty(e,"viewImages",{enumerable:!0,get:function(){return r.viewImages}});var n=o(20);Object.defineProperty(e,"viewSankeys",{enumerable:!0,get:function(){return n.viewSankeys}}),Object.defineProperty(e,"updateFlowSankeys",{enumerable:!0,get:function(){return n.updateFlowSankeys}});var i=o(263);Object.defineProperty(e,"viewPresets",{enumerable:!0,get:function(){return i.viewPresets}});var a=o(635);Object.defineProperty(e,"getCenter",{enumerable:!0,get:function(){return a.getCenter}});const s=o(850),l=o(20),c=o(263)},20:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tempSankeyData=e.viewFreeSankeys=e.viewSankeys=void 0,e.initializeSankeys=function(){const t={canadianSuperdotToParties:new r.Sankey({id:"canadian-superdot-to-parties",description:"Flow from all eligible Canadian voters to parties",totalThickness:100,color:"rgba(0, 255, 30, 0.3)",orientation:"horizontal",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,percentage:1,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:-200,y:0}},flowConfig:{style:"dashed",arrowPosition:"end",animated:!0,dashed:!0,arrowStyle:{offset:15,color:"#00c000",headColor:"#00c000",trimStart:.1,trimEnd:.9,opacity:1,width:4},groupArrowStyles:{[i.VOTER_GROUPS.ALL_ELIGIBLE.id]:{offset:{x:0,y:30},trimStart:.4,trimEnd:.9}},junctionArrowStyle:{offset:{x:0,y:30},color:"#00c000",headColor:"#00c000",trimStart:0,trimEnd:.6,width:5}}}),parliamentToCanadianSuperdot:new r.Sankey({id:"parliament-to-canadian-superdot",description:"Flow from all eligible Canadian voters",totalThickness:45,color:"rgba(0, 106, 255, 0.3)",orientation:"horizontal",source:{type:"image",image:a.viewImages.parliamentIcon,offset:{x:-120,y:0}},target:{type:"groups",groups:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,percentage:1,useSuperdot:!0}]},flowConfig:{style:"dashed",animated:!0}}),votersAndDonorsSuperdotToParties:new r.Sankey({id:"voter-donor-superdot-to-parties",description:"Flow from all eligible Canadian voters to parties",totalThickness:45,color:"rgba(0, 255, 30, 0.3)",orientation:"vertical",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,percentage:1,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-50}},flowConfig:{style:"dashed",animated:!0}}),parliamentToVotersAndDonorsSuperdot:new r.Sankey({id:"parliament-to-voter-donor-superdot",description:"Flow from all eligible Canadian voters",totalThickness:45,color:"rgba(0, 106, 255, 0.3)",orientation:"vertical",source:{type:"image",image:a.viewImages.parliamentIcon,offset:{x:0,y:100}},target:{type:"groups",groups:[{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,percentage:1,useSuperdot:!0}]},flowConfig:{style:"dashed",animated:!0}}),votersToParty:new r.Sankey({id:"voters-to-party",description:"Flow from all voters to parties",totalThickness:100,color:"rgba(0, 255, 30, 0.3)",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,percentage:1}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-100}},flowConfig:{style:"arrow",arrowPosition:"end",animated:!0,dashed:!0,arrowStyle:{offset:12,color:"rgba(0, 106, 255, 0.8)",headColor:"#006aff",trimStart:.4,trimEnd:.6,opacity:.8,width:4},junctionArrowStyle:{offset:{x:5,y:-10},color:"rgba(0, 130, 255, 0.9)",headColor:"#0055dd",trimStart:.3,trimEnd:.7,width:3,opacity:.85}}}),donorsToParty:new r.Sankey({id:"donors-to-party",description:"Flow from donors to parties",totalThickness:e.tempSankeyData.donations.allParties/l.MONEY_SCALE,color:"rgba(0, 255, 30, 0.3)",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.DONORS_1_199,percentage:e.tempSankeyData.donations.percentage1_199,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_200_499,percentage:e.tempSankeyData.donations.percentage200_499,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_500_999,percentage:e.tempSankeyData.donations.percentage500_999,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_OVER_1000,percentage:e.tempSankeyData.donations.percentageAbove1k,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-100}},flowConfig:{style:"dashed",arrowPosition:"end",arrowStyle:{offset:-20,color:"green",headColor:"green",trimStart:.2,trimEnd:.8,opacity:1,width:4},groupArrowStyles:{[i.VOTER_GROUPS.DONORS_1_199.id]:{offset:{x:-30,y:0},trimStart:.4},[i.VOTER_GROUPS.DONORS_200_499.id]:{offset:{x:16,y:0},trimStart:.2,trimEnd:.5},[i.VOTER_GROUPS.DONORS_500_999.id]:{offset:{x:16,y:0},trimStart:.2,trimEnd:.7},[i.VOTER_GROUPS.DONORS_OVER_1000.id]:{offset:{x:30,y:20},color:"gold",headColor:"gold",trimStart:.1,trimEnd:1},[i.VOTER_GROUPS.DONORS_1_999.id]:{offset:{x:-50,y:0},opacity:.2,trimStart:.4}},junctionArrowStyle:{offset:{x:0,y:-40},color:"rgba(0, 150, 0, 0.7)",headColor:"#008800",trimStart:.5,trimEnd:.7,width:6,opacity:.8}}}),donorsToPartySimple:new r.Sankey({id:"donors-to-party-simple",description:"Flow from donors to parties",totalThickness:e.tempSankeyData.donations.allParties/l.MONEY_SCALE,color:"rgba(0, 255, 30, 0.3)",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.DONORS_1_199,percentage:e.tempSankeyData.donations.percentage1_199,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_200_499,percentage:e.tempSankeyData.donations.percentage200_499,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_500_999,percentage:e.tempSankeyData.donations.percentage500_999,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_OVER_1000,percentage:e.tempSankeyData.donations.percentageAbove1k,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-45}},flowConfig:{style:"dashed"}}),donorsToPartySubsidized:new r.Sankey({id:"donors-to-party-subsidized",description:"Portion of flow from donors to parties that is subsidized",totalThickness:e.tempSankeyData.taxCredits.allParties/l.MONEY_SCALE,color:"rgba(0, 106, 255, 0.3)",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.DONORS_1_199,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_200_499,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_500_999,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_OVER_1000,percentage:e.tempSankeyData.taxCredits.percentageAbove1k,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-80}},flowConfig:{style:"dashed"}}),donorsToPartyOOP:new r.Sankey({id:"donors-to-party-out-of-pocket",description:"Portion of flow from donors to parties that is out-of-pocket",totalThickness:e.tempSankeyData.outOfPocket.allparties/l.MONEY_SCALE,color:"rgba(0, 255, 30, 0.3)",source:{type:"groups",groups:[{group:i.VOTER_GROUPS.DONORS_1_199,percentage:e.tempSankeyData.outOfPocket.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_200_499,percentage:e.tempSankeyData.outOfPocket.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_500_999,percentage:e.tempSankeyData.outOfPocket.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_OVER_1000,percentage:e.tempSankeyData.outOfPocket.percentageAbove1k,useSuperdot:!0}]},target:{type:"image",image:a.viewImages.partyIcon,offset:{x:0,y:-80}},flowConfig:{style:"dashed"}}),parliamentToDonors:new r.Sankey({id:"parliament-to-donors",description:"Flow from parliament to donors",totalThickness:e.tempSankeyData.taxCredits.allParties/l.MONEY_SCALE,color:"rgba(0, 106, 255, 0.3)",source:{type:"image",image:a.viewImages.parliamentIcon,offset:{x:0,y:150}},target:{type:"groups",groups:[{group:i.VOTER_GROUPS.DONORS_1_199,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_200_499,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_500_999,percentage:e.tempSankeyData.taxCredits.percentageBelow1k/3,useSuperdot:!0},{group:i.VOTER_GROUPS.DONORS_OVER_1000,percentage:e.tempSankeyData.taxCredits.percentageAbove1k,useSuperdot:!0}]},flowConfig:{style:"dashed"}}),parliamentToVoters:new r.Sankey({id:"parliament-to-voters",description:"Flow from parliament to all voters",totalThickness:e.tempSankeyData.taxCredits.allParties/l.MONEY_SCALE,color:"rgba(0, 106, 255, 0.3)",source:{type:"image",image:a.viewImages.parliamentIcon,offset:{x:0,y:150}},target:{type:"groups",groups:[{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,percentage:1}]}})},o={votersAndDonorsSuperdotToPartiesFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.green}),votersAndDonorsSuperdotToPartiesBlueFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.blue}),votersAndDonorsSuperdotToPartiesPurpleFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.purple}),parliamentToVotersAndDonorsSuperdotFree:(0,s.createFreeSankey)({target:a.viewImages.parliamentIcon,targetOffset:{x:0,y:55},junctionOffset:{x:0,y:70},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.blue}),parliamentToVotersAndDonorsSuperdotPurpleFree:(0,s.createFreeSankey)({target:a.viewImages.parliamentIcon,targetOffset:{x:0,y:55},junctionOffset:{x:0,y:70},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.purple}),donorGroupsToPartyFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_199,i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.DONORS_500_999],color:i.flowColors.green}),allDonorsToPartyFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.green}),allDonorsAfterReformToPartyFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.green}),parliamentToAfterReformDonorsFree:(0,s.createFreeSankey)({target:a.viewImages.parliamentIcon,targetOffset:{x:0,y:55},junctionOffset:{x:0,y:70},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.blue}),allDonorsAfterReformToPartyOOPFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"outOfPocket",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.green}),allDonorsToPartySplit1Free:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_1_199,c.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000])],color:i.flowColors.green}),allDonorsToPartySplit2Free:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_1_199,i.VOTER_GROUPS.DONORS_200_499,c.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000])],color:i.flowColors.green}),donorsToPartyFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.green}),parliamentToDonorsFree:(0,s.createFreeSankey)({target:a.viewImages.parliamentIcon,junctionOffset:{x:0,y:70},targetOffset:{x:0,y:55},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.blue}),parliamentToAllDonorsFree:(0,s.createFreeSankey)({target:a.viewImages.parliamentIcon,junctionOffset:{x:0,y:70},targetOffset:{x:0,y:55},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.blue}),donorsToPartySubsidizedFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.blue}),donorsToPartyOOPFree:(0,s.createFreeSankey)({target:a.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"outOfPocket",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.green})};for(const o in t){const r=t[o];e.viewSankeys[o]=r}Object.entries(o).forEach((([t,o])=>{e.viewFreeSankeys[t]=o}))},e.updateFlowSankeys=function t(){window.updateFlowSankeys=t;const o=n.state.currentYear;if(!n.state.flowData[o])return;try{n.state.flowData[o]["Total donated to all parties"];const t=n.state.flowData[o]["Total from donors >$1000"]||0,r=n.state.flowData[o]["Total from donors  <$1000"]||0,a=n.state.flowData[o]["Total tax credit"]||0,s=n.state.flowData[o]["Total tax credit to donors >$1000 (assuming they all use the full $650 tax credit)"]||0,l=n.state.flowData[o]["Total tax credit to donors <$1000 "]||0,c=t-s,d=r-l,u=c+d,p=c/u,g=d/u,f=s/a,h=l/a;if(e.viewSankeys.parliamentToDonors&&"groups"===e.viewSankeys.parliamentToDonors.target.type&&e.viewSankeys.parliamentToDonors.target.groups){const t=e.viewSankeys.parliamentToDonors.target.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=e.viewSankeys.parliamentToDonors.target.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_1_999||t.group===i.VOTER_GROUPS.DONORS_1_199||t.group===i.VOTER_GROUPS.DONORS_200_499||t.group===i.VOTER_GROUPS.DONORS_500_999));t>=0&&(e.viewSankeys.parliamentToDonors.target.groups[t].percentage=f),o>=0&&(e.viewSankeys.parliamentToDonors.target.groups[o].percentage=h),e.viewSankeys.parliamentToDonors.totalThickness=Math.min(50,Math.max(15,a/1e6))}if(e.viewSankeys.donorsToPartyOOP&&"groups"===e.viewSankeys.donorsToPartyOOP.source.type&&e.viewSankeys.donorsToPartyOOP.source.groups){const t=e.viewSankeys.donorsToPartyOOP.source.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=e.viewSankeys.donorsToPartyOOP.source.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_1_999||t.group===i.VOTER_GROUPS.DONORS_1_199||t.group===i.VOTER_GROUPS.DONORS_200_499||t.group===i.VOTER_GROUPS.DONORS_500_999));t>=0&&(e.viewSankeys.donorsToPartyOOP.source.groups[t].percentage=p),o>=0&&(e.viewSankeys.donorsToPartyOOP.source.groups[o].percentage=g),e.viewSankeys.donorsToPartyOOP.totalThickness=Math.min(50,Math.max(15,u/1e6))}if(e.viewSankeys.donorsToPartySubsidized&&"groups"===e.viewSankeys.donorsToPartySubsidized.source.type&&e.viewSankeys.donorsToPartySubsidized.source.groups){const t=e.viewSankeys.donorsToPartySubsidized.source.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=e.viewSankeys.donorsToPartySubsidized.source.groups.findIndex((t=>t.group===i.VOTER_GROUPS.DONORS_1_999||t.group===i.VOTER_GROUPS.DONORS_1_199||t.group===i.VOTER_GROUPS.DONORS_200_499||t.group===i.VOTER_GROUPS.DONORS_500_999));t>=0&&o>=0&&(e.viewSankeys.donorsToPartySubsidized.source.groups[t].percentage=f,e.viewSankeys.donorsToPartySubsidized.source.groups[o].percentage=h),e.viewSankeys.donorsToPartySubsidized.totalThickness=Math.min(50,Math.max(15,a/1e6))}}catch(t){}};const r=o(3),n=o(569),i=o(921),a=o(850),s=o(965),l=o(921),c=o(613);e.viewSankeys={},e.viewFreeSankeys={},e.tempSankeyData={donations:{allParties:51440613.66,above1k:15887530.44,below1k:35553083.22,allPartiesText:"$51,440,613.66",above1kText:"$15,887,530.44",below1kText:"$35,553,083.22",donors500_999:9319135.81,donors200_499:12332582.45,donors1_199:13892732.48,donors500_999Text:"$9,319,135.81",donors200_499Text:"$12,332,582.45",donors1_199Text:"$13,892,732.48",percentageAbove1k:.31,percentageBelow1k:.69,percentage500_999:.18116299839646977,percentage200_499:.2397440771510423,percentage1_199:.270073226027685},taxCredits:{allParties:32613142.86,above1k:9065828.57,below1k:23547314.29,allPartiesText:"$32,613,142.86",above1kText:"$9,065,828.57",below1kText:"$23,547,314.29",percentageAbove1k:.28,percentageBelow1k:.72}},e.tempSankeyData.outOfPocket={allparties:e.tempSankeyData.donations.allParties-e.tempSankeyData.taxCredits.allParties,above1k:e.tempSankeyData.donations.above1k-e.tempSankeyData.taxCredits.above1k,below1k:e.tempSankeyData.donations.below1k-e.tempSankeyData.taxCredits.below1k},e.tempSankeyData.outOfPocket.percentageAbove1k=e.tempSankeyData.outOfPocket.above1k/e.tempSankeyData.outOfPocket.allparties,e.tempSankeyData.outOfPocket.percentageBelow1k=e.tempSankeyData.outOfPocket.below1k/e.tempSankeyData.outOfPocket.allparties},934:(t,e,o)=>{t.exports=o.p+"d93ddff06d4a28ce6503.png"},663:(t,e,o)=>{t.exports=o.p+"09e92d1410acd91d4dd3.png"},728:(t,e,o)=>{t.exports=o.p+"a152cd88d51121f2e8aa.png"},29:(t,e,o)=>{t.exports=o.p+"4efca81989266aacfb64.png"},946:(t,e,o)=>{t.exports=o.p+"8169c5a92d5055627d0e.png"},373:(t,e,o)=>{t.exports=o.p+"32338d58bac6035b2c11.png"},234:(t,e,o)=>{t.exports=o.p+"544df8efba6395a66bb7.png"},489:(t,e,o)=>{t.exports=o.p+"ecc574b7dcab4f1a8132.png"},487:(t,e,o)=>{t.exports=o.p+"0e2884683166703683ab.png"}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,o),i.exports}o.m=t,o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),o.b=document.baseURI||self.location.href,o.nc=void 0;(()=>{o(376);const t=o(646),e=o(921),r=o(569),n=o(517),i=o(114),a=o(610),s=o(795),l=o(391);const c=new Set(["everyoneRadial"]);function d(){const t=document.getElementById("year-selector");if(!t)return;if(r.state.view&&c.has(r.state.view.id))return void(t.style.display="none");t.style.display="flex","Average 2016-2022"===r.state.currentYear?t.classList.add("average-active"):t.classList.remove("average-active");t.querySelectorAll(".year-button").forEach((t=>{const e=t,o=e.dataset.year||"",n=o===r.state.currentYear,i=r.state.yearHasDataForActiveTypes(o),a=r.state.lockedToAverageYears&&"Average 2016-2022"!==o;n?e.classList.add("active"):e.classList.remove("active"),e.disabled=!i||a}))}window.updateYearSelectorUI=d,async function(){(0,e.createVoterGroups)(),r.state.importedData=await(0,t.loadVoterData)("assets/csv/voters.csv"),r.state.freeFlowData=await(0,t.loadFlowData)("assets/csv/freeFlow.csv"),r.state.flattenedData=(0,t.flattenData)(r.state.importedData),(0,a.initializeViewComponents)(),(0,i.initVisualization)("chart1"),(0,n.initSimulation)(),function(){const t=document.createElement("div");t.id="year-selector",r.state.availableYears.forEach((e=>{const o=document.createElement("button");"Average 2016-2022"===e?(o.textContent="Average",o.classList.add("average-year")):o.textContent=e,o.dataset.year=e,o.classList.add("year-button"),"2019"!==e&&"2021"!==e||o.classList.add("election-year"),o.addEventListener("click",(()=>{r.state.setYear(e),d()})),t.appendChild(o)})),document.body.appendChild(t)}(),(0,l.initLegend)(),(0,s.initEventListeners)(),(0,s.setViewFromVisibleTriggers)()}()})()})();