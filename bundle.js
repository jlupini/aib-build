(()=>{"use strict";var e={8011:(e,t,o)=>{o.d(t,{A:()=>P});var n=o(1601),i=o.n(n),r=o(6314),a=o.n(r),s=o(4417),l=o.n(s),d=new URL(o(3373),o.b),c=new URL(o(1029),o.b),u=new URL(o(132),o.b),p=new URL(o(9234),o.b),g=new URL(o(3946),o.b),h=new URL(o(4968),o.b),f=new URL(o(9489),o.b),m=new URL(o(1487),o.b),y=new URL(o(8934),o.b),O=new URL(o(2728),o.b),_=new URL(o(5663),o.b),b=a()(i()),w=l()(d),v=l()(c),x=l()(u),S=l()(p),k=l()(g),R=l()(h),T=l()(f),E=l()(m),N=l()(y),A=l()(O),D=l()(_);b.push([e.id,`body{background-color:#faf9f7;margin:0;font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal}body.body-scroll main{height:auto}nav{background-color:#faf9f7;box-shadow:0 2px 4px 0 rgba(0,0,0,.1);padding:22px 0;position:fixed;left:0;width:100%;z-index:1000;top:0;display:flex;position:sticky;top:0;z-index:1000}main{padding:0 0;position:relative;z-index:500;height:calc(100vh - 100px - 44px)}main::after{content:"";border-right:10px dashed #dad9d8;display:block;width:15%;min-width:265px;height:100%;left:17px;top:0;position:absolute}main.side-view>.sticky-wrapper{min-height:1300px;width:30%;margin-left:22px;min-width:530px;position:relative}main.side-view>.sticky-wrapper.extra-long{min-height:1500px}main.side-view>.sticky-wrapper.centre{left:50%;transform:translateX(-50%);width:42%}main.side-view>.sticky-wrapper.centre .content-block{transform:translateY(-50%)}main.side-view>.sticky-wrapper .content-block{position:sticky;top:50%;width:auto;margin:0 0 160px}main.side-view>.sticky-wrapper .minor-trigger{position:absolute;top:0%;left:50%;transform:translateX(-50%);width:20px;height:20px;border-radius:50%;border:5px solid #faf9f7;background-color:#d8d8d8;z-index:100;transition:background-color .5s ease-out}main.side-view>.sticky-wrapper .minor-trigger.active{box-shadow:0 0 10px 0 rgba(0,200,255,.4)}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.1"]{top:10%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.2"]{top:20%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.3"]{top:30%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.4"]{top:40%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.5"]{top:50%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.6"]{top:60%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.7"]{top:70%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.8"]{top:80%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="0.9"]{top:90%}main.side-view>.sticky-wrapper .minor-trigger[data-percentage="1.0"]{top:100%}main.side-view #chart1{top:0;right:0;left:auto;width:calc(100% - 30% - 22px);height:100vh;z-index:-1}main.side-view #progress-bar{position:fixed;top:96px;left:0;width:100%;height:24px;background-color:#fefefe;opacity:.9;z-index:1000;transition:opacity .3s ease-in-out;border-bottom:1px solid #e0e0e0;backdrop-filter:blur(2px)}main.side-view #progress-bar.hidden{opacity:0}main.side-view #progress-bar #progress-content-container{opacity:.4}main.side-view #progress-bar #progress-content-container::after{content:"";position:absolute;display:block;width:100%;height:30%;bottom:35%;background-color:#e0e0e0;z-index:-100}main.side-view #progress-bar #progress-bar-fill{position:absolute;height:30%;bottom:35%;width:0;background-color:#0091ff;transition:width .3s ease-in-out}main.side-view #progress-bar #progress-markers{position:absolute;width:100%;height:100%;top:50%;pointer-events:none}main.side-view #progress-bar .progress-marker{position:absolute;top:-7px;width:10px;height:10px;background-color:#c8c8c8;border-radius:50%;transition:border-color .3s ease-in-out,background-color .3s ease-in-out,transform .3s ease-in-out;pointer-events:auto;cursor:pointer;transform:translateX(-2px) scale(1.2);border:2px solid #eaeaea}main.side-view #progress-bar .progress-marker.minor{width:6px;height:6px;top:-5px;transform:translateX(-2px) scale(1.2)}main.side-view #progress-bar .progress-marker.active{transform:translateX(-2px) scale(1.4)}main.side-view #progress-bar .progress-marker:hover{transform:translateX(-2px) scale(1.3);background-color:#6a00ff}main.side-view #progress-bar .progress-marker.active,main.side-view #progress-bar .progress-marker.passed.active{background-color:#f0f}main.side-view #progress-bar .progress-marker.passed{background-color:#0091ff}main .content-block{pointer-events:auto}main .spacer-block{height:1000px}.color-wrapper{display:flex;justify-content:space-between;margin:0 auto 400px;width:100%;min-height:600px;position:relative;z-index:500;backdrop-filter:blur(2px)}.color-wrapper .content-block{max-width:1000px}.color-wrapper .content-block.narrow{max-width:600px}.color-wrapper .content-block.no-bg{backdrop-filter:none}.color-wrapper.behind{z-index:-200}.color-wrapper>div{flex:1 1 auto;z-index:500}.color-wrapper:first-child{padding-top:100px}.color-wrapper.lavender{background-color:rgba(226,160,255,.7)}.color-wrapper.pale{background-color:rgba(250,249,247,.7)}.color-wrapper.bottom{margin-bottom:0;min-height:auto;padding-top:30px;padding-bottom:30px}.color-wrapper .scroll-arrow::after{opacity:.3}#controls{display:flex;position:relative;width:auto;flex:1 1 auto;text-align:right}#controls>*{flex:1 1 auto;margin:5px 10px}#controls .stop-button{background-color:#f33;color:#fff;font-weight:bold;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}#controls .stop-button:hover{background-color:red}#controls .stop-button.active{background-color:#0a0}#controls .stop-button.active:hover{background-color:#0c0}#controls .save-button{background-color:#36f;color:#fff;font-weight:bold;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}#controls .save-button:hover{background-color:#04c}.aib-logo{text-align:left;height:52px}.aib-logo img{display:inline-block;margin:0 auto;padding:0 20px;height:100%}footer{background-color:#faf9f7;box-shadow:0 -2px 4px 0 rgba(0,0,0,.1);padding:22px 0;position:fixed;left:0;width:100%;z-index:1000;bottom:0;display:flex;position:sticky;bottom:0;z-index:10000}footer>.footer-data-item{display:flex}footer>.footer-data-item>div{flex:1 1 auto;margin:0 10px}h1{font-family:"ringold-sans",sans-serif;font-weight:400;font-style:normal;font-size:5.5rem;margin:0 0 20px}h2{font-family:"ringold-sans",sans-serif;font-weight:400;font-style:normal;font-size:2.5rem;margin:0 0 20px;line-height:1.1}h2.smaller{font-size:2.3rem}h2 a{color:#231f20}h2 .inline-voter-dot{width:26px;height:26px;top:-1px}h3{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:1.3rem;margin:0 0 20px}h3 .inline-voter-dot{width:15px;height:15px}h4{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:1.1rem;margin:0 0 20px}h1,h2,h3,h4,h5,h6,p{text-align:center}ul li{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal;font-size:.8rem;margin:0 0 10px;text-align:left}.font-book{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:normal}.font-book-italic{font-family:"p22-mackinac-pro",serif;font-weight:400;font-style:italic}.font-medium{font-family:"p22-mackinac-pro",serif;font-weight:500;font-style:normal}.font-medium-italic{font-family:"p22-mackinac-pro",serif;font-weight:500;font-style:italic}.font-bold{font-family:"p22-mackinac-pro",serif;font-weight:700;font-style:normal}.font-bold-italic{font-family:"p22-mackinac-pro",serif;font-weight:700;font-style:italic}.font-extra-bold{font-family:"p22-mackinac-pro",serif;font-weight:800;font-style:normal}.font-extra-bold-italic{font-family:"p22-mackinac-pro",serif;font-weight:800;font-style:italic}.text-lemon{color:#ffdd2b}.text-lavender{color:#e2a0ff}.text-dark{color:#231f20}.text-plum{color:#460000}.text-pear{color:#b5c716}.text-grape{color:#473198}.text-mint{color:#034238}.text-light{color:#faf9f7}.text-gold{color:#d6a800}.text-voter-purple{color:#833b8d}.text-voter-blue{color:#5899ea}.text-voter-blue.darken{color:rgb(24.5744680851,100.6382978723,195.4255319149)}.text-voter-cyan{color:#67d7be}.text-voter-cyan.darken{color:rgb(45,171,142.875)}.text-voter-teal{color:#63c1cd}.text-voter-teal.darken{color:rgb(49.0291262136,141.2038834951,152.9708737864)}.text-greal{color:rgb(49.0291262136,141.2038834951,152.9708737864)}.text-greal.darken{color:rgb(49.0291262136,141.2038834951,152.9708737864)}.text-stroke-dark{-webkit-text-stroke:2px #231f20}.green-highlighter,.blue-highlighter,.purple-highlighter{padding:2px 5px}h2 .green-highlighter,h2 .blue-highlighter,h2 .purple-highlighter{padding:0 5px}.green-highlighter{background-color:rgba(0,255,30,.3)}.blue-highlighter{background-color:rgba(0,106,255,.3);padding:2px 5px}.purple-highlighter{background-color:#833b8d;padding:2px 5px}a.source-citation{color:#231f20;text-decoration-color:rgba(3,66,56,.3)}a.source-citation:hover{color:#034238;text-decoration-color:#034238}a.source-citation.super{font-size:.5rem;color:#231f20;text-decoration:none;vertical-align:super}a.source-citation.red{color:#ac0000;text-decoration-color:#ac0000}a.source-citation.red:hover{color:#460000;text-decoration-color:#460000}.content-block{position:relative;top:0;z-index:800;background-color:hsla(0,0%,100%,.5);padding:30px 30px 20px;width:50%;margin:200px auto 1000px;box-shadow:0 0 4px 0 rgba(0,0,0,.1);backdrop-filter:blur(3px);filter:blur(4px);transition:background-color .2s cubic-bezier(0.84, 0, 0.17, 1),box-shadow .2s cubic-bezier(0.84, 0, 0.17, 1),opacity .2s cubic-bezier(0.84, 0, 0.17, 1),transform .2s cubic-bezier(0.84, 0, 0.17, 1);transform:translateX(-52%) translateY(-50%);border-radius:10px;opacity:.7}.content-block.yellow-border{border:3px solid #ffdd2b}.content-block h1,.content-block h2,.content-block h3,.content-block h4,.content-block h5,.content-block img{opacity:.3;transition:opacity .2s}.content-block.no-filter{filter:blur(0px)}.content-block a.logo-link img{display:block;width:70%;position:relative;margin:0 auto 10px}.content-block:hover{background-color:hsla(0,0%,100%,.8);opacity:1}.content-block:hover h1,.content-block:hover h2,.content-block:hover h3,.content-block:hover h4,.content-block:hover h5{opacity:1}.content-block .minor-trigger-text{position:relative;transition:opacity .8s ease-in-out,max-height 1s ease-in-out,filter .8s ease-in-out,-webkit-filter .8s ease-in-out;-webkit-filter:blur(10px);filter:blur(10px)}.content-block .minor-trigger-text.active{-webkit-filter:blur(0px);filter:blur(0px)}.content-block.active{z-index:1000;transform:translateX(0) translateY(-50%);box-shadow:0 -2px 4px 0 rgba(0,0,0,.1),1px 1px 19px rgba(0,200,255,.4);backdrop-filter:blur(5px);opacity:1;filter:blur(0px)}.content-block.active h1,.content-block.active h2,.content-block.active h3,.content-block.active h4,.content-block.active h5,.content-block.active img{opacity:1}.content-block.active .invitations{opacity:1}.content-block.active .minor-trigger-text{opacity:.2}.content-block.active .minor-trigger-text.active{opacity:1}.content-block.no-bg{background-color:rgba(0,0,0,0);box-shadow:none;backdrop-filter:none;opacity:1;transform:translateX(0)}.content-block.no-bg h1,.content-block.no-bg h2,.content-block.no-bg h3,.content-block.no-bg h4,.content-block.no-bg h5{opacity:1}.content-block:first-child{margin-top:0;width:90%;line-height:1.1}.content-block.short{margin-bottom:0}.content-block.medium{margin-bottom:100px}.content-block.width-medium{width:70%}.content-block .left-container{width:fit-content;margin:10px auto;padding:10px}.content-block .left-container.legend{background-color:#faf9f7;border:1px solid #231f20;border-radius:4px}.content-block .left-container>*{text-align:left}.content-block .left-container>h1,.content-block .left-container h2,.content-block .left-container h3,.content-block .left-container h4,.content-block .left-container h5{margin:.1em 0}.scrolling-images{display:flex;position:absolute;left:0;top:100%;width:100%;justify-content:center;gap:20px;align-items:flex-start}.content-block.active .invitations{transition:opacity .3s,transform .3s}.invitations{display:inline-block;border-radius:8px;border:#ffc803 solid 3px;margin:40px 0;width:calc(50% - 20px);opacity:.1;transition:opacity 2s,transform .3s;z-index:1000;flex:1 1 auto;background-color:#ffc803;position:relative}.invitations.zoom:hover{opacity:1;transition:opacity .3s,transform .3s;transform:scale(1.75) translate(20%, -15%);z-index:10000}.invitations.zoom:hover .image{height:247px}.invitations.zoom:hover .image.liberal-invite{background-image:url(${w})}.invitations.zoom:hover .image.conservative-invite{background-image:url(${v});height:205px}.invitations.zoom:hover .image.globe-article-cash-for-access{background-image:url(${x})}.invitations img,.invitations .image{display:block;width:100%;height:150px;max-width:100%;border-radius:7px;background-size:cover;background-position:center top;transition:background-image .5s ease-in-out,height .3s ease-in-out;transition-delay:.1s}.invitations img.liberal-invite,.invitations .image.liberal-invite{background-image:url(${S})}.invitations img.conservative-invite,.invitations .image.conservative-invite{background-image:url(${k})}.invitations img.globe-article-cash-for-access,.invitations .image.globe-article-cash-for-access{background-image:url(${R})}.invitations .invitation-text{font-size:.8rem;color:#231f20;text-align:center;padding:10px}.invitations a{color:#231f20;text-decoration-color:#231f20}.invitations:hover a .invitation-text{color:hsl(345,6.0606060606%,32.9411764706%);text-decoration-color:hsl(345,6.0606060606%,32.9411764706%)}.content-block:hover .scroll-arrow::after{opacity:.3}.content-block:hover .scroll-arrow:hover::after{opacity:1}.scroll-arrow{display:none;height:50px;width:100px;position:relative;top:0;left:50%;transform:translateX(-50%);z-index:1000;cursor:pointer}.scroll-arrow::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:url(${T}) no-repeat center;background-size:100% auto;opacity:.3;transition:opacity .3s ease-out}.scroll-arrow.plum::after{background-image:url(${E})}.scroll-arrow.small{height:25px;width:50px}.scroll-arrow:hover::after{opacity:1;animation:move-up-down 1.5s ease-in-out infinite forwards}@keyframes move-up-down{0%,100%{transform:translate(0, 0)}50%{transform:translate(0, 7px)}}.avo-credit{text-align:center;margin-top:30px;margin-bottom:10px}.avo-credit a{text-decoration:none;color:#231f20}.avo-credit:hover .avo-logo{transform:scale(1.1)}.avo-credit .avo-logo{display:inline-block;opacity:1;width:30%;transition:transform .3s ease-in-out}.inline-voter-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin:0 5px}.inline-voter-dot.purple{background-color:#833b8d}.inline-voter-dot.blue{background-color:#5899ea}.inline-voter-dot.grey{background-color:#ababab}.inline-voter-dot.cyan{background-color:#67d7be}.inline-voter-dot.gold{background-color:#ffc803}.inline-voter-dot.teal{background-color:#63c1cd}#year-selector{position:fixed;bottom:80px;right:20px;display:flex;flex-direction:column;align-items:flex-end;gap:5px;z-index:10000}#year-selector .year-selector-title{font-size:12px;font-family:"Inter",sans-serif;color:#231f20}#year-selector.average-active .year-button:not(.average-year){background-color:rgba(88,153,234,.3)}#year-selector.average-active .year-button.election-year::after{background:url(${N}) no-repeat center;background-size:100% auto}#year-selector .year-button{padding:4px 8px;margin:2px;border-radius:4px;cursor:pointer;background-color:#f0f0f0;color:#333;border:none;font-size:12px;font-family:"Inter",sans-serif;transition:background-color .3s ease}#year-selector .year-button:not(.active):hover{background-color:rgba(131,59,141,.3)}#year-selector .year-button:not(.active):hover.election-year::after{background:url(${A}) no-repeat center;background-size:100% auto}#year-selector .year-button::before{content:"";position:absolute;top:2px;right:-23px;width:0;height:0;border-top:10px solid rgba(0,0,0,0);border-bottom:10px solid rgba(0,0,0,0);border-right:13px solid #833b8d;opacity:0;transition:opacity .3s ease}#year-selector .year-button.active{background-color:#833b8d;color:#fff;position:relative}#year-selector .year-button.active::before{opacity:1}#year-selector .year-button.active.average-year{background-color:#5899ea}#year-selector .year-button.active.average-year::before{border-right-color:#5899ea}#year-selector .year-button.active.election-year::after{background:url(${A}) no-repeat center;background-size:100% auto}#year-selector .year-button.election-year{position:relative}#year-selector .year-button.election-year::after{content:"";position:absolute;cursor:default;bottom:-6px;left:-32px;width:25px;height:40px;background:url(${D}) no-repeat center;background-size:100% auto;transition:background-image .3s ease}#year-selector .year-button:disabled{opacity:.3;pointer-events:none}#dot-info{position:fixed;right:0;top:100px;padding:10px;background-color:hsla(0,0%,100%,.2);border-radius:5px;box-shadow:0 0 4px 0 rgba(0,0,0,.1);z-index:1000}.dot-legend{font-family:"Inter",sans-serif;font-size:12px;transition:opacity .3s,transform .2s;position:fixed;top:140px;right:20px;background:hsla(0,0%,100%,.9);border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1);z-index:1000;max-width:250px;cursor:default}.dot-legend.dragging{cursor:grabbing;user-select:none}.dot-legend-header{display:flex;justify-content:space-between;align-items:center;padding:5px 10px;border-bottom:1px solid rgba(0,0,0,.1);cursor:grab}.dot-legend-header:active{cursor:grabbing}.dot-legend-header-title{font-weight:bold}.dot-legend-content{padding:10px;overflow:auto;max-height:calc(80vh - 150px);padding-top:0}.dot-legend-size-key{font-size:12px;padding:10px 10px 0 10px;color:#231f20}.dot-legend-toggle{background:none;border:none;cursor:pointer;font-size:12px;width:auto;height:24px;border-radius:10px;display:flex;justify-content:center;align-items:center;padding:0 7px;font-family:"Inter",sans-serif;color:#ababab;margin-left:10px}.dot-legend-toggle:hover{background-color:rgba(0,0,0,.05);color:#231f20}.dot-legend-toggle:active{transform:scale(0.95)}.dot-legend.default-visibility .dot-legend-toggle .show-text,.dot-legend.visible .dot-legend-toggle .show-text{display:none}.dot-legend.default-visibility .dot-legend-toggle .hide-text,.dot-legend.visible .dot-legend-toggle .hide-text{display:block}.dot-legend.hidden .dot-legend-toggle .show-text{display:block}.dot-legend.hidden .dot-legend-toggle .hide-text{display:none}.dot-legend:hover .legend-dot.black{animation:cycle-colors 5s linear infinite}.legend-category{font-weight:bold;margin-top:8px;margin-bottom:4px;height:0;color:rgba(0,0,0,0);border-bottom:1px solid rgba(0,0,0,.1);margin-top:6px;margin-bottom:6px}.legend-item{display:flex;align-items:center;margin-bottom:4px;transition:opacity .3s;vertical-align:middle}.legend-item img{width:45px;margin:5px 10px 5px 0}.legend-item.inactive{opacity:.5}.legend-item img+.legend-label{flex:none;display:inline-block;width:70px;vertical-align:middle}.legend-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px}.legend-dot.rainbow{background:#ababab;background:linear-gradient(150deg, rgb(171, 171, 171) 10%, rgb(131, 59, 141) 26%, rgb(88, 153, 234) 54%, rgb(103, 215, 190) 80%, rgb(255, 200, 3) 90%)}.legend-dot.black{background:#333;margin-right:0;position:relative;top:1px}@keyframes cycle-colors{0%{background:#833b8d}20%{background:#ababab}40%{background:#5899ea}60%{background:#67d7be}80%{background:#ffc803}100%{background:#833b8d}}.legend-square{display:inline-block;width:10px;height:10px;margin-right:6px}.legend-label{flex:1}#chart1{position:fixed;padding-top:100px;left:0;top:0;width:100%;height:100vh;z-index:100}svg{overflow:visible;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}svg text{font-family:"p22-mackinac-pro",serif}svg text.superdot-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.image-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.sankey-label{font-size:1.5rem;font-weight:700;fill:#231f20}svg text.parties-label{font-size:1.5rem;font-weight:700;fill:#460000}svg text.donors-label{font-size:1.5rem;font-weight:700;fill:#034238}svg text.credit-label{font-size:1.5rem;font-weight:700;fill:#303085}.flow-arrowhead{fill:currentColor}.flow-path{stroke:currentColor;stroke-width:1}.flow-circle{fill:currentColor;stroke:none}.link.highlight-path{stroke-linecap:round;z-index:10}.link.animated-flow .flow-circle-1{animation:flow-animation 2s infinite;animation-delay:0s}.link.animated-flow .flow-circle-2{animation:flow-animation 2s infinite;animation-delay:.5s}.link.animated-flow .flow-circle-3{animation:flow-animation 2s infinite;animation-delay:1s}.link.animated-flow .flow-circle-4{animation:flow-animation 2s infinite;animation-delay:1.5s}.link.animated-flow-markers{marker-mid:url(#animated-flow);marker-start:url(#animated-flow);marker-end:url(#animated-flow)}.free-sankey-link:not(.static).flow-dashed{stroke-dasharray:70 10;animation:dash-animation 60s linear infinite}.free-sankey-link:not(.static).flow-dashed.reverse-flow{animation:dash-animation-reverse 60s linear infinite}.offset-arrow-path{fill:none;stroke-width:4px;stroke-linecap:butt;stroke-linejoin:round;pointer-events:none}@keyframes flow-animation{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes dash-animation{to{stroke-dashoffset:1000}}@keyframes dash-animation-reverse{to{stroke-dashoffset:-1000}}.d3-annotations .annotation-note-bg{fill:hsla(0,0%,100%,.9)}.d3-annotations .annotation-note-title{font-weight:bold;font-family:"p22-mackinac-pro",serif;font-size:1.3rem;fill:#333}.d3-annotations .annotation-note-label{font-family:"p22-mackinac-pro",serif;font-size:.9rem;fill:#555}.d3-annotations .annotation-connector path{stroke:#333;stroke-width:1.5px}.d3-annotations.show-bg .annotation-note-bg{fill:rgba(245,245,245,.9);stroke:#969696;stroke-width:1px}.d3-annotations.superdot-annotation .annotation-note-title{fill:#460000}.d3-annotations.sankey-annotation .annotation-connector path{stroke:#034238}.d3-annotations.annotation-narrow .annotation-note-content{max-width:120px}.d3-annotations.annotation-wide .annotation-note-content{max-width:300px}.d3-annotations .hidden-callout-annotation>.annotation-connector,.d3-annotations .hidden-callout-annotation>.annotation-note{display:none}.d3-annotations .hidden-circle-annotation .annotation-subject path{stroke:hsla(0,0%,100%,0)}.d3-annotations .hidden-line-annotation .annotation-connector path,.d3-annotations .title-only-annotation .annotation-connector path{stroke:hsla(0,0%,100%,0);fill:hsla(0,0%,100%,0)}.d3-annotations .title-only-annotation .annotation-note-bg{fill:hsla(0,0%,100%,0)}.d3-annotations .title-only-annotation .note-line{display:none}.d3-annotations .elite-donors-annotation .annotation-note-title{fill:#034238}.d3-annotations .elite-donors-annotation .annotation-connector path{stroke:#034238;stroke-width:2px}.d3-annotations .elite-donors-annotation .annotation-subject path{stroke:rgba(3,66,56,.5);stroke-width:4px;stroke-dasharray:5,5}.d3-annotations .blue-text .annotation-note-title{fill:#2f4bd8}.d3-annotations .green-text .annotation-note-title{fill:#008001}.d3-annotations .purple-annotation .annotation-note-bg{fill:rgba(251,220,255,.8)}.d3-annotations .gold-annotation .annotation-note-bg{fill:rgba(255,222.2619047619,105,.8)}.d3-annotations .blue-annotation .annotation-note-bg{fill:rgba(88,153,234,.3)}.d3-annotations .teal-annotation .annotation-note-bg{fill:rgba(196,245,233,.8)}.d3-annotations .green-flow-annotation .annotation-note-bg{fill:rgba(200,252,192,.7)}.d3-annotations .blue-flow-annotation .annotation-note-bg{fill:rgba(184,206,250,.7)}.d3-annotations .purple-flow-annotation .annotation-note-bg{fill:rgba(251,220,255,.7)}.d3-annotations .donors-annotation .annotation-note-bg{fill:rgba(213,235,252,.8)}.d3-annotations .other-donors-annotation .annotation-note-title{fill:#460000}.d3-annotations .other-donors-annotation .annotation-connector path{stroke:#460000;stroke-width:2px}.d3-annotations .other-donors-annotation .annotation-subject path{stroke:rgba(70,0,0,.5);stroke-width:4px;stroke-dasharray:5,5}@media(min-width: 1200px){body.short-page .scrolling-images{top:0;right:-100%;left:auto;flex-direction:column}body.short-page .invitations{margin:10px 0 0 10px;width:35%;opacity:0}body.short-page .invitations:first-child{margin-top:0}body.short-page .invitations .image{height:70px}body.short-page .invitations.zoom .image::after{content:"";transition:opacity .3s ease-in-out;opacity:0;pointer-events:none;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);width:100%;height:100%;background-color:#fff;background-size:contain;background-repeat:no-repeat;background-position:center center;border-radius:8px;border:#ffc803 solid 3px;z-index:10001;box-shadow:0 0 20px rgba(0,0,0,.2)}body.short-page .invitations.zoom .image.liberal-invite::after{background-image:url(${w})}body.short-page .invitations.zoom .image.conservative-invite::after{background-image:url(${v})}body.short-page .invitations.zoom .image.globe-article-cash-for-access::after{background-image:url(${x});background-color:#da151f}body.short-page .invitations.zoom:hover{opacity:1;transform:none;z-index:10000;background-color:rgb(255,211.130952381,54);border-color:rgb(255,211.130952381,54)}body.short-page .invitations.zoom:hover .image{height:70px}body.short-page .invitations.zoom:hover .image::after{display:block;opacity:1}body.short-page .invitations.zoom:hover .image.globe-article-cash-for-access{background-image:url(${R})}}@media(max-width: 1023px){.dot-legend{box-shadow:none;background-color:rgba(0,0,0,0);backdrop-filter:blur(6px);width:380px;max-width:40%;border:1px solid rgba(0,0,0,.1);background:hsla(0,0%,100%,.7);left:0 !important;right:auto !important;bottom:0 !important;top:auto !important;padding-bottom:45px}.dot-legend.hidden{width:130px}.dot-legend.default-visibility .dot-legend-toggle .show-text{display:block}.dot-legend.default-visibility .dot-legend-toggle .hide-text{display:none}.dot-legend .dot-legend-header{cursor:default;justify-content:unset;text-align:right;display:block}.dot-legend .dot-legend-header .dot-legend-header-title{display:inline-block;display:none}.dot-legend .dot-legend-header .dot-legend-toggle{display:inline-block;color:hsl(345,6.0606060606%,32.9411764706%)}.dot-legend .dot-legend-size-key{position:absolute;left:0;top:0}.dot-legend.default-visibility .dot-legend-content{display:none}.dot-legend .dot-legend-content{padding-top:10px}.dot-legend .dot-legend-content .legend-item{display:inline-block;margin-right:10px}.dot-legend .dot-legend-content .legend-item img{width:30px}.dot-legend .dot-legend-content .legend-item img+.legend-label{width:90px}.dot-legend .dot-legend-content .legend-item.image-type{display:inline-flex;width:130px}.dot-legend .dot-legend-content .legend-category:first-child{display:none}}body.short-page .dot-legend{box-shadow:none;background-color:rgba(0,0,0,0);backdrop-filter:blur(6px);width:380px;max-width:40%;border:1px solid rgba(0,0,0,.1);background:hsla(0,0%,100%,.7);left:0 !important;right:auto !important;bottom:0 !important;top:auto !important;padding-bottom:45px}body.short-page .dot-legend.hidden{width:130px}body.short-page .dot-legend.default-visibility .dot-legend-toggle .show-text{display:block}body.short-page .dot-legend.default-visibility .dot-legend-toggle .hide-text{display:none}body.short-page .dot-legend .dot-legend-header{cursor:default;justify-content:unset;text-align:right;display:block}body.short-page .dot-legend .dot-legend-header .dot-legend-header-title{display:inline-block;display:none}body.short-page .dot-legend .dot-legend-header .dot-legend-toggle{display:inline-block;color:hsl(345,6.0606060606%,32.9411764706%)}body.short-page .dot-legend .dot-legend-size-key{position:absolute;left:0;top:0}body.short-page .dot-legend.default-visibility .dot-legend-content{display:none}body.short-page .dot-legend .dot-legend-content{padding-top:10px}body.short-page .dot-legend .dot-legend-content .legend-item{display:inline-block;margin-right:10px}body.short-page .dot-legend .dot-legend-content .legend-item img{width:30px}body.short-page .dot-legend .dot-legend-content .legend-item img+.legend-label{width:90px}body.short-page .dot-legend .dot-legend-content .legend-item.image-type{display:inline-flex;width:130px}body.short-page .dot-legend .dot-legend-content .legend-category:first-child{display:none}@media(max-width: 767px){.dot-legend,body.short-page .dot-legend{width:100%;max-width:100%;border-radius:0;border:none;border-top:1px solid rgba(0,0,0,.1);background:hsla(0,0%,100%,.6)}}@media(max-width: 479px){body .dot-legend,body.short-page .dot-legend{background:hsla(0,0%,100%,.9);width:100%;max-width:100%;border-radius:0;border:none;border-top:1px solid rgba(0,0,0,.1)}body .dot-legend .dot-legend-content .legend-category,body.short-page .dot-legend .dot-legend-content .legend-category{display:none}body .dot-legend .dot-legend-content .legend-category.legend-category-icons,body.short-page .dot-legend .dot-legend-content .legend-category.legend-category-icons{display:block}}nav .size-indicator span{display:none;margin-left:10px}@media(max-width: 479px){nav .size-indicator span.mobile-only{display:inline-block}}@media(max-width: 767px){nav .size-indicator span.tablet-portrait-down{display:inline-block}}@media(max-width: 1023px){nav .size-indicator span.tablet-landscape-down{display:inline-block}}@media(max-width: 1199px){nav .size-indicator span.desktop-down{display:inline-block}}@media(max-width: 1399px){nav .size-indicator span.large-desktop-down{display:inline-block}}@media(max-width: 1399px){.color-wrapper{min-height:400px}.color-wrapper>div{flex:none}.color-wrapper .content-block,.color-wrapper .content-block:first-child{width:70%;margin-top:100px;margin-bottom:100px}}@media(max-width: 1199px){html{font-size:80%}.inline-voter-dot{width:8px;height:8px}h3 .inline-voter-dot{width:12px;height:12px}.color-wrapper{min-height:200px}main.side-view>.sticky-wrapper{width:40%;min-width:400px;margin-left:15px}main.side-view #chart1{width:calc(60% - 15px)}main.side-view #chart1 svg{zoom:.9}main.side-view::after{width:20%;min-width:0;left:10px}body.very-short-page main.side-view #chart1 svg{zoom:.7}body.ultra-short-page main.side-view #chart1 svg{zoom:.6}#year-selector{flex-direction:row;bottom:57px}#year-selector .year-button::before{transform:rotate(90deg) translateY(6px);right:auto;top:auto;left:50%;bottom:-18px}#year-selector .year-button.election-year::after{bottom:100%;left:50%;height:20px;transform:translateX(-50%)}}@media(max-width: 1023px){html{font-size:70%}.d3-annotations .annotation-note-label{font-size:1.5rem}.d3-annotations .annotation-note-title{font-size:2rem}main.side-view>.sticky-wrapper{width:35%;min-width:auto;margin-left:15px}main.side-view::after{width:17.5%}main.side-view #chart1{width:calc(60% - 15px)}main.side-view #chart1 svg{zoom:.8}.content-block{width:60%;padding:20px}.content-block:first-child{width:85%}.invitations{margin-top:10px}.invitations.zoom:hover{transform:scale(3) translate(30%, -15%)}.invitations.zoom:hover .image{height:100px}.invitations.zoom:hover .image.conservative-invite{height:120px}.invitations .image{height:100px}}@media(max-width: 767px){html{font-size:70%}main.side-view .color-wrapper .content-block,main.side-view .color-wrapper .content-block:first-child{width:80%}main.side-view .color-wrapper.bottom .content-block,main.side-view .color-wrapper.bottom .content-block:first-child{width:80%}main.side-view .color-wrapper.bottom .content-block h3,main.side-view .color-wrapper.bottom .content-block:first-child h3{font-size:1.5rem;font-weight:600}main.side-view .color-wrapper.bottom .content-block ul li,main.side-view .color-wrapper.bottom .content-block p,main.side-view .color-wrapper.bottom .content-block:first-child ul li,main.side-view .color-wrapper.bottom .content-block:first-child p{font-size:1.1rem}main.side-view .color-wrapper.bottom .content-block .avo-credit,main.side-view .color-wrapper.bottom .content-block:first-child .avo-credit{margin-top:40px}main.side-view>.sticky-wrapper{width:100%;margin-left:0;min-width:unset}main.side-view>.sticky-wrapper.centre{width:90%}main.side-view>.sticky-wrapper.centre .content-block{border-radius:20px;top:200px}main.side-view>.sticky-wrapper .minor-trigger{left:8px;width:40px;height:40px}main.side-view>.sticky-wrapper .content-block,main.side-view>.sticky-wrapper .content-block.centre{top:120px;width:90%;padding:13px 5%;margin:0 auto 200px;transform:translateX(0);border-radius:0}main.side-view>.sticky-wrapper .content-block.active,main.side-view>.sticky-wrapper .content-block.centre.active{transform:translateX(0)}main.side-view #chart1{width:100%;top:100px}main.side-view #chart1 svg{zoom:.6}main.side-view #chart1 svg text.superdot-label,main.side-view #chart1 svg text.donors-label{font-size:2.1rem}main.side-view::after{border-right-width:20px;width:0;min-width:0;left:0;z-index:-999}#year-selector{bottom:10px;right:10px}#year-selector .year-button{padding:2px 4px;font-size:10px}.invitations{max-width:200px}.invitations.zoom:first-child:hover{transform:scale(2) translate(30%, -15%)}.invitations.zoom:first-child:hover .image{height:200px}.invitations.zoom:last-child:hover{transform:scale(2) translate(-30%, -15%)}.invitations.zoom:last-child:hover .image{height:200px}.invitations.zoom:only-child .image.globe-article-cash-for-access{height:70px}.invitations.zoom:only-child .image.globe-article-cash-for-access+.invitation-text{display:none}.invitations.zoom:only-child:hover{transform:none}.invitations.zoom:only-child:hover .image.globe-article-cash-for-access{height:70px}.invitations .image{height:50px}}@media(max-width: 479px){html{font-size:60%}nav{padding:15px 0}#progress-bar{display:none}main.side-view .color-wrapper .content-block,main.side-view .color-wrapper .content-block:first-child{width:90%;margin-top:50px;margin-bottom:50px}main.side-view .color-wrapper .content-block h1,main.side-view .color-wrapper .content-block:first-child h1{font-size:5.3rem}main.side-view .color-wrapper .content-block h4,main.side-view .color-wrapper .content-block:first-child h4{font-size:1.3rem}main.side-view>.sticky-wrapper .content-block{top:80px}main.side-view .invitations{width:100% !important;margin:10px 0}}`,""]);const P=b},6314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);n&&a[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),o&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=o):c[2]=o),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},4417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},1601:e=>{e.exports=function(e){return e[1]}},5543:e=>{const t=e=>"string"==typeof e,o=()=>{let e,t;const o=new Promise(((o,n)=>{e=o,t=n}));return o.resolve=e,o.reject=t,o},n=e=>null==e?"":""+e,i=/###/g,r=e=>e&&e.indexOf("###")>-1?e.replace(i,"."):e,a=e=>!e||t(e),s=(e,o,n)=>{const i=t(o)?o.split("."):o;let s=0;for(;s<i.length-1;){if(a(e))return{};const t=r(i[s]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++s}return a(e)?{}:{obj:e,k:r(i[s])}},l=(e,t,o)=>{const{obj:n,k:i}=s(e,t,Object);if(void 0!==n||1===t.length)return void(n[i]=o);let r=t[t.length-1],a=t.slice(0,t.length-1),l=s(e,a,Object);for(;void 0===l.obj&&a.length;)r=`${a[a.length-1]}.${r}`,a=a.slice(0,a.length-1),l=s(e,a,Object),l?.obj&&void 0!==l.obj[`${l.k}.${r}`]&&(l.obj=void 0);l.obj[`${l.k}.${r}`]=o},d=(e,t)=>{const{obj:o,k:n}=s(e,t);if(o&&Object.prototype.hasOwnProperty.call(o,n))return o[n]},c=(e,o,n)=>{for(const i in o)"__proto__"!==i&&"constructor"!==i&&(i in e?t(e[i])||e[i]instanceof String||t(o[i])||o[i]instanceof String?n&&(e[i]=o[i]):c(e[i],o[i],n):e[i]=o[i]);return e},u=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const g=e=>t(e)?e.replace(/[&<>"'\/]/g,(e=>p[e])):e;const h=[" ",",","?","!",";"],f=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const o=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,o),this.regExpQueue.push(e),o}}(20),m=(e,t,o=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const n=t.split(o);let i=e;for(let e=0;e<n.length;){if(!i||"object"!=typeof i)return;let t,r="";for(let a=e;a<n.length;++a)if(a!==e&&(r+=o),r+=n[a],t=i[r],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<n.length-1)continue;e+=a-e+1;break}i=t}return i},y=e=>e?.replace("_","-"),O={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){}};class _{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||O,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,o,n,i){return i&&!this.debug?null:(t(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[o](e))}create(e){return new _(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new _(this.logger,e)}}var b=new _;class w{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const o=this.observers[e].get(t)||0;this.observers[e].set(t,o+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){if(this.observers[e]){Array.from(this.observers[e].entries()).forEach((([e,o])=>{for(let n=0;n<o;n++)e(...t)}))}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach((([o,n])=>{for(let i=0;i<n;i++)o.apply(o,[e,...t])}))}}}class v extends w{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,o,n,i={}){const r=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,a=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,o],n&&(Array.isArray(n)?s.push(...n):t(n)&&r?s.push(...n.split(r)):s.push(n)));const l=d(this.data,s);return!l&&!o&&!n&&e.indexOf(".")>-1&&(e=s[0],o=s[1],n=s.slice(2).join(".")),!l&&a&&t(n)?m(this.data?.[e]?.[o],n,r):l}addResource(e,t,o,n,i={silent:!1}){const r=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator;let a=[e,t];o&&(a=a.concat(r?o.split(r):o)),e.indexOf(".")>-1&&(a=e.split("."),n=t,t=a[1]),this.addNamespaces(t),l(this.data,a,n),i.silent||this.emit("added",e,t,o,n)}addResources(e,o,n,i={silent:!1}){for(const i in n)(t(n[i])||Array.isArray(n[i]))&&this.addResource(e,o,i,n[i],{silent:!0});i.silent||this.emit("added",e,o,n)}addResourceBundle(e,t,o,n,i,r={silent:!1,skipCopy:!1}){let a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),n=o,o=t,t=a[1]),this.addNamespaces(t);let s=d(this.data,a)||{};r.skipCopy||(o=JSON.parse(JSON.stringify(o))),n?c(s,o,i):s={...s,...o},l(this.data,a,s),r.silent||this.emit("added",e,t,o)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var x={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,o,n,i){return e.forEach((e=>{t=this.processors[e]?.process(t,o,n,i)??t})),t}};const S={},k=e=>!t(e)&&"boolean"!=typeof e&&"number"!=typeof e;class R extends w{constructor(e,t={}){var o,n;super(),o=e,n=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((e=>{o[e]&&(n[e]=o[e])})),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=b.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const o={...t};if(null==e)return!1;const n=this.resolve(e,o);return void 0!==n?.res}extractFromKey(e,o){let n=void 0!==o.nsSeparator?o.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const i=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let r=o.ns||this.options.defaultNS||[];const a=n&&e.indexOf(n)>-1,s=!(this.options.userDefinedKeySeparator||o.keySeparator||this.options.userDefinedNsSeparator||o.nsSeparator||((e,t,o)=>{t=t||"",o=o||"";const n=h.filter((e=>t.indexOf(e)<0&&o.indexOf(e)<0));if(0===n.length)return!0;const i=f.getRegExp(`(${n.map((e=>"?"===e?"\\?":e)).join("|")})`);let r=!i.test(e);if(!r){const t=e.indexOf(o);t>0&&!i.test(e.substring(0,t))&&(r=!0)}return r})(e,n,i));if(a&&!s){const o=e.match(this.interpolator.nestingRegexp);if(o&&o.length>0)return{key:e,namespaces:t(r)?[r]:r};const a=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(a[0])>-1)&&(r=a.shift()),e=a.join(i)}return{key:e,namespaces:t(r)?[r]:r}}translate(e,o,n){let i="object"==typeof o?{...o}:o;if("object"!=typeof i&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(i={...i}),i||(i={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const r=void 0!==i.returnDetails?i.returnDetails:this.options.returnDetails,a=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(e[e.length-1],i),d=l[l.length-1];let c=void 0!==i.nsSeparator?i.nsSeparator:this.options.nsSeparator;void 0===c&&(c=":");const u=i.lng||this.language,p=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===u?.toLowerCase())return p?r?{res:`${d}${c}${s}`,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:d,usedParams:this.getUsedParamsDetails(i)}:`${d}${c}${s}`:r?{res:s,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:d,usedParams:this.getUsedParamsDetails(i)}:s;const g=this.resolve(e,i);let h=g?.res;const f=g?.usedKey||s,m=g?.exactUsedKey||s,y=void 0!==i.joinArrays?i.joinArrays:this.options.joinArrays,O=!this.i18nFormat||this.i18nFormat.handleAsObject,_=void 0!==i.count&&!t(i.count),b=R.hasDefaultValue(i),w=_?this.pluralResolver.getSuffix(u,i.count,i):"",v=i.ordinal&&_?this.pluralResolver.getSuffix(u,i.count,{ordinal:!1}):"",x=_&&!i.ordinal&&0===i.count,S=x&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${w}`]||i[`defaultValue${v}`]||i.defaultValue;let T=h;O&&!h&&b&&(T=S);const E=k(T),N=Object.prototype.toString.apply(T);if(!(O&&T&&E&&["[object Number]","[object Function]","[object RegExp]"].indexOf(N)<0)||t(y)&&Array.isArray(T))if(O&&t(y)&&Array.isArray(h))h=h.join(y),h&&(h=this.extendTranslation(h,e,i,n));else{let t=!1,o=!1;!this.isValidLookup(h)&&b&&(t=!0,h=S),this.isValidLookup(h)||(o=!0,h=s);const r=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:h,l=b&&S!==h&&this.options.updateMissing;if(o||t||l){if(this.logger.log(l?"updateKey":"missingKey",u,d,s,l?S:h),a){const e=this.resolve(s,{...i,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let o=0;o<t.length;o++)e.push(t[o]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(i.lng||this.language):e.push(i.lng||this.language);const o=(e,t,o)=>{const n=b&&o!==h?o:r;this.options.missingKeyHandler?this.options.missingKeyHandler(e,d,t,n,l,i):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,d,t,n,l,i),this.emit("missingKey",e,d,t,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?e.forEach((e=>{const t=this.pluralResolver.getSuffixes(e,i);x&&i[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach((t=>{o([e],s+t,i[`defaultValue${t}`]||S)}))})):o(e,s,S))}h=this.extendTranslation(h,e,i,g,n),o&&h===s&&this.options.appendNamespaceToMissingKey&&(h=`${d}${c}${s}`),(o||t)&&this.options.parseMissingKeyHandler&&(h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}${c}${s}`:s,t?h:void 0,i))}else{if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,T,{...i,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return r?(g.res=e,g.usedParams=this.getUsedParamsDetails(i),g):e}if(a){const e=Array.isArray(T),t=e?[]:{},o=e?m:f;for(const e in T)if(Object.prototype.hasOwnProperty.call(T,e)){const n=`${o}${a}${e}`;t[e]=b&&!h?this.translate(n,{...i,defaultValue:k(S)?S[e]:void 0,joinArrays:!1,ns:l}):this.translate(n,{...i,joinArrays:!1,ns:l}),t[e]===n&&(t[e]=T[e])}h=t}}return r?(g.res=h,g.usedParams=this.getUsedParamsDetails(i),g):h}extendTranslation(e,o,n,i,r){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const a=t(e)&&(void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let s;if(a){const t=e.match(this.interpolator.nestingRegexp);s=t&&t.length}let l=n.replace&&!t(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,n.lng||this.language||i.usedLng,n),a){const t=e.match(this.interpolator.nestingRegexp);s<(t&&t.length)&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,((...e)=>r?.[0]!==e[0]||n.context?this.translate(...e,o):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${o[0]}`),null)),n)),n.interpolation&&this.interpolator.reset()}const a=n.postProcess||this.options.postProcess,s=t(a)?[a]:a;return null!=e&&s?.length&&!1!==n.applyPostProcessor&&(e=x.handle(s,e,o,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,o={}){let n,i,r,a,s;return t(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(n))return;const l=this.extractFromKey(e,o),d=l.key;i=d;let c=l.namespaces;this.options.fallbackNS&&(c=c.concat(this.options.fallbackNS));const u=void 0!==o.count&&!t(o.count),p=u&&!o.ordinal&&0===o.count,g=void 0!==o.context&&(t(o.context)||"number"==typeof o.context)&&""!==o.context,h=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);c.forEach((e=>{this.isValidLookup(n)||(s=e,S[`${h[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(s)||(S[`${h[0]}-${e}`]=!0,this.logger.warn(`key "${i}" for languages "${h.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),h.forEach((t=>{if(this.isValidLookup(n))return;a=t;const i=[d];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(i,d,t,e,o);else{let e;u&&(e=this.pluralResolver.getSuffix(t,o.count,o));const n=`${this.options.pluralSeparator}zero`,r=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(u&&(i.push(d+e),o.ordinal&&0===e.indexOf(r)&&i.push(d+e.replace(r,this.options.pluralSeparator)),p&&i.push(d+n)),g){const t=`${d}${this.options.contextSeparator}${o.context}`;i.push(t),u&&(i.push(t+e),o.ordinal&&0===e.indexOf(r)&&i.push(t+e.replace(r,this.options.pluralSeparator)),p&&i.push(t+n))}}let s;for(;s=i.pop();)this.isValidLookup(n)||(r=s,n=this.getResource(t,e,s,o))})))}))})),{res:n,usedKey:i,exactUsedKey:r,usedLng:a,usedNS:s}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,o,n={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,o,n):this.resourceStore.getResource(e,t,o,n)}getUsedParamsDetails(e={}){const o=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!t(e.replace);let i=n?e.replace:e;if(n&&void 0!==e.count&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(const e of o)delete i[e]}return i}static hasDefaultValue(e){const t="defaultValue";for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t===o.substring(0,12)&&void 0!==e[o])return!0;return!1}}class T{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=b.create("languageUtils")}getScriptPartFromCode(e){if(!(e=y(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=y(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(t(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const o=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(o)||(t=o)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const o=this.getScriptPartFromCode(e);if(this.isSupportedCode(o))return t=o;const n=this.getLanguagePartFromCode(e);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find((e=>e===n?e:e.indexOf("-")<0&&n.indexOf("-")<0?void 0:e.indexOf("-")>0&&n.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===n||0===e.indexOf(n)&&n.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,o){if(!e)return[];if("function"==typeof e&&(e=e(o)),t(e)&&(e=[e]),Array.isArray(e))return e;if(!o)return e.default||[];let n=e[o];return n||(n=e[this.getScriptPartFromCode(o)]),n||(n=e[this.formatLanguageCode(o)]),n||(n=e[this.getLanguagePartFromCode(o)]),n||(n=e.default),n||[]}toResolveHierarchy(e,o){const n=this.getFallbackCodes((!1===o?[]:o)||this.options.fallbackLng||[],e),i=[],r=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return t(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&r(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&r(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&r(this.getLanguagePartFromCode(e))):t(e)&&r(this.formatLanguageCode(e)),n.forEach((e=>{i.indexOf(e)<0&&r(this.formatLanguageCode(e))})),i}}const E={zero:0,one:1,two:2,few:3,many:4,other:5},N={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class A{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=b.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const o=y("dev"===e?"en":e),n=t.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:o,type:n});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let r;try{r=new Intl.PluralRules(o,{type:n})}catch(o){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),N;if(!e.match(/-|_/))return N;const n=this.languageUtils.getLanguagePartFromCode(e);r=this.getRule(n,t)}return this.pluralRulesCache[i]=r,r}needsPlural(e,t={}){let o=this.getRule(e,t);return o||(o=this.getRule("dev",t)),o?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,o={}){return this.getSuffixes(e,o).map((e=>`${t}${e}`))}getSuffixes(e,t={}){let o=this.getRule(e,t);return o||(o=this.getRule("dev",t)),o?o.resolvedOptions().pluralCategories.sort(((e,t)=>E[e]-E[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):[]}getSuffix(e,t,o={}){const n=this.getRule(e,o);return n?`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,o))}}const D=(e,o,n,i=".",r=!0)=>{let a=((e,t,o)=>{const n=d(e,o);return void 0!==n?n:d(t,o)})(e,o,n);return!a&&r&&t(n)&&(a=m(e,n,i),void 0===a&&(a=m(o,n,i))),a},P=e=>e.replace(/\$/g,"$$$$");class C{constructor(e={}){this.logger=b.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:o,useRawValueToEscape:n,prefix:i,prefixEscaped:r,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:d,unescapePrefix:c,nestingPrefix:p,nestingPrefixEscaped:h,nestingSuffix:f,nestingSuffixEscaped:m,nestingOptionsSeparator:y,maxReplaces:O,alwaysFormat:_}=e.interpolation;this.escape=void 0!==t?t:g,this.escapeValue=void 0===o||o,this.useRawValueToEscape=void 0!==n&&n,this.prefix=i?u(i):r||"{{",this.suffix=a?u(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=d?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?u(p):h||u("$t("),this.nestingSuffix=f?u(f):m||u(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=O||1e3,this.alwaysFormat=void 0!==_&&_,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,o,i,r){let a,s,l;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=e=>{if(e.indexOf(this.formatSeparator)<0){const t=D(o,d,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(t,void 0,i,{...r,...o,interpolationkey:e}):t}const t=e.split(this.formatSeparator),n=t.shift().trim(),a=t.join(this.formatSeparator).trim();return this.format(D(o,d,n,this.options.keySeparator,this.options.ignoreJSONStructure),a,i,{...r,...o,interpolationkey:n})};this.resetRegExp();const u=r?.missingInterpolationHandler||this.options.missingInterpolationHandler,p=void 0!==r?.interpolation?.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>P(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?P(this.escape(e)):P(e)}].forEach((o=>{for(l=0;a=o.regex.exec(e);){const i=a[1].trim();if(s=c(i),void 0===s)if("function"==typeof u){const o=u(e,a,r);s=t(o)?o:""}else if(r&&Object.prototype.hasOwnProperty.call(r,i))s="";else{if(p){s=a[0];continue}this.logger.warn(`missed to pass in variable ${i} for interpolating ${e}`),s=""}else t(s)||this.useRawValueToEscape||(s=n(s));const d=o.safeValue(s);if(e=e.replace(a[0],d),p?(o.regex.lastIndex+=s.length,o.regex.lastIndex-=a[0].length):o.regex.lastIndex=0,l++,l>=this.maxReplaces)break}})),e}nest(e,o,i={}){let r,a,s;const l=(e,t)=>{const o=this.nestingOptionsSeparator;if(e.indexOf(o)<0)return e;const n=e.split(new RegExp(`${o}[ ]*{`));let i=`{${n[1]}`;e=n[0],i=this.interpolate(i,s);const r=i.match(/'/g),a=i.match(/"/g);((r?.length??0)%2==0&&!a||a.length%2!=0)&&(i=i.replace(/'/g,'"'));try{s=JSON.parse(i),t&&(s={...t,...s})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${o}${i}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,e};for(;r=this.nestingRegexp.exec(e);){let d=[];s={...i},s=s.replace&&!t(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let c=!1;if(-1!==r[0].indexOf(this.formatSeparator)&&!/{.*}/.test(r[1])){const e=r[1].split(this.formatSeparator).map((e=>e.trim()));r[1]=e.shift(),d=e,c=!0}if(a=o(l.call(this,r[1].trim(),s),s),a&&r[0]===e&&!t(a))return a;t(a)||(a=n(a)),a||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),a=""),c&&(a=d.reduce(((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:r[1].trim()})),a.trim())),e=e.replace(r[0],a),this.regexp.lastIndex=0}return e}}const L=e=>{const t={};return(o,n,i)=>{let r=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(r={...r,[i.interpolationkey]:void 0});const a=n+JSON.stringify(r);let s=t[a];return s||(s=e(y(n),i),t[a]=s),s(o)}},G=e=>(t,o,n)=>e(y(o),n)(t);class V{constructor(e={}){this.logger=b.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const o=t.cacheInBuiltFormats?L:G;this.formats={number:o(((e,t)=>{const o=new Intl.NumberFormat(e,{...t});return e=>o.format(e)})),currency:o(((e,t)=>{const o=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>o.format(e)})),datetime:o(((e,t)=>{const o=new Intl.DateTimeFormat(e,{...t});return e=>o.format(e)})),relativetime:o(((e,t)=>{const o=new Intl.RelativeTimeFormat(e,{...t});return e=>o.format(e,t.range||"day")})),list:o(((e,t)=>{const o=new Intl.ListFormat(e,{...t});return e=>o.format(e)}))}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=L(t)}format(e,t,o,n={}){const i=t.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find((e=>e.indexOf(")")>-1))){const e=i.findIndex((e=>e.indexOf(")")>-1));i[0]=[i[0],...i.splice(1,e)].join(this.formatSeparator)}return i.reduce(((e,t)=>{const{formatName:i,formatOptions:r}=(e=>{let t=e.toLowerCase().trim();const o={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const i=n[1].substring(0,n[1].length-1);"currency"===t&&i.indexOf(":")<0?o.currency||(o.currency=i.trim()):"relativetime"===t&&i.indexOf(":")<0?o.range||(o.range=i.trim()):i.split(";").forEach((e=>{if(e){const[t,...n]=e.split(":"),i=n.join(":").trim().replace(/^'+|'+$/g,""),r=t.trim();o[r]||(o[r]=i),"false"===i&&(o[r]=!1),"true"===i&&(o[r]=!0),isNaN(i)||(o[r]=parseInt(i,10))}}))}return{formatName:t,formatOptions:o}})(t);if(this.formats[i]){let t=e;try{const a=n?.formatParams?.[n.interpolationkey]||{},s=a.locale||a.lng||n.locale||n.lng||o;t=this.formats[i](e,s,{...r,...n,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${i}`),e}),e)}}class I extends w{constructor(e,t,o,n={}){super(),this.backend=e,this.store=t,this.services=o,this.languageUtils=o.languageUtils,this.options=n,this.logger=b.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(o,n.backend,n)}queueLoad(e,t,o,n){const i={},r={},a={},s={};return e.forEach((e=>{let n=!0;t.forEach((t=>{const a=`${e}|${t}`;!o.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===r[a]&&(r[a]=!0):(this.state[a]=1,n=!1,void 0===r[a]&&(r[a]=!0),void 0===i[a]&&(i[a]=!0),void 0===s[t]&&(s[t]=!0)))})),n||(a[e]=!0)})),(Object.keys(i).length||Object.keys(r).length)&&this.queue.push({pending:r,pendingCount:Object.keys(r).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(i),pending:Object.keys(r),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(e,t,o){const n=e.split("|"),i=n[0],r=n[1];t&&this.emit("failedLoading",i,r,t),!t&&o&&this.store.addResourceBundle(i,r,o,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&o&&(this.state[e]=0);const a={};this.queue.forEach((o=>{((e,t,o)=>{const{obj:n,k:i}=s(e,t,Object);n[i]=n[i]||[],n[i].push(o)})(o.loaded,[i],r),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(o,e),t&&o.errors.push(t),0!==o.pendingCount||o.done||(Object.keys(o.loaded).forEach((e=>{a[e]||(a[e]={});const t=o.loaded[e];t.length&&t.forEach((t=>{void 0===a[e][t]&&(a[e][t]=!0)}))})),o.done=!0,o.errors.length?o.callback(o.errors):o.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((e=>!e.done))}read(e,t,o,n=0,i=this.retryTimeout,r){if(!e.length)return r(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:o,tried:n,wait:i,callback:r});this.readingCalls++;const a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&s&&n<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,o,n+1,2*i,r)}),i):r(a,s)},s=this.backend[o].bind(this.backend);if(2!==s.length)return s(e,t,a);try{const o=s(e,t);o&&"function"==typeof o.then?o.then((e=>a(null,e))).catch(a):a(null,o)}catch(e){a(e)}}prepareLoading(e,o,n={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();t(e)&&(e=this.languageUtils.toResolveHierarchy(e)),t(o)&&(o=[o]);const r=this.queueLoad(e,o,n,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,o){this.prepareLoading(e,t,{},o)}reload(e,t,o){this.prepareLoading(e,t,{reload:!0},o)}loadOne(e,t=""){const o=e.split("|"),n=o[0],i=o[1];this.read(n,i,"read",void 0,void 0,((o,r)=>{o&&this.logger.warn(`${t}loading namespace ${i} for language ${n} failed`,o),!o&&r&&this.logger.log(`${t}loaded namespace ${i} for language ${n}`,r),this.loaded(e,o,r)}))}saveMissing(e,t,o,n,i,r={},a=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=o&&""!==o){if(this.backend?.create){const s={...r,isUpdate:i},l=this.backend.create.bind(this.backend);if(l.length<6)try{let i;i=5===l.length?l(e,t,o,n,s):l(e,t,o,n),i&&"function"==typeof i.then?i.then((e=>a(null,e))).catch(a):a(null,i)}catch(e){a(e)}else l(e,t,o,n,a,s)}e&&e[0]&&this.store.addResource(e[0],t,o,n)}}else this.logger.warn(`did not save key "${o}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const F=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let o={};if("object"==typeof e[1]&&(o=e[1]),t(e[1])&&(o.defaultValue=e[1]),t(e[2])&&(o.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const t=e[3]||e[2];Object.keys(t).forEach((e=>{o[e]=t[e]}))}return o},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),U=e=>(t(e.ns)&&(e.ns=[e.ns]),t(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),t(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),$=()=>{};class M extends w{constructor(e={},t){var o;if(super(),this.options=U(e),this.services={},this.logger=b,this.modules={external:[]},o=this,Object.getOwnPropertyNames(Object.getPrototypeOf(o)).forEach((e=>{"function"==typeof o[e]&&(o[e]=o[e].bind(o))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(e={},n){this.isInitializing=!0,"function"==typeof e&&(n=e,e={}),null==e.defaultNS&&e.ns&&(t(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=F();this.options={...i,...this.options,...U(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?b.init(r(this.modules.logger),this.options):b.init(null,this.options),e=this.modules.formatter?this.modules.formatter:V;const t=new T(this.options);this.store=new v(this.options.resources,this.options);const o=this.services;o.logger=b,o.resourceStore=this.store,o.languageUtils=t,o.pluralResolver=new A(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(o.formatter=r(e),o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new C(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new I(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new R(this.services,this.options),this.translator.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,n||(n=$),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=(...t)=>this.store[e](...t)}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=(...t)=>(this.store[e](...t),this)}));const a=o(),s=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(t),n(e,t)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),a}loadResources(e,o=$){let n=o;const i=t(e)?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===i?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return n();const e=[],t=t=>{if(!t)return;if("cimode"===t)return;this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};if(i)t(i);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>t(e)))}this.options.preload?.forEach?.((e=>t(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),n(e)}))}else n(null)}reloadResources(e,t,n){const i=o();return"function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=$),this.services.backendConnector.reload(e,t,(e=>{i.resolve(),n(e)})),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&x.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const i=o();this.emit("languageChanging",e);const r=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},a=(t,o)=>{o?this.isLanguageChangingTo===e&&(r(o),this.translator.changeLanguage(o),this.isLanguageChangingTo=void 0,this.emit("languageChanged",o),this.logger.log("languageChanged",o)):this.isLanguageChangingTo=void 0,i.resolve(((...e)=>this.t(...e))),n&&n(t,((...e)=>this.t(...e)))},s=o=>{e||o||!this.services.languageDetector||(o=[]);const n=t(o)?o:o&&o[0],i=this.store.hasLanguageSomeTranslations(n)?n:this.services.languageUtils.getBestMatchFromCodes(t(o)?[o]:o);i&&(this.language||r(i),this.translator.language||this.translator.changeLanguage(i),this.services.languageDetector?.cacheUserLanguage?.(i)),this.loadResources(i,(e=>{a(e,i)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),i}getFixedT(e,o,n){const i=(e,t,...o)=>{let r;r="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(o)):{...t},r.lng=r.lng||i.lng,r.lngs=r.lngs||i.lngs,r.ns=r.ns||i.ns,""!==r.keyPrefix&&(r.keyPrefix=r.keyPrefix||n||i.keyPrefix);const a=this.options.keySeparator||".";let s;return s=r.keyPrefix&&Array.isArray(e)?e.map((e=>`${r.keyPrefix}${a}${e}`)):r.keyPrefix?`${r.keyPrefix}${a}${e}`:e,this.t(s,r)};return t(e)?i.lng=e:i.lngs=e,i.ns=o,i.keyPrefix=n,i}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const o=t.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;const r=(e,t)=>{const o=this.services.backendConnector.state[`${e}|${t}`];return-1===o||0===o||2===o};if(t.precheck){const e=t.precheck(this,r);if(void 0!==e)return e}return!!this.hasResourceBundle(o,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!r(o,e)||n&&!r(i,e)))}loadNamespaces(e,n){const i=o();return this.options.ns?(t(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{i.resolve(),n&&n(e)})),i):(n&&n(),Promise.resolve())}loadLanguages(e,n){const i=o();t(e)&&(e=[e]);const r=this.options.preload||[],a=e.filter((e=>r.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return a.length?(this.options.preload=r.concat(a),this.loadResources((e=>{i.resolve(),n&&n(e)})),i):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services?.languageUtils||new T(F());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new M(e,t)}cloneInstance(e={},t=$){const o=e.forkResourceStore;o&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},i=new M(n);void 0===e.debug&&void 0===e.prefix||(i.logger=i.logger.clone(e));if(["store","services","language"].forEach((e=>{i[e]=this[e]})),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},o){const e=Object.keys(this.store.data).reduce(((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce(((o,n)=>(o[n]={...e[t][n]},o)),e[t]),e)),{});i.store=new v(e,n),i.services.resourceStore=i.store}return i.translator=new R(i.services,n),i.translator.on("*",((e,...t)=>{i.emit(e,...t)})),i.init(n,t),i.translator.options=n,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const z=M.createInstance();z.createInstance=M.createInstance,e.exports=z},4376:(e,t,o)=>{o.r(t),o.d(t,{default:()=>y});var n=o(5072),i=o.n(n),r=o(7825),a=o.n(r),s=o(7659),l=o.n(s),d=o(5056),c=o.n(d),u=o(540),p=o.n(u),g=o(1113),h=o.n(g),f=o(8011),m={};m.styleTagTransform=h(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=p();i()(f.A,m);const y=f.A&&f.A.locals?f.A.locals:void 0},5072:e=>{var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var r={},a=[],s=0;s<e.length;s++){var l=e[s],d=n.base?l[0]+n.base:l[0],c=r[d]||0,u="".concat(d," ").concat(c);r[d]=c+1;var p=o(u),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(g);else{var h=i(g,n);n.byIndex=s,t.splice(s,0,{identifier:u,updater:h,references:1})}a.push(u)}return a}function i(e,t){var o=t.domAPI(t);o.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,i){var r=n(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<r.length;a++){var s=o(r[a]);t[s].references--}for(var l=n(e,i),d=0;d<r.length;d++){var c=o(r[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=l}}},7659:e=>{var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},5056:(e,t,o)=>{e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var i=void 0!==o.layer;i&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,i&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var r=o.sourceMap;r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},1113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},7734:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveAnnotationsIntoSVGFrame=m,t.renderSvgAnnotations=_,t.updateSvgAnnotationPositions=function(){if(!f||0===h.length)return;const e=y(h),t=n.annotation();t.notePadding(10),e.forEach(((e,t)=>{h[t]&&h[t].note.wrap&&(e.wrap=h[t].note.wrap)})),t.annotations(e),t.textWrap(120),f&&(f.call(t),g(f),m())},t.updateSvgAnnotationText=b;const n=window.d3,i=(window.d3.annotation,o(3569)),r=o(6185),a=o(4003),s=o(1613),l=o(6921),d=o(2636),c=o(2160),u=o(1114),p=o(6965);function g(e){e.selectAll(".annotation-note-bg").attr("fill-opacity",1).attr("rx",4)}let h=[],f=null;function m(){if(!i.state.svg)return;const e=i.state.svg.node()?.getBoundingClientRect();if(!e)return;const t=f?.selectAll(".annotation");t&&t.each((function(){const t=n.select(this),o=t.select(".annotation-note").node(),r=o?.getBoundingClientRect(),a=r?.top-e.top,s=e.bottom-r?.bottom,l=r?.left-e.left,d=e.right-r?.right,c=t.attr("id"),u=h.find((e=>e.id===c));if(!u)return;const p=parseFloat(getComputedStyle(i.state?.svg?.node()).zoom);let g=!1;a<0&&(u.fixedPosition.y-=a/p,g=!0),s<0&&(u.fixedPosition.y+=s/p,g=!0),l<0&&(u.fixedPosition.x-=l/p,g=!0),d<0&&(u.fixedPosition.x+=d/p,g=!0)}))}function y(e){return e.map((e=>{const t=function(e){let t={x:0,y:0},o={left:0,right:0,top:0,bottom:0},n={start:{x:0,y:0},end:{x:0,y:0}},l={x:0,y:0};if((0,r.isDotData)(e.target)&&!(0,c.isSuperdot)(e.target))t={x:e.target.x||0,y:e.target.y||0},o={left:t.x-i.state.dotRadius,right:t.x+i.state.dotRadius,top:t.y-i.state.dotRadius,bottom:t.y+i.state.dotRadius};else if((0,c.isSuperdot)(e.target))t={x:e.target.x||0,y:e.target.y||0},o={left:t.x-e.target.radius,right:t.x+e.target.radius,top:t.y-e.target.radius,bottom:t.y+e.target.radius};else if(e.target instanceof d.SimImage){const n=e.target.position;t={x:n.x,y:n.y},o={left:t.x-e.target.size.width/2,right:t.x+e.target.size.width/2,top:t.y-e.target.size.height/2,bottom:t.y+e.target.size.height/2}}else e.target instanceof a.Sankey?(t=e.target.getJunctionCenter(),n=e.target.getEndpointPositions()):e.target instanceof p.FreeSankey?(t=e.target.getJunctionPoint()||{x:0,y:0},n={start:e.target.getAverageSourcePoint(),end:e.target.getDestinationPoint()}):e.target instanceof s.VoterGroup?t=(0,u.calculateGroupCenters)([e.target]).get(e.target):(t=e.target,o={left:t.x,right:t.x,top:t.y,bottom:t.y});if(e.target instanceof a.Sankey)if("start"===e.targetAnchorLink)l=n.start;else if("end"===e.targetAnchorLink)l=n.end;else if("superdot-link"===e.targetAnchorLink&&e.targetFlowGroup){const t=e.targetFlowRatio||.5,o="string"==typeof e.targetFlowGroup?e.targetFlowGroup:e.targetFlowGroup.id;l=e.target.getPositionFromSuperdotToJunction(o,t)}else l=t;else if(e.target instanceof p.FreeSankey)if("superdot-link"===e.targetAnchorLink){const t=e.targetFlowRatio||.5;if(e.targetFlowGroup){if("string"==typeof e.targetFlowGroup)throw new Error("Flow group ID must be a VoterGroup for FreeSankey annotations");const o=(0,c.getSuperdotByGroup)(e.targetFlowGroup);if(!o)throw new Error("Superdot not found for flow group");const n=e.target.linkForDot(o);if(!n)throw new Error("Link not found for superdot");l=n.positionAlongLink(t)}else l={x:(n.start.x+n.end.x)/2,y:(n.start.y+n.end.y)/2}}else l="start"===e.targetAnchorLink?n.start:"end"===e.targetAnchorLink?n.end:t;else"left"===e.targetAnchorX?l.x=o.left:"right"===e.targetAnchorX?l.x=o.right:l.x=t.x,"top"===e.targetAnchorY?l.y=o.top:"bottom"===e.targetAnchorY?l.y=o.bottom:l.y=t.y;return{x:l.x+(e.targetOffset?.x||0),y:l.y+(e.targetOffset?.y||0)}}(e),o={...e.note};"function"==typeof o.title&&(o.title=o.title()),"function"==typeof o.label&&(o.label=o.label());const n={id:e.id||`annotation-${Math.random().toString(36).substr(2,9)}`,note:o,className:e.className||"",type:O(e.type),connector:e.connector||{}};if(e.fixedPosition?(n.x=t.x,n.y=t.y,n.dx=e.fixedPosition.x-t.x,n.dy=e.fixedPosition.y-t.y):(n.x=t.x,n.y=t.y,n.dx=e.dx||0,n.dy=e.dy||0),e.subject)if("calloutCircle"===e.type)if((0,c.isSuperdot)(e.target))n.subject={...e.subject,radius:e.target.radius};else if((0,r.isDotData)(e.target)||e.target instanceof s.VoterGroup||"object"==typeof e.target&&"x"in e.target&&"y"in e.target)if(e.subject.radius)n.subject=e.subject;else{const o=t.x,r=t.y;let a=0;if(e.subject.includeElements&&e.subject.includeElements.length>0)e.subject.includeElements.forEach((e=>{if("string"==typeof e){const t=Object.values(l.VOTER_GROUPS).find((t=>t.id===e));if(t)i.state.displayData.forEach((e=>{if(void 0!==e.x&&void 0!==e.y&&t.shouldIncludeDot(e)){const t=e.x-o,n=e.y-r,s=Math.sqrt(t*t+n*n)+i.state.dotRadius;a=Math.max(a,s)}}));else{const t=i.state.superdots.find((t=>t.id===e));if(t){const e=t.x-o,n=t.y-r,i=Math.sqrt(e*e+n*n)+t.radius;a=Math.max(a,i)}else{const t=Object.values(i.state.images).find((t=>t.id===e));if(t){const e=t.position.x,n=t.position.y,i=e-o,s=n-r,l=Math.sqrt(i*i+s*s)+Math.max(t.size.width,t.size.height)/2;a=Math.max(a,l)}}}}else if(e instanceof s.VoterGroup)i.state.displayData.forEach((t=>{if(void 0!==t.x&&void 0!==t.y&&e.shouldIncludeDot(t)){const e=t.x-o,n=t.y-r,s=Math.sqrt(e*e+n*n)+i.state.dotRadius;a=Math.max(a,s)}}));else if(e instanceof d.SimImage){const t=e.position.x,n=e.position.y,i=t-o,s=n-r,l=Math.sqrt(i*i+s*s)+Math.max(e.size.width,e.size.height)/2;a=Math.max(a,l)}else if("x"in e&&"y"in e){const t=e.x-o,n=e.y-r,i=Math.sqrt(t*t+n*n);a=Math.max(a,i)}}));else{const e=150;i.state.displayData.forEach((t=>{if(void 0!==t.x&&void 0!==t.y){const n=t.x-o,s=t.y-r,l=Math.sqrt(n*n+s*s)+i.state.dotRadius;l<e&&(a=Math.max(a,l))}}))}const c=e.subject.radiusPadding||15,u=60,p=Math.max(a,u)+c;n.subject={...e.subject,radius:p}}else n.subject=e.subject;else n.subject=e.subject;return n}))}function O(e){switch(e){case"label":default:return n.annotationLabel;case"callout":return n.annotationCallout;case"calloutCircle":return n.annotationCalloutCircle;case"calloutRect":return n.annotationCalloutRect;case"threshold":return n.annotationXYThreshold}}function _(e,t=!0){if(!i.state.svg)return;f&&f.remove(),f=i.state.svg.append("g").attr("class","d3-annotations");const o=[];if(e.svgAnnotations&&o.push(...e.svgAnnotations),e.clumps.forEach((t=>{if(t.svgAnnotations){const n=t.svgAnnotations.map((o=>{let n;if(t.superdot){const e=i.state.superdots.find((e=>(0,r.sameTypesInClumps)(t,e.viewClump)));n=e||{x:0,y:0}}else n=t.group;return{...o,target:n,id:o.id||`annotation-${t.group.id}-${e.id}}`}}));o.push(...n)}})),e.sankeyGroups&&e.sankeyGroups.forEach((t=>{if(t.svgAnnotations){const n=t.svgAnnotations.map((o=>({...o,target:t.sankey,id:o.id||`annotation-${t.sankey.id}-${e.id}`})));o.push(...n)}})),e.freeSankeyGroups&&e.freeSankeyGroups.forEach((t=>{if(t.svgAnnotations){const n=t.svgAnnotations.map((o=>({...o,target:t.freeSankey,id:o.id||`annotation-${t.freeSankey.id}-${e.id}`})));o.push(...n)}})),e.images&&e.images.forEach((t=>{if(t.svgAnnotations){const n=t.svgAnnotations.map((o=>({...o,target:t.image,id:o.id||`annotation-${t.image.id}--${e.id}`})));o.push(...n)}})),h=o,0===o.length)return;const a=y(o),s=n.annotation();s.notePadding(10),a.forEach(((e,t)=>{o[t]&&o[t].note.wrap&&(e.wrap=o[t].note.wrap)})),s.annotations(a),s.textWrap(120),f&&(f.call(s),g(f),function(e,t){e.selectAll(".annotation-note-bg").attr("stroke",t??"black")}(f,"black"),f.selectAll(".annotation").each((function(e,t){n.select(this).attr("id",a[t].id)}))),t&&f.selectAll(".annotations > .annotation").attr("opacity",0).transition().duration(500).attr("opacity",1)}function b(){if(0===h.length)return;h.some((e=>"function"==typeof e.note.title||"function"==typeof e.note.label))&&i.state.view&&_(i.state.view)}window.updateSvgAnnotationText=b},6921:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_RING_RADIUS=t.RING_SPACING=t.MIN_RING_SIZE=t.CURSOR_NODE_DATA=t.VOTER_GROUPS=t.VOTER_TYPES=t.VOTER_TYPE_KEYS=t.flowColors=t.typeColors=t.targetColumn=t.DEFAULT_LINK_THICKNESS=t.MONEY_SCALE=t.COLLIDE_DISTANCE_MULT=t.MOUSE_CHARGE_STRENGTH=t.DOT_CHARGE_STRENGTH=t.GROUPED_FORCE_STRENGTH=t.RADIAL_STRENGTH=t.smallDotRadius=t.largeDotRadius=void 0,t.createVoterGroups=function(){Object.keys(t.VOTER_TYPES).forEach((e=>{t.VOTER_GROUPS[e]=n.VoterGroup.fromType(t.VOTER_TYPES[e])})),t.VOTER_GROUPS.NON_DONATING_VOTERS=n.VoterGroup.fromGroups([t.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,t.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING,t.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Non-donating voters","Non-donating voters"),t.VOTER_GROUPS.NON_DONATING_WITH_REFORM=n.VoterGroup.fromGroups([t.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,t.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Non-donating voters with reform","Non-donating voters with reform"),t.VOTER_GROUPS.ABOVE_TAX_THRESHOLD=n.VoterGroup.fromGroups([t.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,t.VOTER_GROUPS.REMAINING_NON_DONATING_VOTERS,t.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING],"Above the tax threshold","Above the tax threshold"),t.VOTER_GROUPS.BELOW_TAX_THRESHOLD=n.VoterGroup.fromGroups([t.VOTER_GROUPS.NON_DONATING_BELOW_TAX_THRESHOLD],"Below the tax threshold","Below the tax threshold"),t.VOTER_GROUPS.DONORS_1_999=new n.VoterGroup([t.VOTER_TYPES.DONORS_1_199,t.VOTER_TYPES.DONORS_200_499,t.VOTER_TYPES.DONORS_500_999],"Donors $1-999","Donors $1-999"),t.VOTER_GROUPS.ALL_DONORS=n.VoterGroup.fromGroups([t.VOTER_GROUPS.DONORS_1_999,t.VOTER_GROUPS.DONORS_OVER_1000],"All Donors","All Donors"),t.VOTER_GROUPS.ALL_VOTERS=n.VoterGroup.fromGroups([t.VOTER_GROUPS.ALL_DONORS,t.VOTER_GROUPS.NON_DONATING_VOTERS],"All Voters","All Voters"),t.VOTER_GROUPS.ALL_ELIGIBLE=n.VoterGroup.fromGroups([t.VOTER_GROUPS.NON_DONATING_VOTERS,t.VOTER_GROUPS.ELIGIBLE_NON_VOTERS],"All Eligible","All Eligible"),t.VOTER_GROUPS.EVERYONE=n.VoterGroup.fromGroups([t.VOTER_GROUPS.ALL_VOTERS,t.VOTER_GROUPS.ELIGIBLE_NON_VOTERS],"Everyone","Everyone"),t.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM=n.VoterGroup.fromGroups([t.VOTER_GROUPS.DONORS_1_999,t.VOTER_GROUPS.DONORS_OVER_1000,t.VOTER_GROUPS.NON_DONATING_NEEDED_FOR_FUNDING],"All donors after reform","All donors after reform")};const n=o(1613);t.largeDotRadius=5,t.smallDotRadius=2,t.RADIAL_STRENGTH=.3,t.GROUPED_FORCE_STRENGTH=.1,t.DOT_CHARGE_STRENGTH=-.75,t.MOUSE_CHARGE_STRENGTH=-50,t.COLLIDE_DISTANCE_MULT=1.2,t.MONEY_SCALE=7e5,t.DEFAULT_LINK_THICKNESS=10,t.targetColumn="Average 2016-2022 Dots",t.typeColors={grey:"#ABABAB",purple:"#833B8D",gold:"#FFC803",cyan:"#67D7BE",teal:"#64C1CD",blue:"#5899EA",greal:"#63C1CD"},t.flowColors={blue:"rgba(0, 106, 255, 0.3)",green:"rgba(0, 255, 30, 0.3)",greenStronger:"rgba(0, 255, 30, 0.6)",greenLight:"rgba(0, 255, 100, 0.3)",purple:"rgba(214, 93, 230, 0.3)"},t.VOTER_TYPE_KEYS={"Eligible non-voters":"ELIGIBLE_NON_VOTERS","Remaining Non-donating voters":"REMAINING_NON_DONATING_VOTERS","Donors >$1000":"DONORS_OVER_1000","Donors $500-999":"DONORS_500_999","Donors $200-499":"DONORS_200_499","Donors $1-199":"DONORS_1_199","Non-donating voters below tax threshold":"NON_DONATING_BELOW_TAX_THRESHOLD","Non-donating voters needed for new funding goals":"NON_DONATING_NEEDED_FOR_FUNDING"},t.VOTER_TYPES={ELIGIBLE_NON_VOTERS:new n.VoterType("Eligible non-voters","Eligible voters who don't vote","#ABABAB"),REMAINING_NON_DONATING_VOTERS:new n.VoterType("Remaining Non-donating voters","Non-donating voters","#833B8D"),DONORS_OVER_1000:new n.VoterType("Donors >$1000","Huge Donors (>$1000)","#FFC803"),DONORS_500_999:new n.VoterType("Donors $500-999","Large Donors ($500-$999)","#67D7BE"),DONORS_200_499:new n.VoterType("Donors $200-499","Medium Donors ($200-$499)","#64C1CD"),DONORS_1_199:new n.VoterType("Donors $1-199","Small Donors ($1-$199)","#5899EA"),NON_DONATING_BELOW_TAX_THRESHOLD:new n.VoterType("Below the tax threshold","Eligible voters who don't make enough to pay income tax","#833B8D"),NON_DONATING_NEEDED_FOR_FUNDING:new n.VoterType("Non-donating voters needed for new funding goals","Non-donating voters needed for new funding goals","#833B8D"),SUPERDOT:new n.VoterType("SUPERDOT","Superdot","black"),MOUSE:new n.VoterType("MOUSE","Mouse","green")},t.VOTER_GROUPS={},t.CURSOR_NODE_DATA={id:"cursor-node",type:t.VOTER_TYPES.MOUSE,x:0,y:0,fx:0,fy:0,sankeys:new Map},t.MIN_RING_SIZE=20,t.RING_SPACING=10,t.MAX_RING_RADIUS=150},9646:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadFlowData=async function(e){const t=await n.csv(e),o=Object.keys(t[0]||{}),a="type",s="voterGroup",l=[];o.forEach(((e,t)=>{e!==a&&e!==s&&l.push(e)}));const d={};return t.forEach((e=>{if(!(0,r.isFlowType)(e[a]))throw new Error(`Invalid flow type: ${e[a]}`);const t=e[a],o=e[s],n=[];l.forEach((o=>{let i=e[o];if(i){if(i=i.replace(/[$,]/g,""),isNaN(+i))throw new Error(`Invalid flow value: ${i}`);n.push({year:o,value:+i,type:t})}})),n.forEach((e=>{d[o]??={},d[o][e.year]??={},d[o][e.year][e.type]=e.value}))})),Object.keys(i.VOTER_GROUPS).forEach((e=>{d[e]&&(i.VOTER_GROUPS[e].dataKey=e,i.VOTER_GROUPS[e].flowData=d[e],i.VOTER_GROUPS[e].dotFlowData=(0,r.flowDataForSingleDot)(d[e]))})),d},t.loadVoterData=async function(e){const t=await n.csv(e),o=/(\d{4}|\bAverage \d{4}-\d{4}\b) Dots/,r=Object.keys(t[0]||{}).filter((e=>o.test(e))).map((e=>e.replace(" Dots","")));a.state.availableYears=r,a.state.yearData={},r.forEach((e=>{a.state.yearData[e]={}})),t.forEach((e=>{const t=e.Group;if(!i.VOTER_TYPE_KEYS[t])return;const o=i.VOTER_TYPE_KEYS[t];r.forEach((t=>{const n=e[`${t} Dots`];n&&!isNaN(+n)&&(a.state.yearData[t][o]=+n)}))}));const s="Average 2016-2022";return a.state.currentYear=s,Object.keys(i.VOTER_TYPES).forEach((e=>{a.state.yearData[s]&&void 0!==a.state.yearData[s][e]&&(i.VOTER_TYPES[e].dotCount=a.state.yearData[s][e])})),Object.keys(i.VOTER_GROUPS).forEach((e=>{i.VOTER_GROUPS[e].updateDotCount()})),Object.values(i.VOTER_TYPES)},t.flattenData=function(e){const t=[];return e.forEach((e=>{for(let o=0;o<e.dotCount;o++)t.push({id:`${e.id}-${o}`,type:e,sankeys:new Map})})),t},t.updateDisplayData=function(e){if(a.state.displayData=a.state.flattenedData.slice(),!e)return void(0,s.addCursorNode)();a.state.displayData=a.state.displayData.filter((t=>t.type.belongsInView(e))),a.state.displayData.forEach((t=>{t.activeClump=t.type.matchedClumpInView(e)})),(0,s.addCursorNode)()};const n=window.d3,i=o(6921),r=o(1613),a=o(3569),s=o(7517)},1795:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pointerMoveHandler=function(e){if(!i.state.cursorNode||i.state.disableCursorPush)return;const[t,o]=n.pointer(e);i.state.cursorNode.fx=t,i.state.cursorNode.fy=o,i.state.simulation.alpha(1).restart()},t.pointerOutHandler=function(){i.state.cursorNode&&(i.state.cursorNode.fx=-1e4,i.state.cursorNode.fy=-1e4);i.state.simulation.alpha(1).restart()},t.setViewFromVisibleTriggers=c,t.scrollHandler=p,t.initEventListeners=function(){n.select(window).on("scroll",p),n.select(window).on("resize",u),u(),n.select("body").on("pointermove mouseover mouseout ",(e=>{i.state.disableCursorPush&&n.select("#dot-info").html((0,a.getDotInfo)(e))})),n.selectAll(".scroll-arrow").on("click",(function(){let e=this?.parentElement;for(;e&&!e.classList.contains("trigger-div");)e=e.parentElement;if(e){const t=Array.from(document.querySelectorAll(".trigger-div")),o=t.indexOf(e);if(o>=0&&o<t.length-1){t[o+1].scrollIntoView({behavior:"smooth",block:"start"})}}})),n.select("#toggle-cursor-push").on("click",(()=>{i.state.disableCursorPush=!i.state.disableCursorPush})),n.select("#stop-everything").on("click",(function(){const e=n.select(this);i.state.isStopped?(i.state.resumeSimulation(),n.selectAll("*").interrupt(),n.select(window).on("scroll",(function(){c();const e=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);n.select("#progress-bar-fill").style("width",100*e+"%")})),e.text("STOP EVERYTHING").classed("active",!1)):(i.state.stopSimulation(),n.selectAll("*").interrupt(),n.select(window).on("scroll",null),e.text("RESUME EVERYTHING").classed("active",!0))})),n.select("#adjust-annotations").on("click",(()=>{(0,l.moveAnnotationsIntoSVGFrame)()})),n.select("#pause-simulation").on("click",(()=>i.state.simulation.stop())),n.select("#resume-simulation").on("click",(()=>i.state.simulation.restart()))};const n=window.d3,i=o(3569),r=o(6610),a=o(6185),s=o(8156),l=o(7734);var d=null;function c(){const e=document.querySelectorAll(".trigger-div");let t=!1;const o=Array.from(e);for(const n of o){let a=!1;const s=n.getBoundingClientRect();let l=n.getAttribute("data-view");const c=100,u=160,p=o.indexOf(n),g=n.closest(".sticky-wrapper");let h=0,f=null;if(g){f=g.getBoundingClientRect();const e=f.top-s.height/2,t=f.height-s.height-u;h=(s.top-e)/t}if(0===p){const e=s.top,t=s.height,o=t+e-c;h=o<t?(t-o)/t:0}const m=g?.querySelectorAll(".minor-trigger");m&&m.forEach((e=>{e.classList.remove("active")}));const y=g?.querySelectorAll(".minor-trigger-text");y&&y.forEach((e=>{parseFloat(e.getAttribute("data-percentage")||"0")<=h?(e.classList.add("active"),a=!0):e.classList.remove("active")}));const O=o[p+1]?.getBoundingClientRect();if(s.top>=c||O&&O.top>window.innerHeight/2&&s.top>=0||0===p&&o[1].getBoundingClientRect().top>window.innerHeight/2-c){if(l&&r.viewPresets[l]){t=!0;const a=g?.querySelectorAll(".minor-trigger");let s,c;if(a&&f){let e=-1;if(a.forEach((t=>{const o=parseFloat(t.getAttribute("data-percentage")||"0");o<=h&&o>e&&(e=o,s=t,c=o)})),s){s.classList.add("active");const e=s.getAttribute("data-view");e&&(l=e)}}if(d!==l){(0,i.requestView)(r.viewPresets[l]),d=l,e.forEach((e=>{e!==n?e.classList.remove("active"):e.classList.add("active")}));break}if(r.viewPresets[l].tween){if(p+1>=o.length)break;const e=o[p+1].getAttribute("data-view");if(!e||!r.viewPresets[e])break;const t=h/2;(0,i.setTweenView)((0,i.createTweenView)(r.viewPresets[l],r.viewPresets[e],t));break}break}break}}}function u(){const e=window.innerHeight;document.body.classList.remove("short-page"),document.body.classList.remove("very-short-page"),document.body.classList.remove("ultra-short-page"),e<800&&document.body.classList.add("short-page"),e<700&&document.body.classList.add("very-short-page"),e<600&&document.body.classList.add("ultra-short-page")}function p(){c();const e=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);n.select("#progress-bar-fill").style("width",100*e+"%").attr("data-percentage",e.toString()),e<=.03?n.select("#progress-bar").classed("hidden",!0):n.select("#progress-bar").classed("hidden",!1),(0,s.updateActiveMarker)(i.state.view?.id||""),u()}},6965:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeSankey=t.FreeSankeyLink=void 0,t.createFreeSankey=function(e){const t=new c(e);e.voterGroups&&t.createLinks();return t};const n=o(1613),i=o(2160),r=o(3569),a=o(6921),s=o(2636),l=o(6185);class d{source;orientation;thickness;isHighlighted=!1;pathElement=null;color="#000000";flowDirection;multiLinkSortIndex=0;id;constructor(e,t,o,n,i,r,a){this.source=t,this.orientation=o,this.flowDirection=n,this.thickness=i,r&&(this.color=r),a&&(this.multiLinkSortIndex=a),this.id=e}getMultiLinkSortIndex(){return this.multiLinkSortIndex}getFlowDirection(){return this.flowDirection}getSource(){return this.source}getThickness(){return this.thickness}setThickness(e){this.thickness=e,this.pathElement&&d3.select(this.pathElement).attr("stroke-width",this.thickness)}setColor(e){this.color=e,this.pathElement&&d3.select(this.pathElement).attr("stroke",this.isHighlighted?"#ff0000":this.color)}positionAlongLink(e){if(!this.pathElement)return{x:0,y:0};const t=this.pathElement;if(t){const o=t.getTotalLength(),n=t.getPointAtLength(o*e);return{x:n.x,y:n.y}}return{x:0,y:0}}calculatePath(e){function t(e){return`${e.x},${e.y}`}const o="horizontal"===this.orientation?d3.linkHorizontal():d3.linkVertical();if(e.bundleOffset||(e.bundleOffset={x:0,y:0}),e.sourceStackOffset||(e.sourceStackOffset={x:0,y:0}),e.curved&&e.target2Point){const o={x:e.destinationPoint.x+e.bundleOffset.x,y:e.destinationPoint.y+e.bundleOffset.y},n={x:e.target2Point.x+e.bundleOffset.x,y:e.target2Point.y+e.bundleOffset.y},a=(0,i.isSuperdot)(this.source)?{x:this.source.x??0,y:this.source.y??0}:{x:0,y:0},s=(0,i.isSuperdot)(this.source)?this.source.radius+this.thickness/2:r.state.dotRadius+this.thickness/2,l=6,d=4/3*Math.tan(Math.PI/(2*l))*s,c=[];let u=-Math.PI/2;u+=1/l*Math.PI;for(let e=0;e<l;e++){const t=e*(2*Math.PI/l)+u,o=a.x+s*Math.cos(t),n=a.y+s*Math.sin(t);c.push({x:o,y:n})}const p=[];for(let e=0;e<l;e++){const t=c[e],o=e===l-1?c[0]:c[e+1],n=e*(2*Math.PI/l)+u,i=((e+1)*(2*Math.PI/l)+u)%(2*Math.PI);let r={x:t.x+d*Math.cos(n+Math.PI/2),y:t.y+d*Math.sin(n+Math.PI/2)},a={x:o.x+d*Math.cos(i-Math.PI/2),y:o.y+d*Math.sin(i-Math.PI/2)};p.push([r,a])}const g=Math.floor(l/2);let h,f,m;"left"===e.curveDirection?(m=c.length-1,h={x:o.x,y:c[m].y-2*this.thickness},f={x:n.x,y:c[g].y+2*this.thickness}):(m=0,h={x:o.x,y:c[0].y-2*this.thickness},f={x:n.x,y:c[g-1].y+2*this.thickness});let y=`M${t(o)} L${t(h)}`;if("left"===e.curveDirection){y+=`C${t({x:h.x,y:h.y+this.thickness})}\n                          ${t(p[m][0])} \n                          ${t(c[m])}`;for(let e=m;e>g;e--)y+=`C${t(p[e-1][1])} \n                              ${t(p[e-1][0])} \n                              ${t(c[e-1])}`;y+=`C${t(p[g-1][1])} \n                          ${t({x:f.x,y:f.y-this.thickness})} \n                          ${t(f)}`}else{y+=`C${t({x:h.x,y:h.y+this.thickness})} \n                          ${t(p[c.length-1][1])} \n                          ${t(c[m])}`;for(let e=0;e<g-1;e++)y+=`C${t(p[e][0])} \n                              ${t(p[e][1])} \n                              ${t(c[e+1])}`;y+=`C${t(p[g-1][0])} \n                          ${t({x:f.x,y:f.y-this.thickness})} \n                          ${t(f)}`}return y+=`L${t(n)}`,y}let n=0;if(n=(0,i.isSuperdot)(this.source)?"incoming"===this.flowDirection?-this.source.radius:this.source.radius:"incoming"===this.flowDirection?-r.state.dotRadius:r.state.dotRadius,e.junctionPoint){const t=e.destinationPoint.x+e.bundleOffset.x,i=e.destinationPoint.y+e.bundleOffset.y,r=e.junctionPoint.x+e.bundleOffset.x,a=e.junctionPoint.y+e.bundleOffset.y;let s=`M${t},${i}`;s+=`L${r},${a}`;const l=(this.source.x??0)+e.sourceStackOffset.x,d=(this.source.y??0)+e.sourceStackOffset.y,c=o({source:[r,a],target:["horizontal"===this.orientation?l+n:l,"horizontal"===this.orientation?d:d+n]})||"";return s+=c.substring(c.indexOf("C")),s+=`L${l},${d}`,s}{const t=(this.source.x??0)+e.sourceStackOffset.x,i=(this.source.y??0)+e.sourceStackOffset.y,r="horizontal"===this.orientation?t+n:t,a="horizontal"===this.orientation?i:i+n;return(o({source:[e.destinationPoint.x,e.destinationPoint.y],target:[r,a]})||"")+`L${t},${i}`}}render(e){this.pathElement&&d3.select(this.pathElement).remove(),e.multiLinkSortIndex&&(this.multiLinkSortIndex=e.multiLinkSortIndex);const t=e.transition??!0,o=this.calculatePath({destinationPoint:e.destinationPoint,junctionPoint:e.junctionPoint,bundleOffset:e.bundleOffset,sourceStackOffset:e.sourceStackOffset,curved:e.curved,target2Point:e.target2Point,curveDirection:e.curveDirection}),n=r.state.svgGroups.linksGroup;if(!n)return;const i=["free-sankey-link","flow-dashed","static",`free-sankey-link-${this.id}`];if("incoming"===this.flowDirection&&i.push("reverse-flow"),this.pathElement=n.append("path").attr("d",o).attr("stroke",this.isHighlighted?"#ff0000":this.color).attr("stroke-width",this.thickness).attr("fill","none").attr("class",i.join(" ")).attr("opacity",0).node(),t){const e="outgoing"===this.flowDirection?"-400":"2800";d3.select(this.pathElement).attr("stroke-dasharray","400 400").attr("stroke-dashoffset",e).transition().duration(2e3).ease(d3.easeCubicInOut).attr("stroke-dasharray","70 10").attr("stroke-dashoffset","0").attr("opacity",1).on("end",(()=>{d3.select(this.pathElement).classed("static",!1)}))}else d3.select(this.pathElement).attr("opacity",1).classed("static",!1)}update(e){if(!this.pathElement)return;e.multiLinkSortIndex&&(this.multiLinkSortIndex=e.multiLinkSortIndex),e.highlightColor?this.setHighlighted(!0,e.highlightColor):this.setHighlighted(!1);const t=this.calculatePath({destinationPoint:e.destinationPoint,junctionPoint:e.junctionPoint,bundleOffset:e.bundleOffset,sourceStackOffset:e.sourceStackOffset,curved:e.curved,target2Point:e.target2Point,curveDirection:e.curveDirection});e.transitionDuration?d3.select(this.pathElement).transition("update-path").duration(e.transitionDuration).attr("d",t).attr("stroke-width",this.thickness):d3.select(this.pathElement).attr("d",t).attr("stroke-width",this.thickness)}setHighlighted(e,t){this.isHighlighted=e,this.pathElement&&d3.select(this.pathElement).attr("stroke",t||(e?"#ff0000":this.color))}remove(e=!0){if(this.pathElement)if(e){const e="outgoing"===this.flowDirection?"2800":"-800";d3.select(this.pathElement).classed("static",!0).attr("stroke-dasharray","70 10").attr("stroke-dashoffset","0").transition().duration(1e3).ease(d3.easeCubicInOut).attr("stroke-dasharray","400 400").attr("stroke-dashoffset",e).attr("opacity",0).on("end",(()=>{d3.select(this.pathElement).remove(),this.pathElement=null}))}else d3.select(this.pathElement).remove(),this.pathElement=null}}t.FreeSankeyLink=d;class c{links=[];target;orientation;flowDirection;flowAspect;junctionPoint=null;voterGroups=null;_junctionOffset={x:0,y:0};color="#000000";targetOffset={x:0,y:0};destinationPoint={x:0,y:0};currentDots=[];destinationStackOffset={x:0,y:0};sourceStackOffsets=new Map;destinationSortIndex=0;config;isInTransition=!1;transitionStartTime=0;transitionDuration=0;highlightLinks=[];curved=!1;target2=null;id;constructor(e){let t;this.config=e,this.target=e.target,this.targetOffset=e.targetOffset||{x:0,y:0},this._junctionOffset=e.junctionOffset,this.orientation=e.orientation,this.flowAspect=e.flowAspect,this.voterGroups=e.voterGroups||null,e.color&&(this.color=e.color),this.flowDirection=e.flowDirection,this.curved=e.curved??!1,this.target2=e.target2??null,t=e.target instanceof s.SimImage?e.target.id:`x${e.target.x}-y${e.target.y}`,this.id=`free-sankey-${e.voterGroups?.map((e=>e.typeKey)).join("-")}-${t}-${e.orientation}-${e.flowDirection}-${e.flowAspect}`}get junctionOffset(){return this._junctionOffset}set junctionOffset(e){this._junctionOffset=e,this.updateJunctionPoint(),this.updateDestinationPoint()}resetJunctionOffset(){this._junctionOffset=this.config.junctionOffset,this.updateJunctionPoint(),this.updateDestinationPoint()}resetTargetOffset(){this.targetOffset=this.config.targetOffset||{x:0,y:0},this.updateDestinationPoint()}resetColor(){this.color=this.config.color||"#000000",this.links.forEach((e=>e.setColor(this.color)))}setColor(e){this.color=e,this.links.forEach((t=>t.setColor(e)))}getColor(){return this.color}getTarget(){return this.target}addLink(e){const t=this.calculateThicknessForDot(e),o=new d(e.id,e,this.orientation,this.flowDirection,t,this.color);this.links.push(o),this.updateJunctionPoint(),this.render()}removeLink(e){const t=this.links.findIndex((t=>t.getSource()===e));-1!==t&&(this.links[t].remove(),this.links.splice(t,1),this.updateJunctionPoint(),this.render())}getTargetCoords(){return this.target instanceof s.SimImage?{x:this.target.position.x,y:this.target.position.y}:{x:this.target.x,y:this.target.y}}getTarget2Coords(){return this.target2?this.target2 instanceof s.SimImage?{x:this.target2.position.x,y:this.target2.position.y}:{x:this.target2.x,y:this.target2.y}:{x:0,y:0}}updateLinkThicknesses(){this.links.forEach((e=>{e.setThickness(this.calculateThicknessForDot(e.getSource()))}))}calculateThicknessForDot(e){let t=a.DEFAULT_LINK_THICKNESS;const o=(0,i.isSuperdot)(e)?e.viewClump?.group:e.activeClump?.group;if(!o)return t;const s=o.flowData;if(!s)return t;const l=s[r.state.currentYear];if(!l)return t;let d;if("credit"===this.flowAspect)d=l?.inflow??0;else if("donation"===this.flowAspect)d=l?.outflow??0;else{if("outOfPocket"!==this.flowAspect)return t;d=(0,n.outOfPocketForYear)(s,r.state.currentYear)??0}return t=d?d/a.MONEY_SCALE:a.DEFAULT_LINK_THICKNESS,t<1&&(t=1),this.curved&&(t/=2),t}updateJunctionPoint(){0!==this.links.length?this.junctionPoint={x:this.destinationPoint.x+this._junctionOffset.x,y:this.destinationPoint.y+this._junctionOffset.y}:this.junctionPoint=null}updateDestinationPoint(){const e=this.getTargetCoords();this.destinationPoint={x:e.x+this.targetOffset.x+this.destinationStackOffset.x,y:e.y+this.targetOffset.y+this.destinationStackOffset.y}}getJunctionPoint(){return this.junctionPoint}getDestinationPoint(){return this.destinationPoint}getAverageSourcePoint(){const e=this.links.map((e=>e.getSource()));return{x:e.reduce(((e,t)=>e+(t.x??0)),0)/e.length,y:e.reduce(((e,t)=>e+(t.y??0)),0)/e.length}}updateSourceStackOffsets(){this.sourceStackOffsets.clear(),this.links.forEach((e=>{const t=e.getSource(),o=(0,l.freeSankeyLinksForDot)(t).filter((e=>e.getFlowDirection()===this.flowDirection));if(1===o.length)return void this.sourceStackOffsets.set(e,{x:0,y:0});const n=o.reduce(((e,t)=>e+t.getThickness()),0),i=e.getThickness(),r=-n/2;let a=0;for(let t=0;t<o.indexOf(e);t++)a+=o[t].getThickness();const s=r+a+i/2;"vertical"===this.orientation?this.sourceStackOffsets.set(e,{x:s,y:0}):this.sourceStackOffsets.set(e,{x:0,y:s})}))}updateDestinationStackOffset(){const e=(0,l.freeSankeysForTarget)(this.target).filter((e=>e.flowDirection===this.flowDirection));if(1===e.length)return void(this.destinationStackOffset={x:0,y:0});const t=e.reduce(((e,t)=>e+t.getTotalThickness()),0),o=this.getTotalThickness(),n=-t/2;let i=0;for(let t=0;t<e.indexOf(this);t++)i+=e[t].getTotalThickness();const r=n+i+o/2;"vertical"===this.orientation?this.destinationStackOffset={x:r,y:0}:this.destinationStackOffset={x:0,y:r}}getTotalThickness(){return this.links.reduce(((e,t)=>e+t.getThickness()),0)}getFirstLinkThickness(){return this.links[0].getThickness()||0}startTransition(e){this.isInTransition=!0,this.transitionStartTime=Date.now(),this.transitionDuration=e}shouldApplyTransition(){if(!this.isInTransition)return!1;return!(Date.now()-this.transitionStartTime>=this.transitionDuration)||(this.isInTransition=!1,!1)}render(){this.updateSourceStackOffsets(),this.updateDestinationStackOffset(),this.updateDestinationPoint(),this.updateJunctionPoint(),this.links.forEach(((e,t)=>{let o=null;this.curved&&(o=0===t?"left":"right"),e.render({destinationPoint:this.destinationPoint,junctionPoint:this.junctionPoint,bundleOffset:this.bundleOffsetForLink(e),sourceStackOffset:this.sourceStackOffsets.get(e)||null,multiLinkSortIndex:this.destinationSortIndex,curved:this.curved,target2Point:this.target2?this.getTarget2Coords():null,curveDirection:o})}))}bundleOffsetForLink(e){const t=this.links.indexOf(e),o=this.getTotalThickness(),n=e.getThickness(),i=-o/2;let r=0;for(let e=0;e<t;e++)r+=this.links[e].getThickness();const a=i+r+n/2;return"vertical"===this.orientation?{x:a,y:0}:{x:0,y:a}}sortLinks(){"horizontal"===this.orientation?this.links.sort(((e,t)=>{const o=e.getSource(),n=t.getSource();return(o?.y??0)-(n?.y??0)})):this.links.sort(((e,t)=>{const o=e.getSource(),n=t.getSource();return(o?.x??0)-(n?.x??0)}))}update(e){this.sortLinks(),this.updateSourceStackOffsets(),this.updateDestinationStackOffset(),this.updateDestinationPoint(),this.updateJunctionPoint(),void 0!==e&&this.startTransition(e);const t=new Map;this.highlightLinks.forEach((e=>{this.links.forEach((o=>{(e.group.containsType(o.getSource().type)||(0,i.getSuperdotByGroup)(e.group)?.id===o.getSource().id)&&t.set(o,e.color)}))})),this.links.forEach(((e,o)=>{const n=t.get(e)||null;let i=null;this.curved&&(i=0===o?"left":"right"),e.update({multiLinkSortIndex:this.destinationSortIndex,destinationPoint:this.destinationPoint,junctionPoint:this.junctionPoint,bundleOffset:this.bundleOffsetForLink(e),sourceStackOffset:this.sourceStackOffsets.get(e)||null,transitionDuration:this.shouldApplyTransition()?this.transitionDuration:void 0,highlightColor:n||void 0,curved:this.curved,target2Point:this.target2?this.getTarget2Coords():null,curveDirection:i})}))}setLinkHighlighted(e,t){const o=this.links.find((t=>t.getSource()===e));o&&o.setHighlighted(t)}clear(){this.links.forEach((e=>e.remove())),this.links=[],this.junctionPoint=null}createLinks(){this.voterGroups&&(this.clear(),this.currentDots=this.getDotsFromVoterGroups(),this.currentDots.forEach((e=>{this.curved&&this.addLink(e),this.addLink(e)})))}getDotsFromVoterGroups(){if(!this.voterGroups)return[];const e=[];return this.voterGroups.forEach((t=>{const o=(0,i.getSuperdotByGroup)(t);if(o)e.includes(o)||e.push(o);else{const o=n.VoterGroup.activeDots([t]);e.push(...o)}})),e}connectionToDot(e){return this.currentDots.find((t=>t.id===e.id))?this.flowDirection:null}linkForDot(e){return this.links.find((t=>t.getSource().id===e.id))||null}}t.FreeSankey=c},3438:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(o(5543)),r=n(o(4997)),a={en:{translation:o(4362)},fr:{translation:o(9633)}};i.default.use(r.default).init({resources:a,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator","htmlTag"],lookupLocalStorage:"i18nextLng",caches:["localStorage"]}}),t.default=i.default},2636:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SimImage=void 0;const n=o(3569);t.SimImage=class{id;src;alt;rotates=!1;_active=!1;_position={x:0,y:0};_size={width:0,height:0};offset={x:0,y:0};_originalOffset;imageElement;listeners=[];initPosition={x:0,y:0};initSize={width:0,height:0};constructor(e){if(!e.id||""===e.id)throw new Error("ImageConfig must have an id");if(!e.src||""===e.src)throw new Error("ImageConfig must have a source url");if(!e.alt||""===e.alt)throw new Error("ImageConfig must have an alt description");this.id=e.id,this.src=e.src,this.alt=e.alt,this._position=e.position||{x:0,y:0},this.initPosition=e.position||{x:0,y:0},this._size=e.size||{width:0,height:0},this.initSize=e.size||{width:0,height:0},this.offset=e.offset||{x:0,y:0},this.rotates=e.rotates||!1}get position(){return this._position}set position(e){this._position={...e}}updateImage(e=!0){this.imageElement&&("0"!==this.imageElement.style("opacity")&&"none"!==this.imageElement.style("display")&&e?(this.imageElement.transition(`${this.id}-move`).duration(300).attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this.imageElement.transition(`${this.id}-resize`).duration(300).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`)):(this.imageElement.attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this.imageElement.attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`)))}resetPosition(){this.position={...this.initPosition}}resetSize(){this.size={...this.initSize}}get size(){return this._size}set size(e){this._size={...e}}set active(e){this._active=e}get active(){return this._active}addToGroup(e){return!(this.imageElement&&!this.imageElement.empty())&&(this.imageElement=e.append("image").attr("class",`icon-${this.id}`).attr("href",this.src).attr("x",this.position.x).attr("y",this.position.y).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`).attr("width",this.size.width).attr("height",this.size.height).style("transform-box","fill-box").style("transform-origin","center"),this.rotates&&this.addListener("scroll",(()=>{if(this.imageElement){const e=(window.scrollY||window.pageYOffset)/50;this.imageElement.style("transform",`translate(-${this.size.width/2}px, -${this.size.height/2}px) rotate(${e}deg)`)}})),this._active=!0,!0)}removeFromGroup(e){this.imageElement&&(e?this.imageElement.transition().duration(e).style("opacity",0).remove().on("end",(()=>{this.imageElement=void 0})):(this.imageElement.remove(),this.imageElement=void 0),this._active=!1,this.removeListeners())}show(){return new Promise(((e,t)=>{if(!this.imageElement){if(!n.state.svgGroups.imgGroup)return;this.addToGroup(n.state.svgGroups.imgGroup)}this.imageElement?.style("display","block").style("opacity",0).attr("width",this.size.width/2).attr("height",this.size.height/2).attr("transform",`translate(-${this.size.width/4}, -${this.size.height/4})`).transition(`${this.id}-show`).duration(500).style("opacity",1).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`),this._active=!0,e()}))}hide(){return new Promise(((e,t)=>{this.imageElement?.style("opacity",1).attr("width",this.size.width).attr("height",this.size.height).attr("transform",`translate(-${this.size.width/2}, -${this.size.height/2})`).transition(`${this.id}-show`).duration(500).style("opacity",0).attr("width",this.size.width/2).attr("height",this.size.height/2).attr("transform",`translate(-${this.size.width/4}, -${this.size.height/4})`).on("end",(()=>{this.imageElement?.style("display","none")})),this._active=!1,e()}))}addListener(e,t){this.imageElement&&("scroll"===e?window.addEventListener("scroll",t):this.imageElement.on(e,t),this.listeners.push({type:e,callback:t}))}removeListeners(){this.listeners.forEach((e=>{"scroll"===e.type?window.removeEventListener("scroll",e.callback):this.imageElement?.on(e.type,null)}))}}},8156:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateActiveMarker=y,o(4376),o(3438);const i=o(3414),r=o(9646),a=o(6921),s=o(3569),l=o(7517),d=o(1114),c=o(6610),u=o(1795),p=o(4391),g=o(600),h=n(o(5543));const f=new Set(["everyoneRadial"]);function m(){const e=document.getElementById("year-selector");if(!e)return;if(s.state.view&&f.has(s.state.view.id))return void(e.style.display="none");e.style.display="flex","Average 2016-2022"===s.state.currentYear?e.classList.add("average-active"):e.classList.remove("average-active");e.querySelectorAll(".year-button").forEach((e=>{const t=e,o=t.dataset.year||"",n=o===s.state.currentYear,i=s.state.yearHasDataForActiveTypes(o),r=s.state.lockedToAverageYears&&"Average 2016-2022"!==o;n?t.classList.add("active"):t.classList.remove("active"),t.disabled=!i||r}))}function y(e){const t=document.querySelectorAll(".progress-marker"),o=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);let n=-1,i=0;if(t.forEach(((e,t)=>{if(e.classList.remove("active"),e.classList.remove("passed"),e.getAttribute("data-percentage")){const r=parseFloat(e.getAttribute("data-percentage")||"0");r<=o&&(e.classList.add("passed"),r>=i&&(n=t,i=r))}})),n>=0&&(t[n].classList.add("active"),t[n].classList.contains("minor"))){const e=t[n].getAttribute("data-major-trigger-view");if(e){const t=document.querySelector(`.progress-marker.major[data-view="${e}"]`);t?.classList.add("active")}}}window.updateYearSelectorUI=m,async function(){(0,i.initTranslations)(),function(){const e=document.getElementById("language-toggle");e&&e.addEventListener("click",(()=>{const t="en"===h.default.language?"fr":"en";h.default.changeLanguage(t,(()=>{e.textContent="en"===t?"FR":"EN";const{applyTranslations:n}=o(3414);n(),m()}))}))}(),(0,a.createVoterGroups)(),s.state.importedData=await(0,r.loadVoterData)("assets/csv/voters.csv"),s.state.freeFlowData=await(0,r.loadFlowData)("assets/csv/freeFlow.csv"),s.state.flattenedData=(0,r.flattenData)(s.state.importedData),(0,c.initializeViewComponents)(),(0,d.initVisualization)("chart1"),(0,l.initSimulation)(),function(){const e=document.createElement("div");e.id="year-selector",s.state.availableYears.forEach((t=>{const o=document.createElement("button");"Average 2016-2022"===t?(o.textContent=(0,g.t)("common.average"),o.classList.add("average-year")):o.textContent=t,o.dataset.year=t,o.classList.add("year-button"),"2019"!==t&&"2021"!==t||o.classList.add("election-year"),o.addEventListener("click",(()=>{s.state.setYear(t),m()})),e.appendChild(o)})),document.body.appendChild(e)}(),(0,p.initLegend)(),(0,u.initEventListeners)(),function(){d3.select("#progress-bar"),d3.select("#progress-bar-fill");const e=d3.select("#progress-markers");e.selectAll("*").remove();const t=document.querySelectorAll(".trigger-div"),o=document.querySelectorAll(".minor-trigger"),n=document.querySelectorAll(".minor-trigger-text"),i=document.documentElement.scrollHeight-window.innerHeight,r=document.querySelector(".color-wrapper .trigger-div");e.append("div").attr("class","progress-marker").style("left","0%").attr("data-percentage","0").attr("data-view",r?.getAttribute("data-view")||"").on("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})})),t.forEach((t=>{const o=t.closest(".sticky-wrapper");if(!o)return;const n=o.getBoundingClientRect();if(!n)return;const r=(n.top+window.scrollY-window.innerHeight/2)/i,a=e.append("div").attr("class","progress-marker major").style("left",100*r+"%").attr("data-percentage",r.toString()).attr("data-view",t.getAttribute("data-view"));a.on("click",(()=>{const e=parseFloat(a.attr("data-percentage")||"0");window.scrollTo({top:e*i,behavior:"smooth"})}))})),o.forEach((t=>{const o=t.getBoundingClientRect(),n=t.closest(".sticky-wrapper"),r=n?.querySelector(".trigger-div"),a=(o.top+window.scrollY-window.innerHeight/2)/i,s=e.append("div").attr("class","progress-marker minor").style("left",100*a+"%").attr("data-view",t.getAttribute("data-view")).attr("data-major-trigger-view",r?.getAttribute("data-view")||"").attr("data-percentage",a.toString());s.on("click",(()=>{const e=parseFloat(s.attr("data-percentage")||"0");window.scrollTo({top:e*i,behavior:"smooth"})}))})),n.forEach((t=>{const o=t.getBoundingClientRect(),n=t.closest(".sticky-wrapper"),r=n?.querySelector('.minor-trigger[data-percentage="'+t.getAttribute("data-percentage")+'"]');if(r)return;const a=n?.querySelector(".trigger-div"),s=(o.top+window.scrollY-window.innerHeight/2)/i,l=e.append("div").attr("class","progress-marker minor").style("left",100*s+"%").attr("data-view",t.getAttribute("data-view")).attr("data-major-trigger-view",a?.getAttribute("data-view")||"").attr("data-percentage",s.toString());l.on("click",(()=>{const e=parseFloat(l.attr("data-percentage")||"0");window.scrollTo({top:e*i,behavior:"smooth"})}))}))}(),(0,u.scrollHandler)(),y(s.state.view)}()},4391:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initLegend=function(){if(!d){d=document.createElement("div"),d.id="dot-legend",d.className="dot-legend default-visibility",document.body.appendChild(d),d.style.right=`${-b.x+g}px`,d.style.top=`${b.y}px`;const e=document.createElement("div");e.className="dot-legend-header";const t=document.createElement("div");t.textContent=(0,l.t)("legend.title"),t.className="dot-legend-header-title",e.appendChild(t);const o=document.createElement("button");o.innerHTML=`<span class="show-text" data-i18n="legend.show_legend">\n                                    ${(0,l.t)("legend.show_legend")}\n                                  </span>\n                                  <span class="hide-text" data-i18n="legend.hide_legend">\n                                    ${(0,l.t)("legend.hide_legend")}\n                                  </span>`,o.className="dot-legend-toggle",o.addEventListener("click",w),c=o,e.appendChild(o),d.appendChild(e),p=document.createElement("div"),p.innerHTML=(0,l.t)("legend.each_dot_is_10k",{dot:"<span class='legend-dot black'></span>"}),p.className="dot-legend-size-key",d.appendChild(p),u=document.createElement("div"),u.className="dot-legend-content",d.appendChild(u);let n,i,r,a,s=!1;e.addEventListener("mousedown",(e=>{document.body.classList.contains("short-page")||window.innerWidth<1024||(s=!0,n=e.clientX,i=e.clientY,r=b.x,a=b.y,d?.classList.add("dragging"))})),document.addEventListener("mousemove",(e=>{if(!s)return;const t=e.clientX-n,o=e.clientY-i;b.x=r+t,b.y=a+o,d&&(d.style.right=`${-b.x+g}px`,d.style.top=`${b.y}px`)})),document.addEventListener("mouseup",(()=>{s=!1,d?.classList.remove("dragging")}))}x()},t.updateLegend=x;const n=o(6921),i=o(3569),r=o(6610),a=o(6921),s=o(6020),l=o(600);let d=null,c=null,u=null,p=null,g=40;const h=new Set(["nonRefundable","nonRefundable2"]),f=new Set(["everyoneRadial"]),m=new Set(["capTheDonationLimit2","bringBackPVS1","capTheDonationLimit2Alt","whatAboutTheTaxCredit","whatAboutTheTaxCredit2"]),y=new Set(["onlyVotersBullseye","capTheDonationLimit1Alt"]),O=new Set(["partiesFocusingOnWealthy","moneyBuysAccess","howTaxCreditWorksOutOfPocket","howTaxCreditWorksPart2","howTaxCreditWorks","benefitsTheAlreadyWealthySetup","outsideLookingIn","exclusiveClub","howTaxCreditWorksOutOfPocket2","bigDonorsGetNearlyHalfOfCredits","capTheDonationLimit2","whatsTheSolutionAlt"]),_=new Set(["capTheDonationLimit2Alt","whatAboutTheTaxCredit","whatAboutTheTaxCredit2","bringBackPVS1","bringBackPVS2"]);let b={x:20,y:140};function w(){d?.classList.contains("default-visibility")&&u?"none"===window.getComputedStyle(u).display?i.state.legendVisible=!0:i.state.legendVisible=!1:i.state.legendVisible=!i.state.legendVisible,u&&(u.style.display=i.state.legendVisible?"block":"none"),p&&(p.style.display=i.state.legendVisible?"block":"none"),c&&(i.state.legendVisible?(d?.classList.add("visible"),d?.classList.remove("hidden")):(d?.classList.add("hidden"),d?.classList.remove("visible")),d?.classList.remove("default-visibility"))}function v(e){const t=i.state.view;if(!t)return null;for(const o of t.clumps)if(o.groupColorOverride)for(const t of o.groupColorOverride)if(t.group.id===e)return t.color;return null}function x(){if(!d||!u)return;if(0===i.state.seenDotTypes.size)return void(d.style.display="none");if(i.state.view&&f.has(i.state.view.id))return void(d.style.display="none");d.style.display="block";const e=function(){const e=i.state.view,t=Array.from(i.state.activeDotTypes),o=e&&h.has(e.id),d=e&&m.has(e.id),c=e&&y.has(e.id),u=e&&O.has(e.id),p=e&&_.has(e.id),g=[],f=[],b=[],w=[],x=[];if(t.includes(n.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.id)&&g.push({id:n.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.id,name:(0,l.t)("legend.voters"),color:n.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS.color,category:"voter",i18n_key:"voters",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.REMAINING_NON_DONATING_VOTERS)))||!1,shape:"circle"}),t.includes(n.VOTER_TYPES.ELIGIBLE_NON_VOTERS.id)&&g.push({id:n.VOTER_TYPES.ELIGIBLE_NON_VOTERS.id,name:(0,l.t)("legend.non_voters"),color:n.VOTER_TYPES.ELIGIBLE_NON_VOTERS.color,category:"voter",i18n_key:"non_voters",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.ELIGIBLE_NON_VOTERS)))||!1,shape:"circle"}),!t.includes(n.VOTER_TYPES.DONORS_1_199.id)||c||u||p||f.push({id:n.VOTER_TYPES.DONORS_1_199.id,name:(0,l.t)("legend.donated_1_199"),color:n.VOTER_TYPES.DONORS_1_199.color,category:"donor",i18n_key:"donated_1_199",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.DONORS_1_199)))||!1,shape:"circle"}),!t.includes(n.VOTER_TYPES.DONORS_200_499.id)||c||u||p||f.push({id:n.VOTER_TYPES.DONORS_200_499.id,name:(0,l.t)("legend.donated_200_499"),color:n.VOTER_TYPES.DONORS_200_499.color,category:"donor",i18n_key:"donated_200_499",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.DONORS_200_499)))||!1,shape:"circle"}),!t.includes(n.VOTER_TYPES.DONORS_500_999.id)||c||u||p||f.push({id:n.VOTER_TYPES.DONORS_500_999.id,name:(0,l.t)("legend.donated_500_999"),color:n.VOTER_TYPES.DONORS_500_999.color,category:"donor",i18n_key:"donated_500_999",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.DONORS_500_999)))||!1,shape:"circle"}),!t.includes(n.VOTER_TYPES.DONORS_OVER_1000.id)||c||p||f.push({id:n.VOTER_TYPES.DONORS_OVER_1000.id,name:(0,l.t)("legend.donated_1000_plus"),color:n.VOTER_TYPES.DONORS_OVER_1000.color,category:"donor",i18n_key:"donated_1000_plus",isActive:e?.clumps.some((e=>e.group.containsType(n.VOTER_TYPES.DONORS_OVER_1000)))||!1,shape:"circle"}),o){if(t.includes(n.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id)){const t=v(n.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id);b.push({id:n.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id,name:(0,l.t)("legend.above_tax_threshold"),color:t||"rgba(0, 0, 0, 0.7)",category:"tax",i18n_key:"above_tax_threshold",isActive:e?.clumps.some((e=>e.group.id===n.VOTER_GROUPS.ABOVE_TAX_THRESHOLD.id))||!1,shape:"circle"})}if(t.includes(n.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id)){const t=v(n.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id);b.push({id:n.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id,name:(0,l.t)("legend.below_tax_threshold"),color:t||"#B5C617",category:"tax",i18n_key:"below_tax_threshold",isActive:e?.clumps.some((e=>e.group.id===n.VOTER_GROUPS.BELOW_TAX_THRESHOLD.id))||!1,shape:"circle"})}}if(c){const t=v(n.VOTER_GROUPS.ALL_DONORS.id);f.push({id:n.VOTER_GROUPS.ALL_DONORS.id,name:(0,l.t)("legend.all_donors"),color:t||a.typeColors.greal,category:"donor",i18n_key:"all_donors",isActive:e?.clumps.some((e=>e.group.id===n.VOTER_GROUPS.ALL_DONORS.id))||!1,shape:"circle"})}if(u){const t=v(n.VOTER_GROUPS.DONORS_1_999.id);f.push({id:n.VOTER_GROUPS.DONORS_1_999.id,name:(0,l.t)("legend.donated_1_999"),color:t||a.typeColors.greal,category:"donor",i18n_key:"donated_1_999",isActive:e?.clumps.some((e=>e.group.id===n.VOTER_GROUPS.DONORS_1_999.id))||!1,shape:"circle"})}const S=t.includes("reform-donor-seen");if(d||S){d&&i.state.seenDotTypes.add("reform-donor-seen");const e=Boolean(d);f.push({id:"reform-donor",name:(0,l.t)("legend.with_100_donor_cap"),color:"#B5C617",category:"donor",i18n_key:"with_100_donor_cap",isActive:e,shape:"circle"})}const k=Object.values(s.viewFreeSankeys).filter((e=>e.getColor()===n.flowColors.green)).map((e=>e.id)),R=Object.values(s.viewFreeSankeys).filter((e=>e.getColor()===n.flowColors.blue)).map((e=>e.id)),T=Object.values(s.viewFreeSankeys).filter((e=>e.getColor()===n.flowColors.purple)).map((e=>e.id));if(e?.freeSankeyGroups&&e.freeSankeyGroups.length>0){const t=e.freeSankeyGroups.some((e=>k.includes(e.freeSankey.id))),o=e.freeSankeyGroups.some((e=>T.includes(e.freeSankey.id))),n=e.freeSankeyGroups.some((e=>R.includes(e.freeSankey.id)));t&&w.push({id:"flow-green",name:(0,l.t)("legend.money_donated"),color:"rgba(0, 255, 30, 0.5)",category:"flow",i18n_key:"money_donated",isActive:!0,shape:"square"}),n&&w.push({id:"flow-blue",name:(0,l.t)("legend.tax_refunds_for_donating"),color:"rgba(0, 106, 255, 0.5)",category:"flow",i18n_key:"tax_refunds_for_donating",isActive:!0,shape:"square"}),o&&w.push({id:"flow-purple",name:(0,l.t)("legend.per_vote_subsidy"),color:"rgba(214, 93, 230, 0.5)",category:"flow",i18n_key:"per_vote_subsidy",isActive:!0,shape:"square"})}return i.state.images.some((e=>"bot-party-icon"===e.id&&e.active))&&x.push({id:"party-icon",name:(0,l.t)("legend.major_federal_parties"),image:r.viewImages.partyIcon,category:"icons",i18n_key:"major_federal_parties",isActive:i.state.images.some((e=>"bot-party-icon"===e.id&&e.active))}),i.state.images.some((e=>"parliament-icon-end"===e.id&&e.active))&&x.push({id:"parliament-icon",name:(0,l.t)("legend.canadian_government"),image:r.viewImages.parliamentIcon,category:"icons",i18n_key:"canadian_government",isActive:i.state.images.some((e=>"parliament-icon-end"===e.id&&e.active))}),[...g,...f,...b,...w,...x]}();let t="",o="";e.forEach((n=>{if(n.category!==o&&e.filter((e=>e.category===n.category)).length>0){o=n.category;let e="",i="";switch(o){case"voter":e=(0,l.t)("legend.category_eligible_voters"),i="legend-category-voter";break;case"donor":e=(0,l.t)("legend.category_major_party_donors"),i="legend-category-donor";break;case"tax":e=(0,l.t)("legend.category_tax_threshold"),i="legend-category-tax";break;case"flow":e=(0,l.t)("legend.category_money_flow"),i="legend-category-flow";break;case"icons":e=(0,l.t)("legend.category_icons"),i="legend-category-icons"}t+=`<div class="legend-category ${i}">${e}</div>`}const i="square"===n.shape?"legend-square":"legend-dot";n.image?t+=`\n                <div class="legend-item image-type ${n.isActive?"active":"inactive"}">\n                    <img src="${n.image.src}" alt="${n.image.alt}" class="legend-image" />\n                    <span class="legend-label" data-i18n="legend.${n.i18n_key}">${n.name}</span>\n                </div>\n            `:t+=`\n                <div class="legend-item ${n.isActive?"active":"inactive"}">\n                    <span class="${i}" style="background-color: ${n.color}"></span>\n                    <span class="legend-label" data-i18n="legend.${n.i18n_key}">${n.name}</span>\n                </div>\n            `})),u.innerHTML=t}window.updateLegend=x},9185:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkManager=void 0;const n=window.d3,i=o(3569),r=o(6921),a=o(2160),s={colorScheme:{standard:"rgba(80, 255, 100, 0.4)",bundle:"rgba(80, 255, 100, 0.6)"},transitionDurations:{enter:700,update:300,exit:700},bundleLinkDelay:500};t.LinkManager=class{links=[];svgLinkGroup=null;config;verticalLinkGenerator;horizontalLinkGenerator;sankeys=[];constructor(e={}){this.svgLinkGroup=i.state.svgGroups.linksGroup,this.config={...s,...e},this.verticalLinkGenerator=this.createVerticalLinkGenerator(),this.horizontalLinkGenerator=this.createHorizontalLinkGenerator()}activeSankeys(){return this.sankeys.filter((e=>e.active))}createHighlightPath(e){if(!e.flowConfig?.highlightPath)return;const t=e.flowConfig.highlightPath,o=t.fromGroup,n=t.toGroup;if(!o&&!n)return;const r=[];o&&i.state.displayData.forEach((e=>{e.type.id===o&&r.push(e)})),n&&i.state.displayData.forEach((e=>{e.type.id===n&&r.push(e)})),0!==r.length&&this.links.forEach((t=>{t.sankey===e&&t.dot&&r.some((e=>e.id===t.dot?.id))&&(t.highlightPath=!0)}))}calculateOffsetPath(e,t,o=0,n=1){const i=e.getTotalLength();if(i<10)return e.getAttribute("d")||"";const r="number"==typeof t,a=r?0:t.x,s=r?0:t.y,l=r?t:0;o=Math.max(0,Math.min(.99,o)),n=Math.max(o+.01,Math.min(1,n));const d=Math.max(10,Math.floor(i/20)),c=[],u=Math.floor(o*d),p=Math.ceil(n*d);for(let t=u;t<=p;t++){const o=t/d,n=e.getPointAtLength(o*i);c.push({x:n.x,y:n.y})}const g=[];for(let e=0;e<c.length;e++){const t={x:c[e].x,y:c[e].y};if(0!==l){let o=0,n=0;0===e?c.length>1&&(o=c[1].x-c[0].x,n=c[1].y-c[0].y):e===c.length-1?(o=c[e].x-c[e-1].x,n=c[e].y-c[e-1].y):(o=c[e+1].x-c[e-1].x,n=c[e+1].y-c[e-1].y);const i=Math.sqrt(o*o+n*n);i>0&&(o/=i,n/=i);const r=-n,a=o;t.x+=r*l,t.y+=a*l}g.push({x:t.x+a,y:t.y+s})}if(0===g.length)return"";let h=`M${g[0].x},${g[0].y}`;for(let e=1;e<g.length;e++)h+=` L${g[e].x},${g[e].y}`;return h}calculateDotConnectionOffset(e,t){const o=t.allSankeysInSameDirectionForDot(e),n=o.length,i=t.linkThickness(e)||1;if(n<=1)return 0;return-(n*i)/2+o.indexOf(t)*i+i/2}createVerticalLinkGenerator(){const e=n.linkVertical().x((function(e){return e&&"number"==typeof e.x?e.x:0})).y((function(e){return e&&"number"==typeof e.y?e.y:0}));return function(t){if(!t||!t.source||!t.target)return"M0,0L0,0";try{return e(t)??"M0,0L0,0"}catch(e){return"M0,0L0,0"}}}createHorizontalLinkGenerator(){const e=n.linkHorizontal().x((function(e){return e&&"number"==typeof e.x?e.x:0})).y((function(e){return e&&"number"==typeof e.y?e.y:0}));return function(t){if(!t||!t.source||!t.target)return"M0,0L0,0";try{return e(t)??"M0,0L0,0"}catch(e){return"M0,0L0,0"}}}getLinkGenerator(e){return"vertical"===e?this.verticalLinkGenerator:this.horizontalLinkGenerator}setVisibleSankeys(e){const t=[],o=this.activeSankeys();return e?(o.forEach((o=>{e.includes(o)||t.push(this.hideSankey(o))})),e.forEach((e=>{this.sankeyExists(e)||this.sankeys.push(e),t.push(this.showSankey(e))})),Promise.all(t).then((()=>{}))):(o.forEach((e=>{t.push(this.hideSankey(e))})),Promise.all(t).then((()=>{})))}toggleSankey(e){return e.active?this.removeSankey(e):this.addSankey(e)}addSankey(e){return e.active?Promise.resolve():e.validEndpoints()?(this.createLinksForSankey(e),e.active=!0,this.renderLinks()):Promise.resolve()}showSankey(e){return this.sankeyExists(e)&&!e.active?this.addSankey(e):Promise.resolve()}hideSankey(e){return this.sankeyExists(e)&&e.active?this.removeSankey(e):Promise.resolve()}removeSankey(e){return new Promise((t=>{if(0===e.getLinks().length)return e.active=!1,void t();e.removeFromDotData();let o=0,n=0;const i=this.svgLinkGroup?.selectAll("path.link").filter((t=>t.id.startsWith(`${e.id}-`)||t.id.startsWith(`${e.id}-bundle-`)));o=i?.size()||0;o>0&&i?i.style("opacity",0).on("end",(()=>{n++,n>=o&&t()})).remove():t(),this.links=this.links.filter((t=>!t.id.startsWith(`${e.id}-`)&&!t.id.startsWith(`${e.id}-bundle-`))),this.svgLinkGroup&&this.svgLinkGroup.selectAll(`path.offset-arrow-path.sankey-${e.id}`).remove(),e.active=!1}))}sortDotsByPosition(e,t){return"horizontal"===t?[...e].sort(((e,t)=>(e.y??0)-(t.y??0))):[...e].sort(((e,t)=>(e.x??0)-(t.x??0)))}createLinksForSankey(e){if(!e.getWeightedGroups())return;const t=e.getImage();if(!t?.active)return;const o=e.getJunctionCenter(),n=this.calculateJunctionOffsets(e),i=e.flowForDots();if(!i)return;let r=e.getDotsForLinks();if(!r.length)return;r=this.sortDotsByPosition(r,e.orientation),r.forEach(((t,r)=>{const a=e.linkThickness(t)||1,s=n.get(t)||0,l=e.isVertical()?s:0,d=e.isHorizontal()?s:0;t.sankeys.set(e,i);const c=this.calculateDotConnectionOffset(t,e),u=e.isVertical()?c:0,p=e.isHorizontal()?c:0,g={x:(t.x||0)+u,y:(t.y||0)+p},h={x:o.x+l,y:o.y+d},f={x:h.x,y:h.y,isFixed:!0,index:r,sankey:e},m={x:g.x,y:g.y,dot:t,sankey:e},y={id:`${e.id}-link-${r}`,source:e.dotsAreSource()?m:f,target:e.dotsAreSource()?f:m,width:a,sankey:e,dot:t};this.links.push(y)}));const a=e.dotsAreSource()?o:t.position,s=e.dotsAreSource()?t.position:o;this.createBundleLink(e,a,s),e.flowConfig?.highlightPath&&this.createHighlightPath(e)}createBundleLink(e,t,o){const n={id:`${e.id}-bundle-link`,source:{x:t.x,y:t.y,isFixed:!0,sankey:e},target:{x:o.x,y:o.y,isFixed:!0,sankey:e},width:e.totalThickness,sankey:e};this.links.push(n)}calculateJunctionOffsets(e){const t=new Map,o=e.getDotsForLinks(),n=o.length*e.totalThickness,i=e.totalThickness/n;let r=-e.totalThickness/2;return o.forEach((o=>{const n=(e.linkThickness(o)||1)*i;t.set(o,r+n/2),r+=n})),t}groupJunctionsByProximity(){const e=new Map,t=new Set;return this.activeSankeys().forEach((o=>{if(t.has(o))return;const n=o.getJunctionCenter(),i=`junction-group-${e.size}`,r=[o];t.add(o),this.activeSankeys().forEach((e=>{if(o===e||t.has(e))return;const i=e.getJunctionCenter();Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2))<=20&&(r.push(e),t.add(e))})),(r.length>1||this.getSankeyIndividualLinks(r[0]).length>0)&&e.set(i,r)})),e}getSankeyIndividualLinks(e){return this.links.filter((t=>t.id.startsWith(`${e.id}-link-`)&&!t.id.includes("bundle")))}updateSankeyJunctionPositions(){const e=this.groupJunctionsByProximity();let t=0,o=0;this.activeSankeys().forEach((e=>{e.isVertical()?t++:o++}));const n=t>=o;e.forEach(((e,t)=>{if(0===e.length)return;const o=this.sortSankeysByDotPositions(e.map((e=>({link:{},sankey:e}))),n).map((e=>e.sankey)),r=[];if(o.forEach((e=>{const t=this.getSankeyIndividualLinks(e);if(0===t.length)return;const o=e.dotsAreSource(),n=new Map;t.forEach((e=>{e.dot&&(n.has(e.dot)||n.set(e.dot,[]),n.get(e.dot).push(e))}));const a=Array.from(n.keys()).map((e=>i.state.displayData.find((t=>t.id===e.id))||i.state.superdots.find((t=>t.id===e.id)))).filter((e=>void 0!==e));this.sortDotsByPosition(a,e.orientation).forEach((t=>{(n.get(t)||[]).forEach((t=>{const n=o,i=n?t.target:t.source;r.push({link:t,sankey:e,isJunctionTarget:n,vertex:i,width:t.width||1})}))}))})),0===r.length)return;const a=r.reduce(((e,t)=>e+t.width),0),s=o[0].getJunctionCenter();let l=n?s.x:s.y;l-=a/2;const d=n?s.y:s.x;let c=l;r.forEach((e=>{const t=c+e.width/2;e.vertex.x=n?t:d,e.vertex.y=n?d:t,e.vertex.isFixed=!0,c+=e.width}))}))}renderLinks(){if(!this.svgLinkGroup)return Promise.resolve();const e=this.svgLinkGroup;return e.selectAll("path.offset-arrow-path").remove(),new Promise((t=>{const o=e.selectAll("path.link").data(this.links);let i=0,r=0;const a=()=>{r++,r>=i&&(this.createOffsetArrows(),t())},s=e=>(e.each((function(e){const t=n.select(this),o=e.sankey;if(!o)return;t.classed("arrow-start",!1).classed("arrow-end",!1).classed("arrow-mid",!1).classed("flow-dashed",!1).classed("animated-flow",!1).classed("animated-flow-markers",!1).classed("highlight-path",!1);const i=o.flowConfig;"arrow"===i.style&&i.arrowPosition&&("start"!==i.arrowPosition&&"both"!==i.arrowPosition||t.classed("arrow-start",!0),"end"!==i.arrowPosition&&"both"!==i.arrowPosition||t.classed("arrow-end",!0),"mid"===i.arrowPosition&&t.classed("arrow-mid",!0)),"dashed"===i.style&&t.classed("flow-dashed",!0),i.highlightPath&&(e.highlightPath?t.classed("highlight-path",!0).attr("stroke",i.highlightPath.color||o.color).attr("stroke-width",i.highlightPath.width||1.5*e.width):e.id.includes("bundle-link")&&t.attr("stroke",o.color).attr("stroke-width",e.width))})),e),l=o.enter().append("path").lower().attr("class","link").attr("stroke",(e=>e.sankey?.color||this.config.colorScheme.standard)).attr("fill","none").attr("stroke-width",(e=>e.width)).attr("d",(e=>this.getLinkGenerator(e.sankey?.orientation)(e))).attr("id",(e=>e.id)).style("opacity",0).call(s),d=l.size();i+=d,d>0&&l.transition("link-transition-in").duration(this.config.transitionDurations.enter).style("opacity",1);const c=o.attr("id",(e=>e.id)).call(s).transition("link-transition-update").duration(this.config.transitionDurations.update).attr("stroke-width",(e=>e.width)).attr("stroke",(e=>e.sankey?.color||this.config.colorScheme.standard)),u=c.size();i+=u,u>0&&c.attr("d",(e=>this.getLinkGenerator(e.sankey?.orientation)(e))).on("end",a);const p=o.exit(),g=p.size();i+=g,g>0&&p.transition("link-transition-out").duration(this.config.transitionDurations.exit).style("opacity",0).on("end",a).remove(),0===i&&t()}))}clearAll(){this.activeSankeys().forEach((e=>{this.removeSankey(e)})),this.links=[],this.svgLinkGroup&&this.svgLinkGroup.selectAll("path.offset-arrow-path").remove()}sankeyExists(e){return this.sankeys.some((t=>t.id===e.id))}tick(){try{if(this.updateSankeyJunctionPositions(),this.updateBundleLinkPositions(),this.updateLinkPositions(),this.svgLinkGroup){const e=this.svgLinkGroup.selectAll(".link").data(this.links,(e=>e.id)),t=e=>(e.each((function(e){const t=n.select(this),o=e.sankey;if(o){if(!t.classed("flow-dashed")&&!t.classed("animated-flow")){t.classed("flow-dashed",!1).classed("animated-flow",!1).classed("animated-flow-markers",!1).classed("highlight-path",!1);const e=o.flowConfig;("dashed"===e.style||e.dashed)&&t.classed("flow-dashed",!0)}o.flowConfig.highlightPath&&(e.highlightPath?t.classed("highlight-path",!0).attr("stroke",o.flowConfig.highlightPath.color||o.color).attr("stroke-width",o.flowConfig.highlightPath.width||1.5*e.width):e.id.includes("bundle-link")&&t.attr("stroke",o.color).attr("stroke-width",e.width))}})),e);e.attr("d",(e=>this.getLinkGenerator(e.sankey?.orientation)(e))).call(t),this.updateOffsetArrows()}}catch(e){}}trimPathEnd(e,t=.5){if(!e||e.length<5)return e;const o=e.split(/(?=[LMC])/);if(o.length<2)return e;const n=o[o.length-1],i=o[o.length-2];if("L"!==n[0]||"L"!==i[0])return e;const r=n.substring(1).split(",").map(Number),a=i.substring(1).split(",").map(Number);if(2!==r.length||2!==a.length)return e;const s=r[0]-a[0],l=r[1]-a[1],d=Math.sqrt(s*s+l*l);if(d<2*t)return e;const c=(d-t)/d,u=a[0]+s*c,p=a[1]+l*c;return o[o.length-1]=`L${u},${p}`,o.join("")}getArrowStyle(e,t,o=!1){const n={offset:8,trimStart:0,trimEnd:1,opacity:1,width:4,color:e.color};if(!e.flowConfig)return n;if(o&&e.flowConfig.junctionArrowStyle)return{...n,...e.flowConfig.arrowStyle,...e.flowConfig.junctionArrowStyle};let s={...n};if(e.flowConfig.arrowStyle&&(s={...s,...e.flowConfig.arrowStyle}),!e.flowConfig.groupArrowStyles||o)return s;let l="";if(t.dot?.type?.id){if(l=t.dot.type.id,l&&e.flowConfig.groupArrowStyles[l])return{...s,...e.flowConfig.groupArrowStyles[l]};if((0,a.isSuperdot)(t.dot)){const o=t.dot.id,n=i.state.view?.clumps.find((e=>e.superdot&&(0,a.superdotIDForClump)(e)===o));if(n){if(e.flowConfig.groupArrowStyles[n.group.id])return{...s,...e.flowConfig.groupArrowStyles[n.group.id]};const t=Object.keys(e.flowConfig.groupArrowStyles);for(const o of t){const t=r.VOTER_GROUPS[o]||Object.values(r.VOTER_GROUPS).find((e=>e.id===o));if(t&&n.group.sameTypesAs(t))return{...s,...e.flowConfig.groupArrowStyles[o]};if(t&&n.group.containsAllTypesFromGroup(t))return{...s,...e.flowConfig.groupArrowStyles[o]}}}}}return s}updateOffsetArrows(){if(!this.svgLinkGroup)return;this.svgLinkGroup.selectAll("path.link").filter((e=>{const t=e.sankey?.flowConfig;return"arrow"===t?.style||void 0!==t?.arrowStyle||void 0!==t?.groupArrowStyles||void 0!==t?.junctionArrowStyle})).each(((e,t,o)=>{const i=o[t],r=e.sankey;if(!r||!r.flowConfig)return;const a=e.id.includes("bundle-link"),s=this.getArrowStyle(r,e,a);let l=this.calculateOffsetPath(i,s.offset||8,s.trimStart||0,s.trimEnd||1);l=this.trimPathEnd(l,.5);const d=this.svgLinkGroup.selectAll("path.offset-arrow-path").filter((function(){return n.select(this).attr("d")===e.offsetArrowPath})),c=s.color||r.color,u=s.headColor||c,p=this.getOrCreateColoredMarker(u);d.size()>0?d.attr("d",l).attr("stroke",c).attr("stroke-width",s.width||4).style("opacity",s.opacity||1).attr("marker-end",`url(#${p})`):(this.svgLinkGroup.append("path").attr("class",`offset-arrow-path sankey-${r.id}`).attr("d",l).attr("stroke",c).attr("stroke-width",s.width||4).style("opacity",s.opacity||1).attr("marker-end",`url(#${p})`).lower(),this.svgLinkGroup.selectAll("path.link").raise()),e.offsetArrowPath=l}))}updateBundleLinkPositions(){const e=new Map,t=this.groupJunctionsByProximity(),o=new Map;t.forEach(((e,t)=>{e.forEach((e=>{o.set(e.id,e)}))})),this.links.forEach((t=>{if(!t.id.includes("bundle-link")||!t.sankey)return;const o=t.sankey,n=o.getImage();n&&(e.has(n)||e.set(n,[]),e.get(n).push({link:t,sankey:o}))})),e.forEach(((e,t)=>{if(e.length<=1){const{link:o,sankey:n}=e[0],i=t.position,r=t.imageElement;r&&(i.x=parseFloat(r.attr("x"))||i.x,i.y=parseFloat(r.attr("y"))||i.y),n.dotsAreSource()?(o.target.x=i.x,o.target.y=i.y):(o.source.x=i.x,o.source.y=i.y)}else this.distributeImageLinkEndpoints(t,e)})),t.forEach(((e,t)=>{if(e.length<=1)e.forEach((e=>{const t=this.links.find((t=>t.id===`${e.id}-bundle-link`));if(!t)return;const o=e.getJunctionCenter();e.dotsAreSource()?(t.source.x=o.x,t.source.y=o.y):(t.target.x=o.x,t.target.y=o.y)}));else{const t=[];if(e.forEach((e=>{const o=this.links.find((t=>t.id===`${e.id}-bundle-link`));o&&t.push({link:o,sankey:e})})),0===t.length)return;let o=0,n=0;e.forEach((e=>{e.isVertical()?o++:n++}));const i=o>=n,r=this.sortSankeysByDotPositions(t,i),a=r.reduce(((e,{sankey:t})=>e+t.totalThickness),0),s=r[0].sankey.getJunctionCenter();let l=i?s.x:s.y;l-=a/2;const d=i?s.y:s.x;let c=l;r.forEach((({link:e,sankey:t})=>{const o=t.totalThickness,n=c+o/2;if(t.dotsAreSource()){const t=e.source;t.x=i?n:d,t.y=i?d:n}else{const t=e.target;t.x=i?n:d,t.y=i?d:n}c+=o}))}}))}calculateSankeySpatialWeight(e,t){let o=0;if("image"===e.source.type&&e.source.offset?o=t?e.source.offset.x||0:e.source.offset.y||0:"image"===e.target.type&&e.target.offset&&(o=t?e.target.offset.x||0:e.target.offset.y||0),0!==o)return o;const n=e.getDotsForLinks();if(0===n.length)return 0;return n.reduce(((e,o)=>e+(t?o.x||0:o.y||0)),0)/n.length}sortSankeysByDotPositions(e,t){const o=new Map;return e.forEach((({sankey:e})=>{if(!o.has(e)){const n=this.calculateSankeySpatialWeight(e,t);o.set(e,n)}})),[...e].sort(((e,t)=>(o.get(e.sankey)||0)-(o.get(t.sankey)||0)))}distributeImageLinkEndpoints(e,t){if(t.length<=1)return;const o=t.reduce(((e,{sankey:t})=>e+t.totalThickness),0),n=e.position;let i=0,r=0;this.activeSankeys().forEach((e=>{e.isVertical()?i++:r++}));const a=i>=r,s=this.sortSankeysByDotPositions(t,a);let l=a?n.x:n.y;l-=o/2;let d=l;s.forEach((({link:e,sankey:t})=>{const o=t.totalThickness,i=d+o/2,r=t.getJunctionCenter();t.dotsAreSource()?(e.source.x=r.x,e.source.y=r.y,a?(e.target.x=i,e.target.y=n.y):(e.target.x=n.x,e.target.y=i)):(a?(e.source.x=i,e.source.y=n.y):(e.source.x=n.x,e.source.y=i),e.target.x=r.x,e.target.y=r.y),d+=o}))}reorderLinksByDotPositions(){if(!i.state.displayData.length)return;const e=[],t=new Set,o=new Map;this.activeSankeys().forEach((e=>{const t=e.getImage();t&&(o.has(t)||o.set(t,[]),o.get(t).push(e))}));let n=0,r=0;this.activeSankeys().forEach((e=>{e.isVertical()?n++:r++}));const a=n>=r;o.forEach(((e,t)=>{if(e.length<=1)return;const n=this.sortSankeysByDotPositions(e.map((e=>({link:{},sankey:e}))),a).map((e=>e.sankey));o.set(t,n)}));const s=[];o.forEach((e=>{e.forEach((e=>{s.includes(e)||s.push(e)}))})),this.activeSankeys().forEach((e=>{s.includes(e)||s.push(e)})),s.forEach((o=>{this.sortDotsByPosition(o.getDotsForLinks(),o.orientation).forEach(((n,i)=>{const r=o.getLinksForDot(n);0!==r.length&&r.forEach((o=>{e.push(o),t.add(o.id)}))}));const n=this.links.find((e=>e.id===`${o.id}-bundle-link`));n&&!t.has(n.id)&&(e.push(n),t.add(n.id))})),this.links.forEach((o=>{t.has(o.id)||e.push(o)})),this.links=e}updateLinkPositions(){this.reorderLinksByDotPositions(),this.links.forEach((e=>{if(e.id.includes("bundle"))return;if(!e.sankey)return;if(!e.dot)return;const t=e.dot;if(!i.state.displayData.find((e=>e.id===t.id))&&!i.state.superdots.find((e=>e.id===t.id)))return;const o=e.source.dot===e.dot,n=o?e.source:e.target,r=e.sankey.isHorizontal(),a=this.calculateDotConnectionOffset(e.dot,e.sankey);n.x=(e.dot.x||0)+(r?0:a),n.y=(e.dot.y||0)+(r?a:0)}))}getOrCreateColoredMarker(e){const t=`offset-arrow-${e.replace(/[^a-zA-Z0-9]/g,"-")}`;if(!document.getElementById(t)){const o=document.querySelector("svg");let i=o.querySelector("defs");i||(i=document.createElementNS("http://www.w3.org/2000/svg","defs"),o.appendChild(i));n.select(i).append("marker").attr("id",t).attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill",e).attr("stroke","none")}return t}createOffsetArrows(){if(!this.svgLinkGroup)return;this.svgLinkGroup.selectAll("path.offset-arrow-path").remove();this.svgLinkGroup.selectAll("path.link").filter((e=>{const t=e.sankey?.flowConfig;return"arrow"===t?.style||void 0!==t?.arrowStyle||void 0!==t?.groupArrowStyles||void 0!==t?.junctionArrowStyle})).each(((e,t,o)=>{const n=o[t],i=e.sankey;if(!i||!i.flowConfig)return;const r=e.id.includes("bundle-link"),a=this.getArrowStyle(i,e,r);let s=this.calculateOffsetPath(n,a.offset||8,a.trimStart||0,a.trimEnd||1);s=this.trimPathEnd(s,.5),e.offsetArrowPath=s;const l=a.color||i.color,d=a.headColor||l,c=this.getOrCreateColoredMarker(d);this.svgLinkGroup.append("path").attr("class",`offset-arrow-path sankey-${i.id}`).attr("d",s).attr("stroke",l).attr("stroke-width",a.width||4).style("opacity",a.opacity||1).attr("marker-end",`url(#${c})`).lower()})),this.svgLinkGroup.selectAll("path.link").raise()}ensureLinkVisibility(){try{this.svgLinkGroup?.selectAll(".link").style("display","block").style("visibility","visible"),this.svgLinkGroup?.selectAll(".offset-arrow-path").style("display","block").style("visibility","visible")}catch(e){}}getLinks(){return this.links}}},1114:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initVisualization=function(e){const t=n.select(`#${e}`).append("svg").attr("width",i.state.svgWidth).attr("height",i.state.svgHeight),o=t.append("defs");o.append("marker").attr("id","offset-arrow").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#00c000").attr("stroke","none");const a=o.append("marker").attr("id","animated-flow").attr("viewBox","0 0 40 10").attr("refX",20).attr("refY",5).attr("markerWidth",20).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","userSpaceOnUse");a.append("path").attr("d","M0,5L40,5").attr("class","flow-path"),a.append("circle").attr("cx",5).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-1"),a.append("circle").attr("cx",15).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-2"),a.append("circle").attr("cx",25).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-3"),a.append("circle").attr("cx",35).attr("cy",5).attr("r",1.5).attr("class","flow-circle flow-circle-4"),i.state.svgGroups.rearAnnotationsGroup=t.append("g").attr("class","rear-annotations"),i.state.svgGroups.linksGroup=t.append("g").attr("class","links"),i.state.svgGroups.dotsGroup=t.append("g").attr("class","dots"),i.state.svgGroups.imgGroup=t.append("g").attr("class","images"),i.state.svgGroups.frontAnnotationsGroup=t.append("g").attr("class","front-annotations"),function(){if(!i.state.svgGroups.dotsGroup)return;i.state.svgGroups.linksGroup?.lower(),i.state.svgGroups.dotsGroup.selectAll("circle.superdot").lower(),i.state.svgGroups.dotsGroup.selectAll("circle:not(.superdot)").raise()}(),i.state.svg=t;t.selectAll("circle").data(i.state.displayData.slice(1)).enter().append("circle").attr("r",i.state.dotRadius).attr("fill",(function(e){return e.primaryGroup.color||"#000"}));t.on("pointermove",d.pointerMoveHandler),t.on("pointerout",d.pointerOutHandler),u=i.state.linkManager=new r.LinkManager,u&&u.ensureLinkVisibility();return t.on("transitionend",(function(){u&&u.ensureLinkVisibility()})),t},t.cleanupVisualization=function(e){if(!e)return;u&&u.clearAll()},t.renderView=function(e,t=!0,o=!1){if(!i.state.svgGroups.dotsGroup)return;i.state.dotRadius=e.dotRadius;const r=e.clumps.filter((e=>!0===e.superdot)),d=(e.clumps.filter((e=>!0!==e.superdot)),i.state.displayData.slice(1).filter((e=>!(0,a.isSuperdot)(e))));i.state.svgGroups.dotsGroup.selectAll("circle:not(.superdot)").data(d,(e=>e.id)).join((e=>{const o=e.append("circle").attr("r",0).attr("fill",(e=>g(e))).style("opacity",0);return t?o.transition("voter-circles").duration(500).ease(n.easeCubicInOut).attr("r",i.state.dotRadius).style("opacity",(e=>null!=e.activeClump?.render?.opacity?e.activeClump.render.opacity:1)):o.attr("r",i.state.dotRadius).style("opacity",(e=>null!=e.activeClump?.render?.opacity?e.activeClump.render.opacity:1))}),(e=>t?e.transition("voter-circles").duration(500).ease(n.easeCubicInOut).attr("fill",(e=>g(e))).attr("r",i.state.dotRadius).style("opacity",(e=>null!=e.activeClump?.render?.opacity?e.activeClump.render.opacity:1)):e.attr("fill",(e=>g(e))).attr("r",i.state.dotRadius).style("opacity",(e=>null!=e.activeClump?.render?.opacity?e.activeClump.render.opacity:1))),(e=>t?e.transition("voter-circles").duration(500).ease(n.easeCubicInOut).style("opacity",0).remove():e.remove())),(0,a.renderSuperdotsFromClumps)(r,t),e.freeSankeyGroups&&e.freeSankeyGroups.forEach((e=>{const n=e.freeSankey;e.offset?n.junctionOffset=e.offset:n.resetJunctionOffset(),e.highlightLinks?n.highlightLinks=e.highlightLinks:n.highlightLinks=[],i.state.freeSankeys.includes(n)?(n.update(t?100:void 0),o&&n.updateLinkThicknesses()):(i.state.freeSankeys.push(n),n.createLinks())}));i.state.freeSankeys&&(i.state.freeSankeys.forEach((t=>{e.freeSankeyGroups?.some((e=>e.freeSankey===t))||t.clear()})),i.state.freeSankeys=i.state.freeSankeys.filter((t=>e.freeSankeyGroups?.some((e=>e.freeSankey===t)))));if(e.images){const o=i.state.images.filter((e=>e.active));e.images.forEach((e=>{e.position?e.image.position=e.position:e.image.resetPosition(),e.size?e.image.size=e.size:e.image.resetSize(),e.offset?(e.image._originalOffset||(e.image._originalOffset={...e.image.offset}),e.image.offset=e.offset):e.image._originalOffset&&(e.image.offset=e.image._originalOffset),i.state.images.includes(e.image)||i.state.images.push(e.image),o.includes(e.image)||e.image.show(),e.image.updateImage(t)}))}i.state.images.forEach((t=>{e.images?.some((e=>e.image===t))||t.hide()})),u?.setVisibleSankeys(e.sankeyGroups?.map((e=>e.sankey))||[]),(0,s.setTextForView)(e),(0,l.renderSvgAnnotations)(e,t)},t.renderAnnotations=function(){const e=n.annotationCallout,t=(n.timeParse("%d-%b-%y"),n.timeFormat("%d-%b-%y"),n.scaleTime().range([0,800]),n.scaleLinear().range([300,0]),n.annotation());t.editMode(!0).notePadding(15).type(e).annotations([{note:{label:"Longer text to show text wrapping",bgPadding:{top:15,left:10,right:10,bottom:10},title:"Annotations :)"},data:{date:"18-Sep-09",close:185.02},className:"show-bg",dy:137,dx:162}]),n.select("svg").append("g").attr("class","annotation-group").call(t)},t.ticked=function(){try{if(i.state.isStopped)return;i.state.svgGroups.dotsGroup?.selectAll("circle:not(.superdot)").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),i.state.superdots.length>0&&i.state.view&&function(){if(!i.state.view)return;i.state.view.clumps.filter((e=>!0===e.superdot)).forEach((e=>{let t=0,o=0,n=0;if(i.state.displayData.forEach((i=>{i.activeClump===e&&(t+=i.x||0,o+=i.y||0,n++)})),n>0){const r=t/n,s=o/n;i.state.superdots.find((t=>t.id===(0,a.superdotIDForClump)(e)))&&(0,a.updateSuperdot)(r,s,e)}}))}(),i.state.view?.freeSankeyGroups&&i.state.view.freeSankeyGroups.forEach((e=>{e.freeSankey.update()})),(0,s.updateTextPositions)(),(0,l.updateSvgAnnotationPositions)();const e=document.getElementById("simulation-info");e&&(e.innerHTML=`\n                <div>Alpha: ${i.state.simulation.alpha().toFixed(2)}</div>\n                <div>Dots: ${i.state.displayData.length}</div>\n                <div>Links: ${u?.getLinks().length}</div>\n                <div>Superdots: ${i.state.superdots.length}</div>\n                <div>Status: ${i.state.isStopped?"STOPPED":"Running"}</div>\n            `)}catch(e){}},t.calculateGroupCenters=p,t.getColorForDot=g,t.calculateClumpGroupCenters=function(e){const t=[],o=p(e.map((e=>e.group)));return e.forEach(((e,n)=>{const i=e.group,r=o.get(i);r&&t.push({groupIndex:n,x:r.x,y:r.y})})),t};const n=window.d3;window.d3.annotation;const i=o(3569),r=o(9185),a=o(2160),s=o(8297),l=o(7734),d=o(1795),c=o(6185);let u=null;function p(e){const t=new Map;return e.forEach((e=>{let o=0,n=0,r=0;i.state.displayData.forEach((t=>{e.shouldIncludeDot(t)&&(o+=t.x||0,n+=t.y||0,r++)})),r>0&&t.set(e,{x:o/r,y:n/r})})),t}function g(e){const t=i.state.view?.id;if(t&&void 0!==e.x&&void 0!==e.y){const o=c.gradientConfigs.filter((o=>o.viewId===t&&o.groupIds.includes(e.type.id)));if(o.length>0)return(0,c.calculateGradientColor)(e,o[0])}if(e.activeClump?.groupColorOverride){const t=new Map;if(e.activeClump?.groupColorOverride.forEach((e=>{e.group.types.forEach((o=>{t.set(o,e.color)}))})),t.has(e.type))return t.get(e.type)||"#000"}return e.type.color||"#000"}},4003:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Sankey=void 0;const n=window.d3,i=o(1613),r=o(1114),a=o(2160),s=o(3569);t.Sankey=class{id;description;orientation;totalThickness;color;source;target;active;flowConfig;constructor(e){this.id=e.id,this.description=e.description,this.orientation=e.orientation||"vertical",this.totalThickness=e.totalThickness,this.color=e.color||"rgba(255, 80, 176, 0.4)",this.source=e.source,this.target=e.target,this.active=e.active||!1,this.flowConfig=e.flowConfig||{style:"normal",animated:!1},this.validEndpoints()}getImage(){return"image"===this.source.type?this.source.image:"image"===this.target.type?this.target.image:void 0}getImageOffset(){return"image"===this.source.type?this.source.offset||{x:0,y:0}:"image"===this.target.type?this.target.offset||{x:0,y:0}:void 0}getJunctionCenter(){const e=this.getImage();if(!e)return{x:0,y:0};const t=this.getImageOffset()||{x:0,y:0};return{x:e.position.x+t.x,y:e.position.y+t.y}}getEndpointPositions(){let e={x:0,y:0},t={x:0,y:0};if("position"===this.source.type&&this.source.position&&(e=this.source.position),"position"===this.target.type&&this.target.position&&(t=this.target.position),"groups"===this.source.type){const t=this.source.groups;if(t){const o=t.map((e=>e.group)),n=i.VoterGroup.fromGroups(o),a=(0,r.calculateGroupCenters)([n]).get(n);a&&(e={x:a.x,y:a.y})}}if("groups"===this.target.type){const e=this.target.groups;if(e){const o=e.map((e=>e.group)),n=i.VoterGroup.fromGroups(o),a=(0,r.calculateGroupCenters)([n]).get(n);a&&(t={x:a.x,y:a.y})}}if("image"===this.source.type){const t=this.source.image,o=this.source.offset||{x:0,y:0};t&&(e={x:t.position.x+o.x,y:t.position.y+o.y})}if("image"===this.target.type){const e=this.target.image,o=this.target.offset||{x:0,y:0};e&&(t={x:e.position.x+o.x,y:e.position.y+o.y})}return{start:e,end:t}}getWeightedGroups(){return"groups"===this.source.type?this.source.groups:"groups"===this.target.type?this.target.groups:void 0}isHorizontal(){return"horizontal"===this.orientation}isVertical(){return"vertical"===this.orientation}linkThickness(e){const t=this.getWeightedGroups();if(!t)return 0;let o=[];if(t.forEach((t=>{if(t.useSuperdot){const n=(0,a.getSuperdotByGroup)(t.group);n&&(0,a.isSuperdot)(e)&&n===e&&o.push(t)}t.group.containsType(e.type)&&o.push(t)})),0==o.length)return 0;const n=(0,a.isSuperdot)(e)?1:o[0].group.dotCount,i=o.reduce(((e,t)=>e+t.percentage),0);return this.totalThickness*i/n}dotsAreSource(){return"groups"===this.source.type}dotsAreTarget(){return"groups"===this.target.type}isDotsToImage(){return"groups"===this.source.type&&"image"===this.target.type}isImageToDots(){return"image"===this.source.type&&"groups"===this.target.type}getLinks(){return s.state.linkManager?.getLinks().filter((e=>e.id.startsWith(`${this.id}-`)||e.id.startsWith(`${this.id}-bundle-`)))||[]}getLinksForDot(e){return this.getLinks().filter((t=>t.source.dot?.id===e.id||t.target.dot?.id===e.id))}ownsLink(e){return e.id.startsWith(`${this.id}-`)||e.id.startsWith(`${this.id}-bundle-`)}getPositionFromSuperdotToJunction(e,t=.5){let o=[],i="target";if("groups"===this.target.type&&this.target.groups&&(o=this.target.groups.filter((t=>t.group.id===e||t.group.name===e))),0===o.length&&"groups"===this.source.type&&this.source.groups&&(o=this.source.groups.filter((t=>t.group.id===e||t.group.name===e)),i="source"),0===o.length)return this.getJunctionCenter();o.length;const r=o[0].group,s=(0,a.getSuperdotByGroup)(r);if(s){const e=this.getLinksForDot(s);if(e.length>0){const o=e[0],i=n.select(`#${o.id}`);if(i.empty())return this.getJunctionCenter();const r=i.node();if(r){const e=r.getTotalLength(),o=r.getPointAtLength(e*t);return{x:o.x,y:o.y}}}return this.getJunctionCenter()}return{x:0,y:0}}getAllDots(){const e=this.getWeightedGroups();return e?s.state.displayData.filter((t=>t.type.belongsInGroups(e.map((e=>e.group))))):[]}getDotsForLinks(){const e=this.getWeightedGroups();if(!e)return[];const t=e.filter((e=>e.useSuperdot));if(t.length){const o=e.filter((e=>!e.useSuperdot)),n=[];return n.push(...i.VoterGroup.activeDots(o.map((e=>e.group)))),t.forEach((e=>{const t=(0,a.getSuperdotByGroup)(e.group);t?n.includes(t)||n.push(t):n.push(...i.VoterGroup.activeDots([e.group]))})),n}return this.getAllDots()}flowForDots(){return this.dotsAreSource()?"outgoing":this.dotsAreTarget()?"incoming":void 0}removeFromDotData(){this.getAllDots().forEach((e=>e.sankeys.delete(this)))}addToDotData(){const e=this.getAllDots(),t=this.flowForDots();t&&e.forEach((e=>e.sankeys.set(this,t)))}allSankeysInSameDirectionForDot(e){return Array.from(e.sankeys.entries()).filter((([e,t])=>t===this.flowForDots()&&e.active)).map((([e])=>e))}validEndpoints(){return(!this.isDotsToImage()||!this.isImageToDots())&&!(!this.dotsAreSource()&&!this.dotsAreTarget())}}},7517:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSimulation=function(){(0,s.updateDisplayData)(),r.state.simulation=n.forceSimulation(r.state.displayData).alpha(1).alphaTarget(.1).velocityDecay(.3).on("tick",i.ticked);n.select("body")},t.simulateView=function(e,t=!0){if(!e)return;r.state.dotRadius=e.dotRadius;let o=e.forceStrength?.collide||r.state.dotRadius*a.COLLIDE_DISTANCE_MULT,i=e.forceStrength?.charge||r.state.dotRadius*a.DOT_CHARGE_STRENGTH;e.forceStrength?.chargeMultiplier&&(i*=e.forceStrength.chargeMultiplier);e.forceStrength?.collideMultiplier&&(o*=e.forceStrength.collideMultiplier);const s=e.forceStrength?.standard||a.GROUPED_FORCE_STRENGTH,d=e.forceStrength?.radial||a.RADIAL_STRENGTH;if(r.state.simulation.force("x",n.forceX((t=>t.activeClump&&!t.activeClump.force?r.state.svgWidth/2:(0,l.isCustomForce)(t.activeClump?.force)?t.activeClump.force.center?.x??r.state.svgWidth/2:e.center?e.center.x:r.state.svgWidth/2)).strength((e=>e.activeClump&&!e.activeClump.force?s:(0,l.isCustomForce)(e.activeClump?.force)?e.activeClump&&e.activeClump.force?.strength?e.activeClump.force.strength:s:0))).force("y",n.forceY((t=>t.activeClump&&!t.activeClump.force?r.state.svgHeight/2:(0,l.isCustomForce)(t.activeClump?.force)?t.activeClump.force.center?.y??r.state.svgHeight/2:e.center?e.center.y:r.state.svgHeight/2)).strength((e=>e.activeClump&&!e.activeClump.force?s:(0,l.isCustomForce)(e.activeClump?.force)?e.activeClump&&e.activeClump.force?.strength?e.activeClump.force.strength:s:0))).force("radial",n.forceRadial((e=>{if((0,l.isRadialForce)(e.activeClump?.force)){e.radialAssignment||=Math.random();const t=e.activeClump.force.boundary;return t.inner+e.radialAssignment*(t.outer-t.inner)}return 0}),e.center?.x||r.state.svgWidth/2,e.center?.y||r.state.svgHeight/2).strength((e=>(0,l.isRadialForce)(e.activeClump?.force)?e.activeClump&&e.activeClump.force?.strength?e.activeClump.force.strength:d:0))),r.state.simulation.force("collide",n.forceCollide(o).iterations(3)).force("charge",n.forceManyBody().strength(((e,t)=>0===t?r.state.dotRadius*a.MOUSE_CHARGE_STRENGTH:i))),r.state.simulation.nodes(r.state.displayData),t){const e=1;r.state.simulation.alpha(e).restart()}else r.state.simulation.tick(1)},t.addCursorNode=function(){const e=a.CURSOR_NODE_DATA;r.state.displayData.unshift(e),r.state.cursorNode=e},t.removeCursorNode=function(){if(!r.state.cursorNode)return;r.state.displayData=r.state.displayData.slice(1),r.state.cursorNode=null};const n=window.d3,i=o(1114),r=o(3569),a=o(6921),s=o(9646),l=o(6185)},3569:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.state=void 0,t.setTweenView=function(e){t.state.view=e,(0,s.updateDisplayData)(e),(0,i.renderView)(e,!t.state.isTweening),(0,n.simulateView)(e,!t.state.isTweening),t.state.isTweening=!0},t.createTweenView=function(e,o,n){const i=[],r=[];e.clumps.forEach((e=>{let t=!1;o.clumps.forEach((o=>{e.group.sameTypesAs(o.group)&&e.force?.type===o.force?.type&&(i.push([e,o]),t=!0)})),t||r.push(e)}));const s=i.map((([e,o])=>{const i={...e},r=e.render?.opacity??1,s=o.render?.opacity??1;let l,d,u,p;i.render={...i.render,opacity:r+(s-r)*n};const g=(0,c.isCustomForce)(e.force)?a.GROUPED_FORCE_STRENGTH:a.RADIAL_STRENGTH,h=e.force?.strength,f=o.force?.strength??g;let m;if(h&&(m=h+(f-h)*n),e.force?.type&&"custom"!==e.force.type||o.force?.type&&"custom"!==o.force.type){if("radial"!==e.force?.type||"radial"!==o.force?.type)return i;l=e.force.boundary.inner,d=e.force.boundary.outer,u=o.force.boundary.inner,p=o.force.boundary.outer}else e.force?.center&&o.force?.center?(l=e.force.center.x,d=e.force.center.y,u=o.force.center.x,p=o.force.center.y):(l=u=t.state.svgWidth/2,d=p=t.state.svgHeight/2);const y=l+(u-l)*n,O=d+(p-d)*n;return i.force?.type&&"custom"!==i.force.type?"radial"===i.force.type&&(i.force={...i.force,boundary:{inner:y,outer:O}}):i.force={...i.force,type:"custom",strength:m,center:{x:y,y:O}},i}));let l=e.forceStrength?.charge??0;if(e.forceStrength?.charge&&o.forceStrength?.charge){const t=e.forceStrength.charge;l=t+(o.forceStrength.charge-t)*n}let d=e.forceStrength?.collide??0;if(e.forceStrength?.collide&&o.forceStrength?.collide){const t=e.forceStrength.collide;d=t+(o.forceStrength.collide-t)*n}const u=[];e.images&&o.images&&e.images.forEach((e=>{const t=o.images?.find((t=>t.image.id===e.image.id));t&&u.push([e,t])}));const p=u.map((([e,t])=>{const o={image:e.image,position:{x:e.image.position.x||e.image.initPosition.x,y:e.image.position.y||e.image.initPosition.y},size:{width:e.image.size.width||e.image.initSize.width,height:e.image.size.height||e.image.initSize.height}},i=e.position??e.image.initPosition,r=t.position??t.image.initPosition;o.position={x:i.x+(r.x-i.x)*n,y:i.y+(r.y-i.y)*n},o.image.position=o.position;const a=e.size??e.image.initSize,s=t.size??t.image.initSize;return o.size={width:a.width+(s.width-a.width)*n,height:a.height+(s.height-a.height)*n},o.image.size=o.size,o})),g=e.images?.filter((e=>!u.some((([t,o])=>t.image.id===e.image.id))))||[];return{...e,id:e.id+"_tweened_"+n,clumps:[...s,...r],dotRadius:e.dotRadius+(o.dotRadius-e.dotRadius)*n,forceStrength:{...e.forceStrength,charge:l,collide:d},images:[...p,...g]}},t.requestView=function e(o){if(t.state.view?.id===o.id)return;if(t.state.upcomingView=o,t.state.viewThrottle)return;(function(e){t.state.isTweening=!1;const o=t.state.view;o&&e!==o&&(0,i.cleanupVisualization)(o);if(t.state.lockedToAverageYears=e.requireAverageYears||!1,t.state.lockedToAverageYears&&"Average 2016-2022"!==t.state.currentYear)return void t.state.setYear("Average 2016-2022");if(!t.state.lockedToAverageYears){const o=new Set;e.clumps.forEach((e=>{e.ignoreYear||e.group.types.forEach((e=>{const t=Object.keys(a.VOTER_TYPES).find((t=>a.VOTER_TYPES[t].id===e.id));t&&o.add(t)}))}));let n=!0;for(const e of o)if(void 0===t.state.yearData[t.state.currentYear][e]){n=!1;break}if(!n)return void t.state.setYear("Average 2016-2022")}t.state.view=e,(0,s.updateDisplayData)(e),(0,i.renderView)(e),(0,n.simulateView)(e),t.state.activeDotTypes=new Set,e.clumps.forEach((e=>{e.group.types.forEach((e=>{t.state.seenDotTypes.add(e.id),t.state.activeDotTypes.add(e.id)})),"Above the tax threshold"!==e.group.id&&"Below the tax threshold"!==e.group.id||(t.state.seenDotTypes.add(e.group.id),t.state.activeDotTypes.add(e.group.id))})),"function"==typeof d.updateLegend&&(0,d.updateLegend)();e.onLoad&&e.onLoad();"function"==typeof window.updateYearSelectorUI&&setTimeout(window.updateYearSelectorUI,100)})(o),t.state.upcomingView=null,t.state.viewThrottle=!0,setTimeout((()=>{t.state.viewThrottle=!1,t.state.upcomingView&&e(t.state.upcomingView)}),600)};const n=o(7517),i=o(1114),r=o(1613),a=o(6921),s=o(9646),l=o(6610),d=o(4391),c=o(6185),u=o(600);t.state={importedData:[],displayData:[],flattenedData:[],isDistributed:!1,isSeparate:!1,isAutoRadius:!0,outlinesVisible:!1,view:null,dotRadius:2,superdots:[],images:[],svg:null,svgWidth:700,svgHeight:700,simulation:null,cursorNode:null,svgGroups:{},linkManager:null,freeSankeys:[],disableCursorPush:!1,isStopped:!1,upcomingView:null,viewThrottle:!1,isTweening:!1,seenDotTypes:new Set,activeDotTypes:new Set,legendVisible:!0,currentYear:"Average 2016-2022",availableYears:[],yearData:{},flowData:{},freeFlowData:{},lockedToAverageYears:!1,toggleGrouping(){this.isDistributed=!this.isDistributed},setDisplayData(e){this.displayData=e},setDotRadius(e){this.dotRadius=e},stopSimulation(){this.simulation&&(this.simulation.alphaTarget(0).stop(),this.isStopped=!0)},resumeSimulation(){this.simulation&&(this.simulation.alphaTarget(.1).restart(),this.isStopped=!1)},setYear(e){if(this.lockedToAverageYears&&"Average 2016-2022"!==e)return;if(!this.yearData[e])return;this.currentYear=e;const o=new Map;if(t.state.displayData.forEach((e=>{"number"==typeof e.x&&"number"==typeof e.y&&o.set(e.id,{x:e.x,y:e.y,vx:e.vx||0,vy:e.vy||0})})),Object.keys(a.VOTER_TYPES).forEach((t=>{void 0!==this.yearData[e][t]&&(a.VOTER_TYPES[t].dotCount=this.yearData[e][t])})),Object.keys(a.VOTER_GROUPS).forEach((e=>{a.VOTER_GROUPS[e].updateDotCount()})),t.state.flattenedData=(0,s.flattenData)(Object.values(a.VOTER_TYPES)),this.flowData[e]&&(0,l.updateFlowSankeys)(),this.view){const e={...this.view};(0,s.updateDisplayData)(e),t.state.displayData.forEach((e=>{const t=o.get(e.id);t&&(e.x=t.x,e.y=t.y,e.vx=t.vx,e.vy=t.vy)})),(0,i.renderView)(e,!0,!0),(0,n.simulateView)(e)}"function"==typeof window.updateYearSelectorUI&&window.updateYearSelectorUI(),"function"==typeof window.updateSvgAnnotationText&&window.updateSvgAnnotationText()},yearHasDataForActiveTypes(e){if(!this.view)return!1;const t=new Set,o=new Set;if(this.view.clumps.forEach((e=>{e.ignoreYear&&e.group.types.forEach((e=>{o.add(e.id)}))})),this.displayData.forEach((e=>{e.type.id===a.VOTER_TYPES.SUPERDOT.id||e.type.id===a.VOTER_TYPES.MOUSE.id||o.has(e.type.id)||t.add(e.type.id)})),0===t.size)return!0;for(const o of t){const t=Object.keys(a.VOTER_TYPES).find((e=>a.VOTER_TYPES[e].id===o));if(!t||void 0===this.yearData[e][t])return!1}return!0},getFlowPercentages(e,t,o){if(!this.flowData[e])return{};const n={},i=o?this.flowData[e][o]:t.reduce(((t,o)=>t+(this.flowData[e][o]||0)),0);return i<=0?{}:(t.forEach((t=>{void 0!==this.flowData[e][t]?n[t]=this.flowData[e][t]/i:n[t]=0})),n)},formatFlowAmount(e,t,o){if(!this.flowData[e]||void 0===this.flowData[e][t])return"$0";if(o){return`$${(this.flowData[e][t]/1e6).toFixed(1)} Million`}return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(this.flowData[e][t])},formatFreeFlowAmount(e,t,o,n){if(!t.dataKey)return"No data key";if(!this.freeFlowData[t.dataKey]||!this.freeFlowData[t.dataKey][e])return"Can't find data";const i=this.freeFlowData[t.dataKey],a=i[e];let s=0;if("credit"===o||"inflow"===o)s=a.inflow??0;else if("donation"===o||"outflow"===o)s=a.outflow??0;else if("count"===o)s=a.count??0;else{if("outOfPocket"!==o)return"Unknown flow type";s=(0,r.outOfPocketForYear)(i,e)}return n?(s/1e6).toFixed(1)+" "+(0,u.t)("common.million"):"count"===o?s.toLocaleString():new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(s)},formatPercentageOfFreeFlow(e,t,o,n){if(!t.dataKey||!o.dataKey)return"No data key";let i=0,a=0;if("donation"===n)i=this.freeFlowData[t.dataKey][e].outflow??0,a=this.freeFlowData[o.dataKey][e].outflow??0;else if("credit"===n)i=this.freeFlowData[t.dataKey][e].inflow??0,a=this.freeFlowData[o.dataKey][e].inflow??0;else if("outOfPocket"===n)i=(0,r.outOfPocketForYear)(this.freeFlowData[t.dataKey],e),a=(0,r.outOfPocketForYear)(this.freeFlowData[o.dataKey],e);else{if("count"!==n)return"Unknown flow type";i=this.freeFlowData[t.dataKey][e].count??0,a=this.freeFlowData[o.dataKey][e].count??0}return 0===i||0===a?"No data":(i/a*100).toFixed(0)+"%"}}},2160:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperdot=function(e){return(0,s.isDotData)(e)&&e.type===r.VOTER_TYPES.SUPERDOT},t.getSuperdotByGroup=function(e){return i.state.superdots.find((t=>t.viewClump.group.containsAllTypesFromGroup(e)))},t.createSuperdots=l,t.createSuperdot=d,t.superdotIDForClump=c,t.superdotIDForGroup=u,t.clearAllSuperdots=function(){i.state.svgGroups.dotsGroup?.selectAll("circle.superdot").transition("superdot-remove").duration(650).ease(n.easePolyInOut).attr("r",0).style("opacity",0).remove(),i.state.svgGroups.dotsGroup?.selectAll("circle.superdot").remove(),i.state.superdots=[]},t.renderSuperdotsFromClumps=function(e,t=!0){const o=[],n=[];e.forEach((e=>{if(e.render?.disable)return;const t=i.state.superdots.find((t=>t.id===c(e)));t?e.superdot&&(t.viewClump=e,n.push(t)):o.push(e)}));const r=l(o);p([...n,...r],t)},t.renderSuperdots=p,t.updateSuperdot=function(e,t,o){try{const n=c(o),r=i.state.svgGroups.dotsGroup?.select(`#${n}`);let a=0;i.state.displayData.forEach((n=>{if(n.activeClump===o){const o=(n.x||0)-e,r=(n.y||0)-t,s=Math.sqrt(o*o+r*r)+i.state.dotRadius;a=Math.max(a,s)}}));const s=Math.max(25,2*i.state.dotRadius);let l=0;i.state.displayData.forEach((e=>{e.activeClump===o&&l++}));let d=1.05;const u=Math.max(s,a*d),p=Math.sqrt(l)*i.state.dotRadius*1.5,g=1.8,h=i.state.superdots.find((e=>e.id===n)),f=g*p;let m;if(h)if(u<f)m=u;else{const e=.1;m=f+(u-f)*Math.exp(-e*(u-f))}else m=u;r&&!r.empty()&&(r.attr("cx",e).attr("cy",t).attr("r",m).attr("stroke-width",4).lower(),h&&(h.x=e,h.y=t,h.radius=m))}catch(e){}};const n=window.d3,i=o(3569),r=o(6921),a=o(1114),s=o(6185);function l(e){if(0===e.length)return[];const t=(0,a.calculateClumpGroupCenters)(e),o=[];return t.forEach((t=>{const n=e[t.groupIndex];n.render?.disable||o.push(d(t,n))})),o}function d(e,t){const o=i.state.superdots.find((e=>e.id===c(t)));if(o)return o.x=e.x,o.y=e.y,o;let s=0;const l=t,d=i.state.displayData.filter((e=>e.activeClump===l)),u=d.length;d.forEach((t=>{const o=(t.x||0)-e.x,n=(t.y||0)-e.y,r=Math.sqrt(o*o+n*n)+i.state.dotRadius;s=Math.max(s,r)}));const p=Math.max(25,2*i.state.dotRadius);let g=1.05;u>100&&(g=1.03),u>500&&(g=1.02);const h=Math.max(p,s*g);let f=1.8*Math.sqrt(u);u>1e3&&(f=2.2*Math.sqrt(u));const m=Math.max(h,f,p);let y,O="rgba(246, 246, 246, 0.95)";l.groupColorOverride&&l.groupColorOverride?.forEach((e=>{if(e.group.types.includes(r.VOTER_TYPES.SUPERDOT)){const t=n.color(e.color);t&&(O=t.toString(),y=O)}}));let _="#999",b=0,w=0,v=0,x=0;if(d.forEach((e=>{const t=n.color((0,a.getColorForDot)(e));if(t){const e=n.rgb(t);b+=e.r,w+=e.g,v+=e.b,x++}})),x>0){const e=Math.round(b/x),t=Math.round(w/x),o=Math.round(v/x),i=.5;_=n.rgb(Math.min(255,e*(1-i)+255*i),Math.min(255,t*(1-i)+255*i),Math.min(255,o*(1-i)+255*i)).toString()}const S={id:c(l),viewClump:l,x:e.x,y:e.y,type:r.VOTER_TYPES.SUPERDOT,radius:m,fillColor:O,strokeColor:_,sankeys:new Map};return i.state.superdots.push(S),S}function c(e){return u(e.group)}function u(e){return`superdot-${e.typeKey}`}function p(e,t=!0){if(!i.state.svgGroups.dotsGroup)return;i.state.svgGroups.dotsGroup.selectAll("circle.superdot").data();const o=i.state.svgGroups.dotsGroup.selectAll("circle.superdot").data(e,(e=>e.id)),r=o.enter().append("circle").attr("class","superdot").attr("id",(e=>e.id)).attr("cx",(e=>isNaN(e.x)?0:e.x)).attr("cy",(e=>isNaN(e.y)?0:e.y)).attr("r",(e=>isNaN(e.radius)?25:e.radius)).attr("fill",(e=>e.fillColor)).attr("stroke",(e=>{if(e.viewClump?.render&&1!=e.viewClump.render.opacity){return n.hsl(e.strokeColor||"#999").brighter(.4).formatRgb()}return e.strokeColor||"#999"})).attr("stroke-width",4).style("opacity",0).style("transform-box","fill-box").style("transform-origin","center").style("transform","scale(0.01)");t?r.transition("superdot-in").duration(800).ease(n.easeCubicInOut).style("transform","scale(1)").style("opacity",1):r.style("transform","scale(1)").style("opacity",(e=>1)),o.attr("cx",(e=>isNaN(e.x)?0:e.x)).attr("cy",(e=>isNaN(e.y)?0:e.y)).attr("r",(e=>isNaN(e.radius)?25:e.radius)).attr("fill",(e=>e.fillColor)).attr("stroke",(e=>{if(e.viewClump?.render&&1!=e.viewClump.render.opacity){return n.hsl(e.strokeColor||"#999").brighter(.4).formatRgb()}return e.strokeColor||"#999"})).lower(),t?o.transition("superdot-update").duration(800).ease(n.easeCubicInOut).style("transform","scale(1)").style("opacity",(e=>1)):o.style("transform","scale(1)").style("opacity",(e=>1));o.exit().transition("superdot-out").duration(400).ease(n.easeCubicInOut).style("transform","scale(0)").style("opacity",0).on("end",(function(){const e=n.select(this).attr("id");i.state.superdots.find((t=>t.id===e))||n.select(this).remove()})).each((function(e){const t=i.state.superdots.findIndex((t=>t.id===e.id));-1!==t&&i.state.superdots.splice(t,1)}))}},8297:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTextForView=function(e){if(!i.state.svgGroups.frontAnnotationsGroup)return;const t=[],o=[],a=p();e.sankeyGroups?.length&&e.sankeyGroups.some((e=>e.textAnnotations?.length))&&e.sankeyGroups.forEach((e=>{const n=e.textAnnotations||[];if(n.length>0){const i=e.sankey;n.forEach((e=>{const n=a?.filter((t=>t.id===e.id));if(n&&n.size()>0)return void o.push(n);const r="function"==typeof e.text?e.text():e.text||i.id,s=g({target:i,text:e.text||r,id:e.id||`text-${i.id}-${r.replace(/\s/g,"-")}`,targetAnchorLink:e.targetAnchorLink||"junction",textAnchor:e.textAnchor||"end",targetOffset:e.targetOffset||{x:0,y:0},classes:["sankey-label"],color:e.color||"green"});s&&t.push(s)}))}}));e.clumps.length&&e.clumps.some((e=>e.textAnnotations?.length))&&e.clumps.forEach((e=>{const n=e.textAnnotations||[];n.length>0&&n.forEach((n=>{const s=n.text||e.group.name;if(e.superdot){const d=i.state.superdots.find((t=>(0,r.sameTypesInClumps)(e,t.viewClump)));if(!d)return;const c=a?.filter((e=>e.id===n.id));if(c&&c.size()>0)return void o.push(c);const u="function"==typeof s?s():s,p=g({target:d,text:s,id:n.id||`text-${e.group.name}-${u.replace(/\s/g,"-")}`,targetAnchorX:n.targetAnchorX||"middle",targetAnchorY:n.targetAnchorY||"middle",textAnchor:n.textAnchor||"middle",targetOffset:n.targetOffset||{x:0,y:0},classes:["superdot-label"],color:n.color||l.typeColors.purple});p&&t.push(p)}else{const i=a?.filter((e=>e.id===n.id));if(i&&i.size()>0)return void o.push(i);const r="function"==typeof s?s():s,d=g({target:e.group,text:s,id:n.id||`text-${e.group.name}-${r.replace(/\s/g,"-")}`,targetAnchorX:n.targetAnchorX||"middle",targetAnchorY:n.targetAnchorY||"middle",textAnchor:n.textAnchor||"middle",targetOffset:n.targetOffset||{x:0,y:0},classes:["clump-label"],color:n.color||l.typeColors.purple});d&&t.push(d)}}))}));e.textAnnotations?.length&&e.textAnnotations.forEach((e=>{const n=a?.filter((t=>t.id===e.id));if(n&&n.size()>0)return void o.push(n);const i=g(e);i&&t.push(i)}));f();const s=o.map((e=>e.datum().id));a?.filter((e=>!s.includes(e.id))).transition("text-out").duration(500).style("opacity",0).on("end",(function(){n.select(this).remove()}))},t.addText=g,t.updateTextPositions=f;const n=window.d3,i=o(3569),r=o(6185),a=o(4003),s=o(1613),l=o(6921),d=o(2636),c=o(2160),u=o(1114);function p(){return i.state.svgGroups.frontAnnotationsGroup?i.state.svgGroups.frontAnnotationsGroup.selectAll("text"):null}function g(e){if(!i.state.svgGroups.frontAnnotationsGroup)return null;const t=h(e),o="function"==typeof e.text?e.text():e.text,n="string"==typeof o?o.replace(/\s/g,"-"):"dynamic-text";e.id=e.id||`text-${n}`;const r=i.state.svgGroups.frontAnnotationsGroup.append("text").attr("id",e.id).attr("class",e.classes?.join(" ")||"").datum(e).attr("x",t.x).attr("y",t.y).text(o).attr("text-anchor",e.textAnchor||"middle").style("font-size",e.size||"").style("fill",e.color||"").style("font-family",e.font||"").style("opacity",0);return r.transition(`text-in-${e.id}`).duration(500).style("opacity",1),r}function h(e){let t={x:0,y:0},o={left:0,right:0,top:0,bottom:0},n={start:{x:0,y:0},end:{x:0,y:0}},l={x:0,y:0};if((0,r.isDotData)(e.target)&&!(0,c.isSuperdot)(e.target))t={x:e.target.x||0,y:e.target.y||0},o={left:t.x-i.state.dotRadius,right:t.x+i.state.dotRadius,top:t.y-i.state.dotRadius,bottom:t.y+i.state.dotRadius};else if((0,c.isSuperdot)(e.target))t={x:e.target.x||0,y:e.target.y||0},o={left:t.x-e.target.radius,right:t.x+e.target.radius,top:t.y-e.target.radius,bottom:t.y+e.target.radius};else if(e.target instanceof d.SimImage){const n=e.target.position;t={x:n.x,y:n.y},o={left:t.x-e.target.size.width/2,right:t.x+e.target.size.width/2,top:t.y-e.target.size.height/2,bottom:t.y+e.target.size.height/2}}else e.target instanceof a.Sankey?(t=e.target.getJunctionCenter(),n=e.target.getEndpointPositions()):e.target instanceof s.VoterGroup?t=(0,u.calculateGroupCenters)([e.target]).get(e.target):(t=e.target,o={left:t.x,right:t.x,top:t.y,bottom:t.y});return e.target instanceof a.Sankey?l="start"===e.targetAnchorLink?n.start:"end"===e.targetAnchorLink?n.end:t:("left"===e.targetAnchorX?l.x=o.left:"right"===e.targetAnchorX?l.x=o.right:l.x=t.x,"top"===e.targetAnchorY?l.y=o.top:"bottom"===e.targetAnchorY?l.y=o.bottom:l.y=t.y),{x:l.x+(e.targetOffset?.x||0),y:l.y+(e.targetOffset?.y||0)}}function f(){const e=p();if(e){const t=new Map;e?.each((e=>{if(t.set(e.id,h(e)),"function"==typeof e.text){const t=e.text(),o=n.select(`#${e.id}`);o.empty()||o.text(t)}})),e.attr("x",(e=>t.get(e.id).x)).attr("y",(e=>t.get(e.id).y))}}},3414:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTranslations=i,t.initTranslations=function(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{setTimeout(i,100)})):setTimeout(i,100)};const n=o(600);function i(){document.title=(0,n.t)("page.title");document.querySelectorAll("[data-i18n-group]").forEach((e=>{const t=e.getAttribute("data-i18n-group");if(t){e.querySelectorAll("[data-i18n]").forEach((e=>{const o=e.getAttribute("data-i18n");o&&(e.innerHTML=(0,n.t)(t+"."+o))}))}}))}},1613:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VoterGroup=t.VoterType=void 0,t.sumFlowData=i,t.flowDataForSingleDot=function(e){const t=Object.keys(e),o={};return t.forEach((t=>{o[t]={inflow:(e[t].inflow??0)/(e[t].count??1),outflow:(e[t].outflow??0)/(e[t].count??1),count:1}})),o},t.isFlowType=function(e){return"inflow"===e||"outflow"===e||"count"===e},t.outOfPocketForYear=function(e,t){return(e[t].outflow??0)-(e[t].inflow??0)};window.d3;const n=o(3569);function i(e){if(0===e.length)return{};if(1===e.length)return e[0];const t={};return e.forEach((e=>{Object.keys(e).forEach((o=>{t[o]??={},t[o]={inflow:(t[o].inflow??0)+(e[o].inflow??0),outflow:(t[o].outflow??0)+(e[o].outflow??0),count:(t[o].count??0)+(e[o].count??0)}}))})),t}t.VoterType=class{id;name;color;dotCount;constructor(e,t,o){this.id=e,this.name=t,this.color=o,this.dotCount=0}belongsInClump(e){return e.group.containsType(this)&&!e.render?.disable}belongsInView(e){return e.clumps.some((e=>this.belongsInClump(e)))}matchedClumpInView(e){return e.clumps.find((e=>this.belongsInClump(e)))}belongsInGroups(e){return e.some((e=>e.containsType(this)))}};class r{types;id;typeKey;dataKey;name;dotCount;flowData;dotFlowData;constructor(e,t,o){this.types=e,this.id=t,this.name=o,this.dotCount=this.getDotCount();const n=this.types.slice().sort(((e,t)=>e.id.localeCompare(t.id)));this.typeKey=n.map((e=>e.id.replace(/[^a-zA-Z0-9]/g,"-"))).join("-")}updateDotCount(){this.dotCount=this.getDotCount()}getDotCount(){return this.types.reduce(((e,t)=>e+t.dotCount),0)}containsType(e){return this.types.includes(e)}shouldIncludeDot(e){return this.types.includes(e.type)}belongsInView(e){return e.clumps.some((e=>this.belongsInClump(e)))}belongsInClump(e){return this.types.some((t=>e.group.containsType(t)))}indexInClump(e){return e.group.types.findIndex((t=>e.group.containsType(t)))}sameTypesAs(e){return this.types.length===e.types.length&&this.types.every((t=>e.containsType(t)))}containsAllTypesFromGroup(e){return e.types.every((e=>this.containsType(e)))}activeDots(){return n.state.displayData.filter((e=>this.shouldIncludeDot(e)))}static fromType(e){return new r([e],e.id,e.name)}static fromTypes(e,t,o){return new r(e,t??e.map((e=>e.id)).join("-"),o??e.map((e=>e.name)).join(" + "))}static fromGroups(e,t,o){const n=new r(e.flatMap((e=>e.types)),t??e.map((e=>e.id)).join("-"),o??e.map((e=>e.name)).join(" + "));return n.flowData=i(e.map((e=>e.flowData??{}))),n.dotFlowData=i(e.map((e=>e.dotFlowData??{}))),n}static activeDots(e){const t=[];return e.forEach((e=>t.push(...e.activeDots()))),t}}t.VoterGroup=r},6185:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gradientConfigs=void 0,t.fadeHexColor=function(e,t){const o=n.rgb(e);return o.opacity=t,o.toString()},t.forceType=s,t.isCustomForce=function(e){return"custom"===s(e)},t.isRadialForce=function(e){return"radial"===s(e)},t.isDotData=function(e){return e&&e.id&&e.type&&e.type instanceof i.VoterType},t.freeSankeyLinksForDot=function(e){const t=r.state.view;if(!t)return[];const o=t.freeSankeyGroups;if(!o)return[];const n=o.flatMap((e=>e.freeSankey)).flatMap((t=>{const o=t.linkForDot(e);return o?[o]:[]}));return n},t.freeSankeysForTarget=function(e){const t=r.state.view;if(!t)return[];const o=t.freeSankeyGroups;if(!o)return[];const n=e instanceof a.SimImage,i=o.flatMap((e=>e.freeSankey)).filter((t=>{const o=t.getTarget(),i=o instanceof a.SimImage;return!(i&&!n||!i&&n)&&(n&&i?e===o:!n&&!i&&(e.x===o.x&&e.y===o.y))}));return i},t.interpolateColor=l,t.calculateGradientColor=function(e,t){const o=t.center||{x:r.state.svgWidth/2,y:r.state.svgHeight/2},n=void 0!==e.x?e.x:o.x,i=void 0!==e.y?e.y:o.y,a=Math.sqrt(Math.pow(n-o.x,2)+Math.pow(i-o.y,2)),s=t.maxDistance||350,d=void 0!==t.threshold?t.threshold:1,c=t.power||1;let u=Math.min(a/s,1);if(u>d)return t.outerColor;1!==c&&(u=Math.pow(u,c));return l(t.innerColor,t.outerColor,u)},t.sameTypesInClumps=function(e,t){return e.group.sameTypesAs(t.group)},t.getDotInfo=function(e){const t=document.querySelector("svg"),[o,i]=n.pointer(e,t),a=n.select(t).selectAll("circle").filter((function(){const e=parseFloat(this.getAttribute("cx")||"0"),t=parseFloat(this.getAttribute("cy")||"0"),n=parseFloat(this.getAttribute("r")||"0");return Math.sqrt((o-e)**2+(i-t)**2)<=n})).node();if(a){const e=n.select(a).datum();let t;return t=-1!==e.id.indexOf("superdot")?e.fillColor:e.type.color,n.select(a).attr("fill","red"),setTimeout((()=>{n.select(a).attr("fill",t)}),1e3),`ID: ${e.id}<br />\n                Type: ${e.type.name}<br />\n                Clump: ${e.type.matchedClumpInView(r.state.view)?.group.name}<br />\n                Sankeys: ${e.sankeys.size}<br />`}return"No circle found"};const n=window.d3,i=o(1613),r=o(3569),a=o(2636);function s(e){return e?void 0===e.type||"custom"===e.type?"custom":e.type:null}function l(e,t,o){const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),a=parseInt(t.slice(1,3),16),s=parseInt(t.slice(3,5),16),l=parseInt(t.slice(5,7),16),d=Math.round(n+(a-n)*o),c=Math.round(i+(s-i)*o),u=Math.round(r+(l-r)*o);return`#${d.toString(16).padStart(2,"0")}${c.toString(16).padStart(2,"0")}${u.toString(16).padStart(2,"0")}`}t.gradientConfigs=[{viewId:"bringBackPVS4",groupIds:["Remaining Non-donating voters","Below the tax threshold","Non-donating voters needed for new funding goals"],innerColor:"#833B8D",outerColor:"#833B8D",maxDistance:350,threshold:1,power:1},{viewId:"bringBackPVS4",groupIds:["Eligible non-voters"],innerColor:"#833B8D",outerColor:"#CCCCCC",maxDistance:1350,threshold:1,power:1},{viewId:"finalFootnote",groupIds:["Remaining Non-donating voters","Below the tax threshold","Non-donating voters needed for new funding goals"],innerColor:"#833B8D",outerColor:"#833B8D",maxDistance:350,threshold:1,power:1},{viewId:"finalFootnote",groupIds:["Eligible non-voters"],innerColor:"#833B8D",outerColor:"#CCCCCC",maxDistance:1e3,threshold:1,power:1}]},600:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateElementPlaceholder=t.updateElementTitle=t.updateElementHTML=t.updateElementText=t.t=void 0;const i=n(o(3438));t.t=(e,t)=>i.default.t(e,t);t.updateElementText=(e,o,n)=>{const i=document.querySelector(e);i&&(i.textContent=(0,t.t)(o,n))};t.updateElementHTML=(e,o,n)=>{const i=document.querySelector(e);i&&(i.innerHTML=(0,t.t)(o,n))};t.updateElementTitle=(e,o,n)=>{const i=document.querySelector(e);i&&i.setAttribute("title",(0,t.t)(o,n))};t.updateElementPlaceholder=(e,o,n)=>{const i=document.querySelector(e);i&&(i.placeholder=(0,t.t)(o,n))}},9763:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TAX_CREDIT_EXPLANATION_DONATION_ANNOTATION=t.TOTAL_DONATION_AMOUNT_TEXT_LABELS=t.SUPERDONOR_ANNOTATION=t.DONOR_CLUMP_ANNOTATION_1000_PLUS=t.DONOR_CLUMP_ANNOTATION_500_999=t.DONOR_CLUMP_ANNOTATION_200_499=t.DONOR_CLUMP_ANNOTATION_1_199=t.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL=t.PVS_ICONS=t.REFORM_LIMIT_ICONS=t.HOW_TAX_CREDIT_WORKS_ICONS=t.PARLIAMENT_ICON=t.PARTY_ICON=t.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP=t.BACKGROUND_NON_DONATING_VOTERS_CLUMP=void 0;const n=o(6921),i=o(1635),r=o(4850),a=o(6185),s=o(600),l=o(3569),d=o(6020);t.BACKGROUND_NON_DONATING_VOTERS_CLUMP=(e=500,t=1500,o=.3)=>({group:n.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:e,outer:t}},ignoreYear:!0});t.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP=()=>({group:n.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{center:{x:200,y:350}},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS,color:n.typeColors.greal}]});t.PARTY_ICON=(e,t,o,n)=>({image:r.viewImages.partyIcon,position:{x:e,y:t},size:{width:o,height:n}});t.PARLIAMENT_ICON=(e,t,o,n)=>({image:r.viewImages.parliamentIcon,position:{x:e,y:t},size:{width:o,height:n}});t.HOW_TAX_CREDIT_WORKS_ICONS=()=>[(0,t.PARTY_ICON)(200,550,100,100),(0,t.PARLIAMENT_ICON)(150,100,600,200)];t.REFORM_LIMIT_ICONS=()=>[(0,t.PARTY_ICON)(340,520,90,90),(0,t.PARLIAMENT_ICON)(340,150,200,200)];t.PVS_ICONS=()=>[(0,t.PARTY_ICON)((0,i.getCenter)().x,(0,i.getCenter)().y+240,100,100),(0,t.PARLIAMENT_ICON)((0,i.getCenter)().x,(0,i.getCenter)().y-270,200,200)];t.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL=()=>({text:()=>(0,s.t)("donationBreakdownByAmount.annotations.individual_donation_amount"),id:"individual-donation-amount-text",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-230},targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]});t.DONOR_CLUMP_ANNOTATION_1_199=()=>({text:()=>(0,s.t)("donationBreakdownByAmount.annotations.donors_1_199"),id:"donors_1_199_text",color:(0,a.fadeHexColor)(n.typeColors.blue,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"});t.DONOR_CLUMP_ANNOTATION_200_499=()=>({text:()=>(0,s.t)("donationBreakdownByAmount.annotations.donors_200_to_499"),id:"donors_200_to_499_text",color:(0,a.fadeHexColor)(n.typeColors.teal,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"});t.DONOR_CLUMP_ANNOTATION_500_999=()=>({text:()=>(0,s.t)("donationBreakdownByAmount.annotations.donors_500_to_999"),id:"donors_500_to_999_text",color:n.typeColors.cyan,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"});t.DONOR_CLUMP_ANNOTATION_1000_PLUS=()=>({text:()=>(0,s.t)("donationBreakdownByAmount.annotations.donors_1000_plus"),id:"donors_1000_plus_text",color:(0,a.fadeHexColor)(n.typeColors.gold,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"});t.SUPERDONOR_ANNOTATION=()=>({id:"gold-donors-1-annotation",type:"calloutCircle",fixedPosition:{x:220,y:(0,i.getCenter)().y-120},note:{title:()=>(0,s.t)("superdonorEmphasis.annotations.superdonors.title"),label:()=>(0,s.t)("superdonorEmphasis.annotations.superdonors.label"),wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation gold-annotation"});t.TOTAL_DONATION_AMOUNT_TEXT_LABELS=()=>[{id:"total-donation-amount",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+50},text:()=>(0,s.t)("donationBreakdownByAmount.annotations.total_donations"),targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]},{id:"total-donation-amount-2",target:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+80},text:()=>`$${l.state.formatFreeFlowAmount(l.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0)}`,targetOffset:{x:0,y:0},targetAnchorY:"bottom",classes:["donors-label"]}];t.TAX_CREDIT_EXPLANATION_DONATION_ANNOTATION=()=>({id:"donations-annotation",type:"callout",target:d.viewFreeSankeys.allDonorsToPartyFree,targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.4,fixedPosition:{x:(0,i.getCenter)().x+100,y:(0,i.getCenter)().y+100},note:{title:()=>{const e=l.state.formatFreeFlowAmount(l.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outflow",!0);return(0,s.t)("donationTaxCreditFlow.annotations.donations",{amount_amount:e})},label:()=>(0,s.t)("donationTaxCreditFlow.annotations.donations_label"),wrap:160,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation"})},1263:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewPresets=void 0,t.initializeViews=function(){(0,i.initSetupViews)(t.viewPresets),(0,n.initProblemViews)(t.viewPresets),(0,r.initSolutionViews)(t.viewPresets)};const n=o(1777),i=o(9039),r=o(3657);t.viewPresets={}},1777:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initProblemViews=function(e){e.superdonorInnerCircle={id:"superdonorInnerCircle",description:"Shows the exclusive inner circle of superdonors",dotRadius:20,forceStrength:{charge:-18},tween:!0,images:[{image:r.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y+10},size:{width:170,height:170}}],clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-120}}},{group:n.VOTER_GROUPS.DONORS_1_999,render:{opacity:.3},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}],force:{type:"radial",boundary:{inner:250,outer:300}}},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:2e3}},render:{opacity:.1},ignoreYear:!0}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,i.getCenter)().y-10},fixedPosition:{x:120,y:(0,i.getCenter)().y-60},note:{title:"",label:"",wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:50,includeElements:[n.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation hidden-callout-annotation"}]},e.majorityExcludedFromAccess={id:"majorityExcludedFromAccess",description:"Shows how most Canadians are excluded from political access",dotRadius:3,forceStrength:{charge:-3},tween:!0,images:[{image:r.viewImages.partyIcon,position:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y},size:{width:70,height:70}}],clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,force:{type:"radial",boundary:{inner:50,outer:50}}},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:80,outer:90}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:100,outer:260}}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:110,outer:260}}}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,i.getCenter)().y},fixedPosition:{x:120,y:(0,i.getCenter)().y-60},note:{},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10,includeElements:[n.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation hidden-callout-annotation"}]},e.taxCreditSystemSetup={id:"taxCreditSystemSetup",description:"Setup for explaining how tax credit system benefits the wealthy",dotRadius:7,forceStrength:{charge:-7},images:[{image:r.viewImages.partyIcon,position:{x:350,y:(0,i.getCenter)().y+40},size:{width:70,height:70}},{image:r.viewImages.parliamentIcon,position:{x:350,y:(0,i.getCenter)().y-140},size:{width:200,height:200}}],clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y-20}}},{group:n.VOTER_GROUPS.DONORS_1_999,render:{opacity:1},force:{type:"radial",boundary:{inner:220,outer:230}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}]},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,render:{opacity:.4},force:{type:"radial",boundary:{inner:300,outer:700}}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:0,disable:!0},force:{type:"radial",boundary:{inner:700,outer:1e3}}}]},e.donationTaxCreditFlow={id:"donationTaxCreditFlow",description:"Shows the flow of donations from donors to parties",dotRadius:7,tween:!0,forceStrength:{},images:(0,l.HOW_TAX_CREDIT_WORKS_ICONS)(),freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsToPartyFree,svgAnnotations:[(0,l.TAX_CREDIT_EXPLANATION_DONATION_ANNOTATION)()]}],clumps:[(0,l.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP)(),(0,l.BACKGROUND_NON_DONATING_VOTERS_CLUMP)()],textAnnotations:[]},e.donationTaxCreditFlowComplete={id:"donationTaxCreditFlowComplete",description:"Complete tax credit flow showing both donations and government refunds",dotRadius:7,tween:!0,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsToPartyFree,svgAnnotations:[(0,l.TAX_CREDIT_EXPLANATION_DONATION_ANNOTATION)()]},{freeSankey:a.viewFreeSankeys.parliamentToAllDonorsFree,svgAnnotations:[{id:"tax-credit-annotation",type:"callout",target:a.viewFreeSankeys.parliamentToAllDonorsFree,targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.6,fixedPosition:{x:(0,i.getCenter)().x+100,y:(0,i.getCenter)().y-120},note:{title:()=>{const e=s.state.formatFreeFlowAmount(s.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"inflow",!0);return(0,d.t)("donationTaxCreditFlow.annotations.tax_credits",{amount_amount:e})},label:()=>(0,d.t)("donationTaxCreditFlow.annotations.tax_credits_label"),wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"blue-flow-annotation"}]}],images:(0,l.HOW_TAX_CREDIT_WORKS_ICONS)(),clumps:[(0,l.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP)(),(0,l.BACKGROUND_NON_DONATING_VOTERS_CLUMP)()],textAnnotations:[]};const t={id:"out-of-pocket-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.5,fixedPosition:{x:(0,i.getCenter)().x+100,y:(0,i.getCenter)().y+80},note:{title:()=>{const e=s.state.formatFreeFlowAmount(s.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"outOfPocket",!0);return(0,d.t)("outOfPocketDonationCosts.annotations.out_of_pocket",{amount_amount:e})},label:()=>(0,d.t)("outOfPocketDonationCosts.annotations.out_of_pocket_label"),wrap:190,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"green-flow-annotation dynamic-text-annotation"},o={id:"subsidized-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.4,fixedPosition:{x:(0,i.getCenter)().x+100,y:(0,i.getCenter)().y+160},note:{title:()=>{const e=s.state.formatFreeFlowAmount(s.state.currentYear,n.VOTER_GROUPS.ALL_DONORS,"inflow",!0);return(0,d.t)("outOfPocketDonationCosts.annotations.subsidized_amount",{amount_amount:e})},label:()=>(0,d.t)("outOfPocketDonationCosts.annotations.subsidized_amount_label"),wrap:210,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"blue-flow-annotation dynamic-text-annotation"};e.outOfPocketDonationCosts={id:"outOfPocketDonationCosts",description:"Visualization showing the actual out-of-pocket cost of donations",dotRadius:7,tween:!1,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsToPartyOOPFree,svgAnnotations:[t]},{freeSankey:a.viewFreeSankeys.allDonorsToPartySubsidizedFree},{freeSankey:a.viewFreeSankeys.parliamentToAllDonorsFree}],images:(0,l.HOW_TAX_CREDIT_WORKS_ICONS)(),clumps:[(0,l.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP)(),(0,l.BACKGROUND_NON_DONATING_VOTERS_CLUMP)()],textAnnotations:[]},e.outOfPocketAndSubsidizedAmounts={id:"outOfPocketAndSubsidizedAmounts",description:"Shows both out-of-pocket costs and subsidized amounts from tax credits",dotRadius:7,tween:!1,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.allDonorsToPartyOOPFree,svgAnnotations:[t]},{freeSankey:a.viewFreeSankeys.allDonorsToPartySubsidizedFree,svgAnnotations:[o]},{freeSankey:a.viewFreeSankeys.parliamentToAllDonorsFree}],images:(0,l.HOW_TAX_CREDIT_WORKS_ICONS)(),clumps:[(0,l.ALL_DONORS_GREAL_TAX_CREDIT_CLUMP)(),(0,l.BACKGROUND_NON_DONATING_VOTERS_CLUMP)()]},e.superdonorTaxCreditShare={id:"superdonorTaxCreditShare",description:"Shows how superdonors receive about a third of all tax credits",dotRadius:7,forceStrength:{},freeSankeyGroups:[{freeSankey:a.viewFreeSankeys.parliamentToDonorsFree,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,color:n.typeColors.gold}],svgAnnotations:[{id:"nearly-half-donations-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,i.getCenter)().x+50,y:(0,i.getCenter)().y-150},note:{title:()=>{const e=s.state.formatPercentageOfFreeFlow(s.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,n.VOTER_GROUPS.ALL_DONORS,"credit");return(0,d.t)("superdonorTaxCreditShare.annotations.superdonor_public_money_title",{percentage_amount:e})},label:()=>(0,d.t)("superdonorTaxCreditShare.annotations.superdonor_public_money_label"),wrap:240,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"nearly-half-flow-annotation blue-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartyOOPFree,svgAnnotations:[{id:"nearly-half-oop-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.7,fixedPosition:{x:(0,i.getCenter)().x+30,y:(0,i.getCenter)().y+30},note:{title:()=>{const e=s.state.formatFreeFlowAmount(s.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,"outOfPocket",!0);return(0,d.t)("superdonorTaxCreditShare.annotations.out_of_pocket_title",{amount_amount:e})},label:()=>{const e=s.state.formatPercentageOfFreeFlow(s.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,n.VOTER_GROUPS.ALL_DONORS,"outOfPocket");return(0,d.t)("superdonorTaxCreditShare.annotations.out_of_pocket_label",{percentage_amount:e})},wrap:240,bgPadding:10,align:"left"},connector:{end:"arrow",type:"line"},className:"nearly-half-subsidized-annotation green-flow-annotation"}]},{freeSankey:a.viewFreeSankeys.donorsToPartySubsidizedFree,highlightLinks:[{group:n.VOTER_GROUPS.DONORS_OVER_1000,color:n.typeColors.gold}],svgAnnotations:[{id:"nearly-half-subsidized-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,i.getCenter)().x+100,y:(0,i.getCenter)().y+140},note:{title:()=>{const e=s.state.formatFreeFlowAmount(s.state.currentYear,n.VOTER_GROUPS.DONORS_OVER_1000,"inflow",!0);return(0,d.t)("superdonorTaxCreditShare.annotations.subsidized_amount_title",{amount_amount:e})},label:()=>(0,d.t)("superdonorTaxCreditShare.annotations.subsidized_amount_label"),wrap:210,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"nearly-half-flow-annotation blue-flow-annotation"}]}],images:(0,l.HOW_TAX_CREDIT_WORKS_ICONS)(),clumps:[{group:n.VOTER_GROUPS.DONORS_1_999,render:{opacity:.5},superdot:!0,force:{center:{x:150,y:350}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}]},{group:n.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:250,y:350}},superdot:!0},(0,l.BACKGROUND_NON_DONATING_VOTERS_CLUMP)()]}};const n=o(6921),i=o(1635),r=o(4850),a=o(6020),s=o(3569),l=o(9763),d=o(600)},9039:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSetupViews=function(e){e.voterIntroduction={id:"voterIntroduction",description:"Introduction to the scale of voter dots, and purple/grey dot meanings",dotRadius:3,forceStrength:{charge:-1.5,collide:3},tween:!0,clumps:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,force:{type:"radial",boundary:{inner:0,outer:100}},render:{disable:!0}},{group:i.VOTER_GROUPS.ALL_ELIGIBLE,force:{center:(0,r.getCenter)()}}],svgAnnotations:[{id:"voters-annotation",type:"calloutCircle",fixedPosition:{x:150,y:(0,r.getCenter)().y-180},target:{x:0,y:0},note:{title:()=>{const e=d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.ALL_ELIGIBLE,"count",!0);return(0,u.t)("voterIntroduction.annotations.all_eligible_voters",{voter_count:e})},wrap:250,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation hidden-line-annotation"}]},e.allEligibleVotersSpread={id:"allEligibleVotersSpread",description:"All eligible voters spread in a large radial formation",dotRadius:2,tween:!0,forceStrength:{charge:-3,collide:3},clumps:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,force:{type:"radial",boundary:{inner:0,outer:1500}}}]},e.governmentSubsidiesDonations={id:"governmentSubsidiesDonations",description:"Government subsidizes political donations through tax credits",dotRadius:1,tween:!0,forceStrength:{charge:-.2},images:[{image:a.viewImages.partyIcon,position:{x:650,y:(0,r.getCenter)().y+130}},{image:a.viewImages.parliamentIcon,position:{x:60,y:(0,r.getCenter)().y+0}}],clumps:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,superdot:!0,textAnnotations:[{text:"Eligible Voters",targetAnchorY:"top",targetOffset:{x:0,y:-20}}],force:{center:{x:350,y:(0,r.getCenter)().y}}}],svgAnnotations:[{id:"tax-credit-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:85,y:(0,r.getCenter)().y-18},note:{title:()=>`${d.state.formatFlowAmount(d.state.currentYear,"Total tax credit",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation blue-text dynamic-text-annotation"},{id:"donation-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:485,y:(0,r.getCenter)().y+18},note:{title:()=>`${d.state.formatFlowAmount(d.state.currentYear,"Total donated to all parties",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation green-text dynamic-text-annotation"}],textAnnotations:[{text:"Political Parties",target:a.viewImages.partyIcon,targetOffset:{x:0,y:40},targetAnchorY:"bottom",classes:["parties-label"]}]},e.questionWhereMoneyGoes={id:"questionWhereMoneyGoes",description:"Transition asking where the tax credit money goes",dotRadius:2,tween:!0,forceStrength:{charge:-1},images:[{image:a.viewImages.parliamentIcon,position:{x:60,y:(0,r.getCenter)().y+0}}],clumps:[{group:i.VOTER_GROUPS.ALL_ELIGIBLE,superdot:!0,textAnnotations:[],force:{center:{x:500,y:(0,r.getCenter)().y}}}],svgAnnotations:[{id:"tax-credit-amount-annotation",type:"callout",target:{x:0,y:0},fixedPosition:{x:85,y:(0,r.getCenter)().y-18},note:{title:()=>`${d.state.formatFlowAmount(d.state.currentYear,"Total tax credit",!0)}`,wrap:180,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},className:"title-only-annotation blue-text dynamic-text-annotation"}]},e.voterTurnoutVisualization={id:"voterTurnoutVisualization",description:"Visualization showing that 2 in 3 eligible Canadians vote",dotRadius:3,forceStrength:{charge:-1.5,collide:3},clumps:[{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:140,outer:240}},render:{opacity:.9}},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,superdot:!0,svgAnnotations:[{id:"voters-annotation",type:"calloutCircle",fixedPosition:{x:80,y:(0,r.getCenter)().y-180},note:{title:()=>{const e=d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.ALL_VOTERS,"count",!0);return(0,u.t)("voterTurnoutVisualization.annotations.all_voters",{voter_count:e})},wrap:170,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:0},className:"hidden-circle-annotation purple-annotation"}]}]},e.donorParticipationRates={id:"donorParticipationRates",description:"Shows that less than 1% of eligible voters donate to parties",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:i.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},groupColorOverride:[{group:i.VOTER_GROUPS.ALL_DONORS,color:i.typeColors.greal}],svgAnnotations:[{id:"all-donors-annotation",type:"calloutCircle",fixedPosition:{x:180,y:(0,r.getCenter)().y-180},note:{title:()=>{const e=d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.ALL_DONORS,"count");return(0,u.t)("donorParticipationRates.annotations.all_donors",{donor_count:e})},wrap:250,bgPadding:10,align:"left"},connector:{end:"arrow",type:"elbow"},subject:{radiusPadding:0},className:"hidden-circle-annotation donors-annotation"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:40,outer:150}},ignoreYear:!0,render:{opacity:.5}},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:160,outer:260}},ignoreYear:!0,render:{opacity:.5}}]},e.superdonorEmphasis={id:"superdonorEmphasis",description:"Emphasizes the small group of $1000+ superdonors",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{},svgAnnotations:[(0,c.SUPERDONOR_ANNOTATION)()]},{group:i.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:30,outer:50}}},{group:i.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},render:{disable:!0},groupColorOverride:[{group:i.VOTER_GROUPS.ALL_DONORS,color:"#63C1CD"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,ignoreYear:!0,force:{type:"radial",boundary:{inner:60,outer:160}},render:{opacity:.3}},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:170,outer:300}},ignoreYear:!0,render:{opacity:.3}}]},e.superdonorEmphasisLarge={id:"superdonorEmphasisLarge",description:"Emphasizes superdonors with larger visual representation",dotRadius:12,tween:!0,forceStrength:{charge:-12},clumps:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{},svgAnnotations:[(0,c.SUPERDONOR_ANNOTATION)()]},{group:i.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:60,outer:100}}},{group:i.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{strength:.4},render:{disable:!0},groupColorOverride:[{group:i.VOTER_GROUPS.ALL_DONORS,color:"#63C1CD"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,ignoreYear:!0,force:{type:"radial",boundary:{inner:150,outer:1e3}},render:{opacity:.2}},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:5e3}},ignoreYear:!0,render:{disable:!0,opacity:0}}]},e.donationBreakdownByAmount1={id:"donationBreakdownByAmount1",description:"Shows how donations flow from all donors to parties",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:i.VOTER_GROUPS.ALL_DONORS,superdot:!0,force:{center:{x:(0,r.getCenter)().x,y:(0,r.getCenter)().y-150}},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.all_donors"),color:i.typeColors.blue,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartyFree,svgAnnotations:[{id:"all-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:i.VOTER_GROUPS.ALL_DONORS,targetFlowRatio:.5,fixedPosition:{x:(0,r.getCenter)().x-200,y:(0,r.getCenter)().y-50},note:{title:()=>(0,u.t)("donationBreakdownByAmount.annotations.donations"),label:()=>(0,u.t)("donationBreakdownByAmount.annotations.donations_label"),wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:(0,c.TOTAL_DONATION_AMOUNT_TEXT_LABELS)(),svgAnnotations:[{id:"party-icon-annotation",type:"callout",target:a.viewImages.partyIcon,targetOffset:{x:-45,y:-0},fixedPosition:{x:(0,r.getCenter)().x-140,y:(0,r.getCenter)().y+120},note:{title:()=>(0,u.t)("donationBreakdownByAmount.annotations.all_major_federal_political_parties"),label:()=>(0,u.t)("donationBreakdownByAmount.annotations.all_major_federal_political_parties_label"),wrap:200,bgPadding:10,align:"right"},connector:{end:"arrow",type:"elbow"}}]},e.donationBreakdownByAmount2={id:"donationBreakdownByAmount2",description:"Highlights $1-199 donors and their contribution share",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:i.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,r.getCenter)().x-220,y:(0,r.getCenter)().y-120}},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.donors_1_199"),id:"donors_1_199_text",color:i.typeColors.blue,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000]),render:{opacity:.4},superdot:!0,force:{center:{x:(0,r.getCenter)().x,y:(0,r.getCenter)().y-150}},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.donors_200_plus"),id:"donors_200_plus_text",color:(0,l.fadeHexColor)(i.typeColors.teal,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartySplit1Free,highlightLinks:[{group:i.VOTER_GROUPS.DONORS_1_199,color:i.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:i.VOTER_GROUPS.DONORS_1_199,targetFlowRatio:.7,fixedPosition:{x:(0,r.getCenter)().x-200,y:(0,r.getCenter)().y+50},note:{title:()=>`$${d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.DONORS_1_199,"outflow",!0)}`,label:()=>{const e=d.state.formatPercentageOfFreeFlow(d.state.currentYear,i.VOTER_GROUPS.DONORS_1_199,i.VOTER_GROUPS.ALL_DONORS,"donation");return(0,u.t)("donationBreakdownByAmount.annotations.of_all_donations",{percentage_amount:e})},wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[(0,c.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL)(),...(0,c.TOTAL_DONATION_AMOUNT_TEXT_LABELS)()],svgAnnotations:[]},e.donationBreakdownByAmount3={id:"donationBreakdownByAmount3",description:"Highlights $200-499 donors and their contribution share",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:i.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,r.getCenter)().x-220,y:(0,r.getCenter)().y-120}},render:{opacity:.4},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.donors_1_199"),id:"donors_1_199_text",color:(0,l.fadeHexColor)(i.typeColors.blue,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:i.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,r.getCenter)().x-100,y:(0,r.getCenter)().y-100}},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.donors_200_to_499"),id:"donors_200_to_499_text",color:i.typeColors.teal,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:n.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000]),render:{opacity:.4},superdot:!0,force:{center:{x:(0,r.getCenter)().x,y:(0,r.getCenter)().y-150}},textAnnotations:[{text:()=>(0,u.t)("donationBreakdownByAmount.annotations.donors_500_plus"),id:"donors_500_plus_text",color:(0,l.fadeHexColor)(i.typeColors.cyan,.4),targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.allDonorsToPartySplit2Free,highlightLinks:[{group:i.VOTER_GROUPS.DONORS_200_499,color:i.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation-2",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:i.VOTER_GROUPS.DONORS_200_499,targetFlowRatio:.7,fixedPosition:{x:(0,r.getCenter)().x-200,y:(0,r.getCenter)().y+0},note:{title:()=>`$${d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.DONORS_200_499,"outflow",!0)}`,label:()=>{const e=d.state.formatPercentageOfFreeFlow(d.state.currentYear,i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.ALL_DONORS,"donation");return(0,u.t)("donationBreakdownByAmount.annotations.of_all_donations",{percentage_amount:e})},wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[(0,c.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL)(),...(0,c.TOTAL_DONATION_AMOUNT_TEXT_LABELS)()],svgAnnotations:[]},e.donationBreakdownByAmount4={id:"donationBreakdownByAmount4",description:"Highlights $500-999 donors and their contribution share",dotRadius:8,forceStrength:{charge:-8},clumps:[{group:i.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,r.getCenter)().x-220,y:(0,r.getCenter)().y-120}},render:{opacity:.4},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_1_199)()]},{group:i.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,r.getCenter)().x-100,y:(0,r.getCenter)().y-100}},render:{opacity:.4},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_200_499)()]},{group:i.VOTER_GROUPS.DONORS_500_999,superdot:!0,force:{center:{x:(0,r.getCenter)().x+10,y:(0,r.getCenter)().y-130}},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_500_999)()]},{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,r.getCenter)().x+120,y:(0,r.getCenter)().y-100}},render:{opacity:.4},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_1000_PLUS)()]},{...(0,c.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(400,1e3,.2)},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorGroupsToPartyFree,highlightLinks:[{group:i.VOTER_GROUPS.DONORS_500_999,color:i.flowColors.greenStronger}],svgAnnotations:[{id:"all-donors-flow-annotation-3",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:i.VOTER_GROUPS.DONORS_500_999,targetFlowRatio:.7,fixedPosition:{x:(0,r.getCenter)().x-210,y:(0,r.getCenter)().y-10},note:{title:()=>`$${d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.DONORS_500_999,"outflow",!0)}`,label:()=>{const e=d.state.formatPercentageOfFreeFlow(d.state.currentYear,i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.ALL_DONORS,"donation");return(0,u.t)("donationBreakdownByAmount.annotations.of_all_donations",{percentage_amount:e})},wrap:180,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation green-flow-annotation"}]}],textAnnotations:[(0,c.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL)(),...(0,c.TOTAL_DONATION_AMOUNT_TEXT_LABELS)()],svgAnnotations:[]},e.superdonorImpactOnFunding={id:"superdonorImpactOnFunding",description:"Shows superdonors' outsized impact on party funding despite small numbers",dotRadius:8,tween:!0,forceStrength:{charge:-8},clumps:[{group:i.VOTER_GROUPS.DONORS_1_199,superdot:!0,force:{center:{x:(0,r.getCenter)().x-220,y:(0,r.getCenter)().y-120}},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_1_199)()]},{group:i.VOTER_GROUPS.DONORS_200_499,superdot:!0,force:{center:{x:(0,r.getCenter)().x-100,y:(0,r.getCenter)().y-100}},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_200_499)()]},{group:i.VOTER_GROUPS.DONORS_500_999,superdot:!0,force:{center:{x:(0,r.getCenter)().x+10,y:(0,r.getCenter)().y-130}},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_500_999)()]},{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,r.getCenter)().x+120,y:(0,r.getCenter)().y-100}},textAnnotations:[(0,c.DONOR_CLUMP_ANNOTATION_1000_PLUS)()],svgAnnotations:[{id:"gold-donors-circle-annotation",type:"calloutCircle",fixedPosition:{x:(0,r.getCenter)().x+290,y:(0,r.getCenter)().y-30},note:{title:()=>{const e=d.state.formatPercentageOfFreeFlow(d.state.currentYear,i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.ALL_DONORS,"count");return(0,u.t)("superdonorImpactOnFunding.annotations.superdonors_make_up_just",{percentage_amount:e})},label:()=>{const e=d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.DONORS_OVER_1000,"count");return(0,u.t)("superdonorImpactOnFunding.annotations.that_s",{count_amount:e})},wrap:250,bgPadding:10,align:"middle"},subject:{radiusPadding:3},connector:{end:"arrow",type:"elbow"},className:"gold-annotation gold-donors-flow-annotation hidden-circle-annotation"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0},{group:i.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:1e3,outer:4e3}},ignoreYear:!0,render:{disable:!0,opacity:.2}},{group:i.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:100,outer:250}},render:{disable:!0}}],images:[{image:a.viewImages.partyIcon}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorGroupsToPartyFree,highlightLinks:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,color:i.typeColors.gold}],svgAnnotations:[{id:"gold-donors-flow-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:i.VOTER_GROUPS.DONORS_OVER_1000,targetFlowRatio:.6,fixedPosition:{x:(0,r.getCenter)().x+250,y:(0,r.getCenter)().y+80},note:{title:()=>{const e=d.state.formatPercentageOfFreeFlow(d.state.currentYear,i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.ALL_DONORS,"donation");return(0,u.t)("superdonorImpactOnFunding.annotations.but_contribute",{percentage_amount:e})},label:()=>{const e=d.state.formatFreeFlowAmount(d.state.currentYear,i.VOTER_GROUPS.DONORS_OVER_1000,"outflow",!0);return(0,u.t)("superdonorImpactOnFunding.annotations.that_s_money",{amount_amount:e})},wrap:260,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"gold-donors-flow-annotation gold-flow-annotation"}]}],textAnnotations:[(0,c.INDIVIDUAL_DONATION_AMOUNT_TEXT_LABEL)(),...(0,c.TOTAL_DONATION_AMOUNT_TEXT_LABELS)()],svgAnnotations:[]},e.partiesFocusOnSuperdonors={id:"partiesFocusOnSuperdonors",description:"Shows how parties focus fundraising efforts on superdonors",dotRadius:8,tween:!0,forceStrength:{charge:-8},images:[{image:a.viewImages.partyIcon},{image:a.viewImages.stadiumIcon,position:{x:370,y:(0,r.getCenter)().y-150},size:{width:200,height:200},svgAnnotations:[{id:"maple-leafs-comparison-leafs-annotation",type:"calloutCircle",targetOffset:{x:0,y:-0},fixedPosition:{x:(0,r.getCenter)().x+330,y:(0,r.getCenter)().y-20},note:{title:()=>(0,u.t)("partiesFocusOnSuperdonors.annotations.nhl_arena_title"),label:()=>(0,u.t)("partiesFocusOnSuperdonors.annotations.nhl_arena_label"),wrap:270,bgPadding:10,align:"right"},connector:{end:"arrow",type:"elbow"},className:"blue-annotation hidden-circle-annotation",subject:{radiusPadding:80}}]}],clumps:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:370,y:(0,r.getCenter)().y-150}}},{group:i.VOTER_GROUPS.DONORS_1_999,superdot:!0,render:{opacity:.5},force:{center:{x:150,y:(0,r.getCenter)().y-150}},groupColorOverride:[{group:i.VOTER_GROUPS.DONORS_1_999,color:i.typeColors.greal}],textAnnotations:[{text:()=>(0,u.t)("partiesFocusOnSuperdonors.annotations.donors_1_999"),id:"donors_1_999_text",color:i.typeColors.greal,targetOffset:{x:0,y:-20},targetAnchorY:"top",targetAnchorX:"middle"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1e3}},render:{opacity:.2},ignoreYear:!0}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorsToPartyFree,highlightLinks:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,color:i.typeColors.gold}]}],textAnnotations:[{text:()=>(0,u.t)("partiesFocusOnSuperdonors.annotations.donors_1000_plus"),id:"donors_1000_plus_text_arena",target:{x:370,y:(0,r.getCenter)().y-150},color:i.typeColors.gold,targetOffset:{x:0,y:-80},targetAnchorY:"top",targetAnchorX:"middle",classes:["superdot-label"]}]},e.donationsCreateAccess={id:"donationsCreateAccess",description:"Demonstrates how large donations create privileged access to politicians",dotRadius:10,tween:!0,forceStrength:{charge:-9},images:[{image:a.viewImages.partyIcon,position:{x:(0,r.getCenter)().x,y:(0,r.getCenter)().y+10}}],freeSankeyGroups:[{freeSankey:s.viewFreeSankeys.donorsToPartyFree}],clumps:[{group:i.VOTER_GROUPS.DONORS_OVER_1000,superdot:!0,force:{center:{x:(0,r.getCenter)().x+32,y:(0,r.getCenter)().y-100}}},{group:i.VOTER_GROUPS.DONORS_1_999,superdot:!0,render:{opacity:.5},force:{center:{x:310,y:(0,r.getCenter)().y-230}},groupColorOverride:[{group:i.VOTER_GROUPS.DONORS_1_999,color:"#63C1CD"}]},{group:i.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:300,outer:1e3}},render:{opacity:.4},ignoreYear:!0}],svgAnnotations:[{id:"elite-donors-annotation",type:"calloutCircle",target:{x:350,y:(0,r.getCenter)().y-10},fixedPosition:{x:570,y:(0,r.getCenter)().y+80},note:{title:()=>(0,u.t)("donationsCreateAccess.annotations.the_inner_circle_title"),label:()=>(0,u.t)("donationsCreateAccess.annotations.the_inner_circle_label"),wrap:150,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10,includeElements:[i.VOTER_GROUPS.DONORS_OVER_1000,"bot-party-icon"]},className:"elite-donors-annotation"},{id:"other-donors-annotation",type:"callout",target:{x:340,y:(0,r.getCenter)().y-150},fixedPosition:{x:530,y:(0,r.getCenter)().y-170},note:{title:()=>(0,u.t)("donationsCreateAccess.annotations.on_the_outside_title"),label:()=>(0,u.t)("donationsCreateAccess.annotations.on_the_outside_label"),wrap:160,bgPadding:10,align:"middle"},connector:{type:"line"},subject:{radiusPadding:20,includeElements:[i.VOTER_GROUPS.DONORS_1_999]},className:"hidden-line-annotation teal-annotation"}]}};const n=o(1613),i=o(6921),r=o(1635),a=o(4850),s=o(6020),l=o(6185),d=o(3569),c=o(9763),u=o(600)},3657:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSolutionViews=function(e){e.reformProposalIntroduction={id:"reformProposalIntroduction",description:"Introduction to the two big reform proposals",dotRadius:4,tween:!0,forceStrength:{},freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.parliamentToDonorsFree,offset:{x:0,y:20}},{freeSankey:r.viewFreeSankeys.donorsToPartyOOPFree,offset:{x:0,y:-20}},{freeSankey:r.viewFreeSankeys.donorsToPartySubsidizedFree,offset:{x:0,y:-20}}],images:(0,a.REFORM_LIMIT_ICONS)(),clumps:[{group:n.VOTER_GROUPS.DONORS_1_999,render:{opacity:1},superdot:!0,force:{center:{x:330,y:360}},groupColorOverride:[{group:n.VOTER_GROUPS.DONORS_1_999,color:n.typeColors.greal}]},{group:n.VOTER_GROUPS.DONORS_OVER_1000,force:{center:{x:380,y:360}},superdot:!0},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(250,500,.3)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},e.reformQuestionTransition={id:"reformQuestionTransition",description:"Transition asking what can be done about the current system",dotRadius:5,tween:!0,forceStrength:{charge:-5},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:60,outer:100}}},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(150,300,1)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1500}},render:{opacity:.3}}]},e.currentDonationLimitFocusAlt={id:"currentDonationLimitFocusAlt",description:"Alternative view of current fundraising focus with flow visualization",dotRadius:5,tween:!0,freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.allDonorsToPartyFree},{freeSankey:r.viewFreeSankeys.parliamentToAllDonorsFree}],images:(0,a.REFORM_LIMIT_ICONS)(),clumps:[{group:n.VOTER_GROUPS.ALL_DONORS,render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS,color:n.typeColors.greal}],svgAnnotations:[{id:"right-now-donor-count",type:"calloutCircle",target:n.VOTER_GROUPS.ALL_DONORS,fixedPosition:{x:100,y:(0,i.getCenter)().y-160},note:{title:()=>(0,s.t)("currentDonationLimitFocusAlt.annotations.fundraising_focus_title"),label:()=>(0,s.t)("currentDonationLimitFocusAlt.annotations.fundraising_focus_label"),wrap:250,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10,includeElements:[n.VOTER_GROUPS.ALL_DONORS]},className:"all-donors-annotation hidden-circle-annotation"}]},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(250,500)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},e.reducedLimitMoreDonorsAlt={id:"reducedLimitMoreDonorsAlt",description:"Alternative view showing doubled donor base under $100 limit",dotRadius:5,tween:!0,freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:r.viewFreeSankeys.parliamentToAfterReformDonorsFree}],images:(0,a.REFORM_LIMIT_ICONS)(),clumps:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}},svgAnnotations:[{id:"with-reform-donor-count",type:"calloutCircle",fixedPosition:{x:100,y:(0,i.getCenter)().y+100},note:{title:()=>(0,s.t)("reducedLimitMoreDonorsAlt.annotations.double_the_donors_title"),label:()=>(0,s.t)("reducedLimitMoreDonorsAlt.annotations.double_the_donors_label"),wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},subject:{radiusPadding:10,includeElements:[n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM]},className:"final-donors-annotation hidden-circle-annotation"}]},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(250,500)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},e.eliminateTaxCreditQuestion={id:"eliminateTaxCreditQuestion",description:"Questions what to do about the tax credit under reform",dotRadius:5,tween:!1,freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:r.viewFreeSankeys.parliamentToAfterReformDonorsFree}],images:(0,a.REFORM_LIMIT_ICONS)(),clumps:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}}},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(250,500)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},e.eliminateTaxCreditProposal={id:"eliminateTaxCreditProposal",description:"Proposes eliminating the tax credit and redirecting funds",dotRadius:5,tween:!1,freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.allDonorsAfterReformToPartyFree},{freeSankey:r.viewFreeSankeys.parliamentToAfterReformDonorsFree,svgAnnotations:[{id:"tax-credit-annotation",type:"callout",targetAnchorLink:"junction",fixedPosition:{x:100,y:(0,i.getCenter)().y-50},note:{title:()=>(0,s.t)("eliminateTaxCreditQuestion.annotations.eliminate_tax_credit_title"),label:()=>(0,s.t)("eliminateTaxCreditQuestion.annotations.eliminate_tax_credit_label"),wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"line"},subject:{radiusPadding:10},className:"blue-flow-annotation"}]}],images:(0,a.REFORM_LIMIT_ICONS)(),clumps:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:1},superdot:!0,force:{center:{x:340,y:360}}},{...(0,a.BACKGROUND_NON_DONATING_VOTERS_CLUMP)(250,500)},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,render:{opacity:.3},force:{type:"radial",boundary:{inner:250,outer:500}}}]},e.perVoteSubsidyIntroduction={id:"perVoteSubsidyIntroduction",description:"Introduces the per-vote subsidy as public funding based on votes",dotRadius:2,tween:!0,forceStrength:{charge:-.7,collide:.5},images:(0,a.PVS_ICONS)(),freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.parliamentToVotersAndDonorsSuperdotFree,offset:{x:0,y:0},svgAnnotations:[{id:"per-vote-subsidy-annotation",type:"callout",targetAnchorLink:"superdot-link",targetFlowGroup:n.VOTER_GROUPS.NON_DONATING_VOTERS,targetFlowRatio:.3,fixedPosition:{x:100,y:(0,i.getCenter)().y-100},note:{title:()=>(0,s.t)("perVoteSubsidyIntroduction.annotations.per_vote_subsidy_title"),label:()=>(0,s.t)("perVoteSubsidyIntroduction.annotations.per_vote_subsidy_label"),wrap:200,bgPadding:10,align:"middle"},connector:{end:"arrow",type:"elbow"},className:"blue-flow-annotation"}]}],clumps:[{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y}},superdot:!0},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:200,outer:1e3}},render:{opacity:1}},{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,force:{type:"radial",boundary:{inner:50,outer:70}},render:{disable:!0},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:n.VOTER_GROUPS.NON_DONATING_WITH_REFORM,force:{type:"radial",boundary:{inner:50,outer:100}},render:{opacity:1,disable:!0}}]},e.perVoteSubsidyAlignment={id:"perVoteSubsidyAlignment",description:"Shows alignment between public voting and public funding distribution",dotRadius:2,forceStrength:{charge:-.7,collide:.5},images:(0,a.PVS_ICONS)(),freeSankeyGroups:[{freeSankey:r.viewFreeSankeys.parliamentToVotersAndDonorsSuperdotFree,offset:{x:0,y:0},svgAnnotations:[]}],clumps:[{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{center:{x:(0,i.getCenter)().x,y:(0,i.getCenter)().y}},superdot:!0},{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,superdot:!0,force:{center:{x:(0,i.getCenter)().x+200,y:(0,i.getCenter)().y}},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}],render:{opacity:0,disable:!0}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:200,outer:1e3}},render:{opacity:1}},{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,force:{type:"radial",boundary:{inner:50,outer:70}},render:{disable:!0},groupColorOverride:[{group:n.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM,color:"#B5C617"}]},{group:n.VOTER_GROUPS.NON_DONATING_WITH_REFORM,force:{type:"radial",boundary:{inner:50,outer:100}},render:{opacity:1,disable:!0}}]},e.perVoteSubsidyImpact={id:"perVoteSubsidyImpact",description:"Shows how votes count for both MP selection and party funding",dotRadius:5,tween:!0,forceStrength:{charge:-5},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:40,outer:50}}},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:100,outer:300}}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:400,outer:1500}},render:{opacity:.2}}],svgAnnotations:[{id:"per-vote-subsidy-annotation",type:"callout",target:{x:(0,i.getCenter)().x-200,y:(0,i.getCenter)().y-200},note:{title:()=>(0,s.t)("perVoteSubsidyImpact.annotations.the_current_system_title"),label:()=>(0,s.t)("perVoteSubsidyImpact.annotations.the_current_system_label"),wrap:200,bgPadding:10,align:"middle"}}]},e.reformImpactOnEngagement={id:"reformImpactOnEngagement",description:"Shows how reform could change political engagement and responsiveness",dotRadius:4,tween:!0,forceStrength:{charge:-3},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:30,outer:40}}},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:60,outer:230}}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:260,outer:800}},render:{opacity:1}}]},e.callToAction={id:"callToAction",description:"Final call to action encouraging democratic participation",dotRadius:3,tween:!0,forceStrength:{charge:-2},clumps:[{group:n.VOTER_GROUPS.DONORS_OVER_1000},{group:n.VOTER_GROUPS.DONORS_1_999,force:{type:"radial",boundary:{inner:10,outer:30}}},{group:n.VOTER_GROUPS.NON_DONATING_VOTERS,force:{type:"radial",boundary:{inner:35,outer:170}}},{group:n.VOTER_GROUPS.ELIGIBLE_NON_VOTERS,force:{type:"radial",boundary:{inner:180,outer:330}},render:{opacity:1}}]}};const n=o(6921),i=o(1635),r=o(6020),a=o(9763),s=o(600)},1635:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCenter=void 0;const n=o(3569);t.getCenter=()=>({x:n.state.svgWidth/2,y:n.state.svgHeight/2})},4850:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewImages=void 0,t.initializeImages=function(){const e={partyIcon:new n.SimImage({id:"bot-party-icon",src:"assets/img/parties-icon-v03.svg",alt:"Political party icon",position:{x:350,y:500},size:{width:100,height:100},rotates:!0}),parliamentIcon:new n.SimImage({id:"parliament-icon-end",src:"assets/img/parliament-v01.svg",alt:"Parliament icon",position:{x:250,y:100},size:{width:600,height:200}}),stadiumIcon:new n.SimImage({id:"stadium-icon",src:"assets/img/hockey-arena-icon-average.svg",alt:"Stadium icon",position:{x:100,y:100},size:{width:200,height:200}})},o=Object.values(e).map((e=>e.id));if(new Set(o).size!==o.length)throw new Error("Duplicate image IDs found");for(const o in e){const n=e[o];t.viewImages[o]=n}};const n=o(2636);t.viewImages={}},6610:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCenter=t.viewPresets=t.updateFlowSankeys=t.viewSankeys=t.viewImages=void 0,t.initializeViewComponents=function(){(0,s.initializeImages)(),(0,l.initializeSankeys)(),(0,d.initializeViews)()};var n=o(4850);Object.defineProperty(t,"viewImages",{enumerable:!0,get:function(){return n.viewImages}});var i=o(6020);Object.defineProperty(t,"viewSankeys",{enumerable:!0,get:function(){return i.viewSankeys}}),Object.defineProperty(t,"updateFlowSankeys",{enumerable:!0,get:function(){return i.updateFlowSankeys}});var r=o(1263);Object.defineProperty(t,"viewPresets",{enumerable:!0,get:function(){return r.viewPresets}});var a=o(1635);Object.defineProperty(t,"getCenter",{enumerable:!0,get:function(){return a.getCenter}});const s=o(4850),l=o(6020),d=o(1263)},6020:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tempSankeyData=t.viewFreeSankeys=t.viewSankeys=void 0,t.initializeSankeys=function(){const e={votersAndDonorsSuperdotToPartiesFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.green}),votersAndDonorsSuperdotToPartiesBlueFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.blue}),votersAndDonorsSuperdotToPartiesPurpleFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.purple}),parliamentToVotersAndDonorsSuperdotFree:(0,a.createFreeSankey)({target:r.viewImages.parliamentIcon,targetOffset:{x:0,y:55},junctionOffset:{x:0,y:70},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.NON_DONATING_VOTERS],color:i.flowColors.blue,curved:!0,target2:r.viewImages.partyIcon}),donorGroupsToPartyFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_199,i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.DONORS_500_999],color:i.flowColors.green}),allDonorsToPartyFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.green}),allDonorsAfterReformToPartyFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.green}),parliamentToAfterReformDonorsFree:(0,a.createFreeSankey)({target:r.viewImages.parliamentIcon,targetOffset:{x:0,y:55},junctionOffset:{x:0,y:70},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.blue}),allDonorsAfterReformToPartyOOPFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"outOfPocket",voterGroups:[i.VOTER_GROUPS.ALL_DONORS_AFTER_REFORM],color:i.flowColors.green}),allDonorsToPartySplit1Free:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_1_199,s.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_200_499,i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000])],color:i.flowColors.green}),allDonorsToPartySplit2Free:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_1_199,i.VOTER_GROUPS.DONORS_200_499,s.VoterGroup.fromGroups([i.VOTER_GROUPS.DONORS_500_999,i.VOTER_GROUPS.DONORS_OVER_1000])],color:i.flowColors.green}),donorsToPartyFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"donation",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.green}),parliamentToDonorsFree:(0,a.createFreeSankey)({target:r.viewImages.parliamentIcon,junctionOffset:{x:0,y:70},targetOffset:{x:0,y:55},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.blue}),parliamentToAllDonorsFree:(0,a.createFreeSankey)({target:r.viewImages.parliamentIcon,junctionOffset:{x:0,y:70},targetOffset:{x:0,y:55},orientation:"vertical",flowDirection:"incoming",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.blue}),donorsToPartySubsidizedFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.blue}),allDonorsToPartySubsidizedFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"credit",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.blue}),donorsToPartyOOPFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"outOfPocket",voterGroups:[i.VOTER_GROUPS.DONORS_OVER_1000,i.VOTER_GROUPS.DONORS_1_999],color:i.flowColors.green}),allDonorsToPartyOOPFree:(0,a.createFreeSankey)({target:r.viewImages.partyIcon,junctionOffset:{x:0,y:-70},orientation:"vertical",flowDirection:"outgoing",flowAspect:"outOfPocket",voterGroups:[i.VOTER_GROUPS.ALL_DONORS],color:i.flowColors.green})};Object.entries(e).forEach((([e,o])=>{t.viewFreeSankeys[e]=o}))},t.updateFlowSankeys=function e(){window.updateFlowSankeys=e;const o=n.state.currentYear;if(!n.state.flowData[o])return;try{n.state.flowData[o]["Total donated to all parties"];const e=n.state.flowData[o]["Total from donors >$1000"]||0,r=n.state.flowData[o]["Total from donors  <$1000"]||0,a=n.state.flowData[o]["Total tax credit"]||0,s=n.state.flowData[o]["Total tax credit to donors >$1000 (assuming they all use the full $650 tax credit)"]||0,l=n.state.flowData[o]["Total tax credit to donors <$1000 "]||0,d=e-s,c=r-l,u=d+c,p=d/u,g=c/u,h=s/a,f=l/a;if(t.viewSankeys.parliamentToDonors&&"groups"===t.viewSankeys.parliamentToDonors.target.type&&t.viewSankeys.parliamentToDonors.target.groups){const e=t.viewSankeys.parliamentToDonors.target.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=t.viewSankeys.parliamentToDonors.target.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_1_999||e.group===i.VOTER_GROUPS.DONORS_1_199||e.group===i.VOTER_GROUPS.DONORS_200_499||e.group===i.VOTER_GROUPS.DONORS_500_999));e>=0&&(t.viewSankeys.parliamentToDonors.target.groups[e].percentage=h),o>=0&&(t.viewSankeys.parliamentToDonors.target.groups[o].percentage=f),t.viewSankeys.parliamentToDonors.totalThickness=Math.min(50,Math.max(15,a/1e6))}if(t.viewSankeys.donorsToPartyOOP&&"groups"===t.viewSankeys.donorsToPartyOOP.source.type&&t.viewSankeys.donorsToPartyOOP.source.groups){const e=t.viewSankeys.donorsToPartyOOP.source.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=t.viewSankeys.donorsToPartyOOP.source.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_1_999||e.group===i.VOTER_GROUPS.DONORS_1_199||e.group===i.VOTER_GROUPS.DONORS_200_499||e.group===i.VOTER_GROUPS.DONORS_500_999));e>=0&&(t.viewSankeys.donorsToPartyOOP.source.groups[e].percentage=p),o>=0&&(t.viewSankeys.donorsToPartyOOP.source.groups[o].percentage=g),t.viewSankeys.donorsToPartyOOP.totalThickness=Math.min(50,Math.max(15,u/1e6))}if(t.viewSankeys.donorsToPartySubsidized&&"groups"===t.viewSankeys.donorsToPartySubsidized.source.type&&t.viewSankeys.donorsToPartySubsidized.source.groups){const e=t.viewSankeys.donorsToPartySubsidized.source.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_OVER_1000)),o=t.viewSankeys.donorsToPartySubsidized.source.groups.findIndex((e=>e.group===i.VOTER_GROUPS.DONORS_1_999||e.group===i.VOTER_GROUPS.DONORS_1_199||e.group===i.VOTER_GROUPS.DONORS_200_499||e.group===i.VOTER_GROUPS.DONORS_500_999));e>=0&&o>=0&&(t.viewSankeys.donorsToPartySubsidized.source.groups[e].percentage=h,t.viewSankeys.donorsToPartySubsidized.source.groups[o].percentage=f),t.viewSankeys.donorsToPartySubsidized.totalThickness=Math.min(50,Math.max(15,a/1e6))}}catch(e){}};const n=o(3569),i=o(6921),r=o(4850),a=o(6965),s=o(1613);t.viewSankeys={},t.viewFreeSankeys={},t.tempSankeyData={donations:{allParties:51440613.66,above1k:15887530.44,below1k:35553083.22,allPartiesText:"$51,440,613.66",above1kText:"$15,887,530.44",below1kText:"$35,553,083.22",donors500_999:9319135.81,donors200_499:12332582.45,donors1_199:13892732.48,donors500_999Text:"$9,319,135.81",donors200_499Text:"$12,332,582.45",donors1_199Text:"$13,892,732.48",percentageAbove1k:.31,percentageBelow1k:.69,percentage500_999:.18116299839646977,percentage200_499:.2397440771510423,percentage1_199:.270073226027685},taxCredits:{allParties:32613142.86,above1k:9065828.57,below1k:23547314.29,allPartiesText:"$32,613,142.86",above1kText:"$9,065,828.57",below1kText:"$23,547,314.29",percentageAbove1k:.28,percentageBelow1k:.72}},t.tempSankeyData.outOfPocket={allparties:t.tempSankeyData.donations.allParties-t.tempSankeyData.taxCredits.allParties,above1k:t.tempSankeyData.donations.above1k-t.tempSankeyData.taxCredits.above1k,below1k:t.tempSankeyData.donations.below1k-t.tempSankeyData.taxCredits.below1k},t.tempSankeyData.outOfPocket.percentageAbove1k=t.tempSankeyData.outOfPocket.above1k/t.tempSankeyData.outOfPocket.allparties,t.tempSankeyData.outOfPocket.percentageBelow1k=t.tempSankeyData.outOfPocket.below1k/t.tempSankeyData.outOfPocket.allparties},8934:(e,t,o)=>{e.exports=o.p+"d93ddff06d4a28ce6503.png"},5663:(e,t,o)=>{e.exports=o.p+"09e92d1410acd91d4dd3.png"},2728:(e,t,o)=>{e.exports=o.p+"a152cd88d51121f2e8aa.png"},132:(e,t,o)=>{e.exports=o.p+"ebce26699c1ea3463bed.png"},4968:(e,t,o)=>{e.exports=o.p+"1f61fc99e1b6fec81cdc.png"},1029:(e,t,o)=>{e.exports=o.p+"4efca81989266aacfb64.png"},3946:(e,t,o)=>{e.exports=o.p+"8169c5a92d5055627d0e.png"},3373:(e,t,o)=>{e.exports=o.p+"32338d58bac6035b2c11.png"},9234:(e,t,o)=>{e.exports=o.p+"544df8efba6395a66bb7.png"},9489:(e,t,o)=>{e.exports=o.p+"ecc574b7dcab4f1a8132.png"},1487:(e,t,o)=>{e.exports=o.p+"0e2884683166703683ab.png"},4997:(e,t,o)=>{o.r(t),o.d(t,{default:()=>w});const{slice:n,forEach:i}=[];const r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,a={create(e,t,o,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};o&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*o*1e3)),n&&(i.domain=n),document.cookie=function(e,t){const o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/"};let n=`${e}=${encodeURIComponent(t)}`;if(o.maxAge>0){const e=o.maxAge-0;if(Number.isNaN(e))throw new Error("maxAge should be a Number");n+=`; Max-Age=${Math.floor(e)}`}if(o.domain){if(!r.test(o.domain))throw new TypeError("option domain is invalid");n+=`; Domain=${o.domain}`}if(o.path){if(!r.test(o.path))throw new TypeError("option path is invalid");n+=`; Path=${o.path}`}if(o.expires){if("function"!=typeof o.expires.toUTCString)throw new TypeError("option expires is invalid");n+=`; Expires=${o.expires.toUTCString()}`}if(o.httpOnly&&(n+="; HttpOnly"),o.secure&&(n+="; Secure"),o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o.partitioned&&(n+="; Partitioned"),n}(e,encodeURIComponent(t),i)},read(e){const t=`${e}=`,o=document.cookie.split(";");for(let e=0;e<o.length;e++){let n=o[e];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null},remove(e){this.create(e,"",-1)}};var s={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&"undefined"!=typeof document)return a.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:o,cookieMinutes:n,cookieDomain:i,cookieOptions:r}=t;o&&"undefined"!=typeof document&&a.create(o,e,n,i,r)}},l={name:"querystring",lookup(e){let t,{lookupQuerystring:o}=e;if("undefined"!=typeof window){let{search:e}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(e=window.location.hash.substring(window.location.hash.indexOf("?")));const n=e.substring(1).split("&");for(let e=0;e<n.length;e++){const i=n[e].indexOf("=");if(i>0){n[e].substring(0,i)===o&&(t=n[e].substring(i+1))}}}return t}};let d=null;const c=()=>{if(null!==d)return d;try{if(d="undefined"!=typeof window&&null!==window.localStorage,!d)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){d=!1}return d};var u={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&c())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:o}=t;o&&c()&&window.localStorage.setItem(o,e)}};let p=null;const g=()=>{if(null!==p)return p;try{if(p="undefined"!=typeof window&&null!==window.sessionStorage,!p)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){p=!1}return p};var h={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&g())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:o}=t;o&&g()&&window.sessionStorage.setItem(o,e)}},f={name:"navigator",lookup(e){const t=[];if("undefined"!=typeof navigator){const{languages:e,userLanguage:o,language:n}=navigator;if(e)for(let o=0;o<e.length;o++)t.push(e[o]);o&&t.push(o),n&&t.push(n)}return t.length>0?t:void 0}},m={name:"htmlTag",lookup(e){let t,{htmlTag:o}=e;const n=o||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(t=n.getAttribute("lang")),t}},y={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if("undefined"==typeof window)return;const o=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(!Array.isArray(o))return;const n="number"==typeof t?t:0;return o[n]?.replace("/","")}},O={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const o="number"==typeof t?t+1:1,n="undefined"!=typeof window&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[o]}};let _=!1;try{document.cookie,_=!0}catch(e){}const b=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];_||b.splice(1,1);class w{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{languageUtils:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(e){return i.call(n.call(arguments,1),(t=>{if(t)for(const o in t)void 0===e[o]&&(e[o]=t[o])})),e}(t,this.options||{},{order:b,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e}),"string"==typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=e=>e.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=o,this.addDetector(s),this.addDetector(l),this.addDetector(u),this.addDetector(h),this.addDetector(f),this.addDetector(m),this.addDetector(y),this.addDetector(O)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.order,t=[];return e.forEach((e=>{if(this.detectors[e]){let o=this.detectors[e].lookup(this.options);o&&"string"==typeof o&&(o=[o]),o&&(t=t.concat(o))}})),t=t.filter((e=>{return null!=e&&!("string"==typeof(t=e)&&[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some((e=>e.test(t))));var t})).map((e=>this.options.convertDetectedLanguage(e))),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach((t=>{this.detectors[t]&&this.detectors[t].cacheUserLanguage(e,this.options)})))}}w.type="languageDetector"},4362:e=>{e.exports=JSON.parse('{"common":{"million":"Million","average":"Average"},"legend":{"title":"Legend","show_legend":"Show Legend","hide_legend":"Hide Legend","each_dot_is_10k":"Each {{dot}} is ~10,000 people","voters":"Voters","non_voters":"Non-Voters","donated_1_199":"Donated $1-199","donated_200_499":"Donated $200-499","donated_500_999":"Donated $500-999","donated_1000_plus":"Donated $1000+","donated_1_999":"Donated $1-999","above_tax_threshold":"Above Tax Threshold","below_tax_threshold":"Below Tax Threshold","all_donors":"All Donors","with_100_donor_cap":"With $100 Donor Cap","money_donated":"Money Donated","tax_refunds_for_donating":"Tax Refunds for Donating","per_vote_subsidy":"Per-Vote Subsidy","major_federal_parties":"Major Federal Parties","canadian_government":"Canadian Government","category_eligible_voters":"Eligible Voters","category_major_party_donors":"Major Party Donors","category_tax_threshold":"Tax Threshold","category_money_flow":"Money Flow","category_icons":"Icons"},"page":{"title":"Campaign Finance Reform","navigation":{"logo_alt":"Apathy is Boring Logo"}},"masthead":{"headline":"<span class=\'text-mint\'>Big donors</span> are buying political access with <span class=\'text-grape\'>your tax dollars</span>","scroll_instruction":"Scroll to learn how"},"voterIntroduction":{"headline":"Each dot is<br /><span class=\'text-grape\'>10,000 Canadians</span>","description":"These dots show every eligible Canadian voter","legend":{"voters":"Voters","non_voters":"Eligible voters who didn\'t vote"},"annotations":{"all_eligible_voters":"All {{voter_count}} eligible Canadian voters"}},"voterTurnoutVisualization":{"headline":"Roughly <span class=\'text-voter-purple\'>2 in 3</span> eligible Canadians cast a vote in our federal elections","annotations":{"all_voters":"All {{voter_count}} Canadian voters"}},"donorParticipationRates":{"headline":"<span class=\'text-greal\'>Less than 1%</span> of eligible voters donate to federal political parties","description":"As of 2025, the maximum an individual can donate to a political party is <b>$1750</b>, and increases by <b>$25</b> each year","annotations":{"all_donors":"All {{donor_count}} Donors to Major Federal Parties"}},"superdonorEmphasis":{"headline":"And only a handful of them donate <span class=\'text-gold\'>big</span>","description":"Just <b>0.05% of eligible voters</b> donate more than $1000 to parties, yet this group accounts for <b>almost a third of the <i>total</i> donations</b>","financial_context":"And that\'s no surprise, with <a class=\'source-citation\' href=\'https://www150.statcan.gc.ca/n1/daily-quotidien/230213/dq230213b-eng.htm\' target=\'_blank\'><b>26% of Canadians</b> unable to cover an unexpected <b>$500 expense</b></a>","annotations":{"superdonors":{"title":"Superdonors","label":"These are the donors who give over $1000"}}},"donationBreakdownByAmount":{"headline":"Let\'s look closer at how parties get their <span class=\'text-mint\'>money</span>","description":"This <b><span class=\'green-highlighter text-mint\'>big green line</span></b> shows all the donations, going from donors to parties","small_donations":"Most of those donors make relatively small contributions of between <b><span class=\'inline-voter-dot blue\'></span><span class=\'text-voter-blue darken\'>$1-$199</span></b>","medium_donations":"Larger donations are less common.&nbsp;There are fewer donors in the <b><span class=\'inline-voter-dot teal\'></span><span class=\'text-voter-teal darken\'>$200-$499</span></b> group","large_donations":", and fewer still in the <b><span class=\'inline-voter-dot cyan\'></span><span class=\'text-voter-cyan darken\'>$500-$999</span></b> group.","annotations":{"individual_donation_amount":"Individual Donation Amount:","donors_1_199":"$1-199","donors_200_plus":"$200+","donors_200_to_499":"$200-499","donors_500_to_999":"$500-999","donors_1000_plus":"$1000+","donors_500_plus":"$500+","all_donors":"All Donors","donations":"Donations","donations_label":"The thickness of this line corresponds to the amount donated","total_donations":"Total Donations:","all_major_federal_political_parties":"All Major Federal Political Parties","all_major_federal_political_parties_label":"This icon represents the parties receiving donations from individual donors","of_all_donations":"{{percentage_amount}} of all donations"}},"superdonorImpactOnFunding":{"headline":"<span class=\'inline-voter-dot gold\'></span> <span class=\'text-gold\'>Superdonors</span> donate big","description":"Despite being fewest in number, superdonors are responsible for about a third of all the money donated to parties, with an outsized affect on the parties\' finances","annotations":{"superdonors_make_up_just":"Superdonors make up just {{percentage_amount}} of all donors","that_s":"That\'s {{count_amount}} people","but_contribute":"But contribute {{percentage_amount}} of the total money donated","that_s_money":"That\'s ${{amount_amount}}"}},"partiesFocusOnSuperdonors":{"headline1":"Parties rely on <span class=\'text-gold\'>superdonors</span> for funding","headline2":"so that\'s where they focus their fundraising efforts","description":"Their top funders couldn\'t fill an NHL arena","annotations":{"nhl_arena_title":"18,000-Seat NHL Arena","nhl_arena_label":"If every single Superdonor in Canada went to the same hockey game, they\'d fill just 77% of the seats","donors_1_999":"$1-$999","donors_1000_plus":"$1000+"}},"donationsCreateAccess":{"headline":"<span class=\'text-mint\'>Money buys access</span><br />Access can lead to <span class=\'text-grape\'>influence</span>","description":"Superdonors connect directly with powerful politicians at private, high-dollar fundraisers","pattern_notice":"These engagements come with a hefty price tag for attendees — see if you can spot the pattern in the ticket costs","liberal_event":"Max Legal Donation in 2023: <b>$1700</b>","conservative_event":"Max Legal Donation in 2024: <b>$1725</b>","annotations":{"the_inner_circle_title":"The Inner Circle","the_inner_circle_label":"Parties frequently host private events for large donors","on_the_outside_title":"On the Outside","on_the_outside_label":"The overwhelming majority of donors can\'t compete"}},"superdonorInnerCircle":{"headline":"Our current system creates an exclusive club of <span class=\'text-gold\'>superdonors</span><span class=\'inline-voter-dot gold\'></span>","description":"This small handful of Canadians has outsized influence on the priorities and platforms of the major political parties"},"majorityExcludedFromAccess":{"headline":"Leaving <span class=\'text-voter-purple\'>most Canadians</span> on the outside, looking in"},"taxCreditSystemSetup":{"headline1":"But it\'s not even as simple as the <span class=\'text-gold\'>superdonors</span> buying private access","headline2":"<span class=\'text-grape\'>We <u>all</u> subsidize their political donations</span>","description":"Let\'s explore how the tax system benefits superdonors with <i>our money</i>"},"donationTaxCreditFlow":{"headline1":"If you <span class=\'text-mint green-highlighter\'>donate...</span>","headline2":"then you get a <span class=\'text-mint blue-highlighter\'>tax credit</span>","annotations":{"donations":"Donations: ${{amount_amount}}","donations_label":"Donations made to parties by individual donors","tax_credits":"Tax Credits: ${{amount_amount}}","tax_credits_label":"Public money given back to donors through the Federal Political Contributions Tax Credit"}},"outOfPocketDonationCosts":{"headline":"So only part of your donation ends up being <span class=\'text-mint green-highlighter\'>out-of-pocket</span>","description":"You get the rest <span class=\'blue-highlighter\'>back on your taxes</span>","annotations":{"out_of_pocket":"Out-of-Pocket: ${{amount_amount}}","out_of_pocket_label":"You had to spend some of your own money, even after the tax credit","subsidized_amount":"Subsidized Amount: ${{amount_amount}}","subsidized_amount_label":"But the tax credit still covers a lot of your donation"}},"superdonorTaxCreditShare":{"headline":"You can see how a third of the <span class=\'blue-highlighter\'>tax credit</span> flows back to the <span class=\'text-gold\'>superdonors</span>","annotations":{"superdonor_public_money_title":"{{percentage_amount}} of Public Money","superdonor_public_money_label":"About a third of the tax credits go back to the superdonors","out_of_pocket_title":"{{amount_amount}}","out_of_pocket_label":"So despite their large donations, they pay a relatively small portion of their own money ({{percentage_amount}} of their donation)","subsidized_amount_title":"{{amount_amount}}","subsidized_amount_label":"And the rest is covered by the taxpayer — subsidizing not only their donation, but also the access it buys them"}},"reformProposalIntroduction":{"headline":"So what can we do to change it?","description":"We\'ve got two exciting ideas."},"currentDonationLimitFocusAlt":{"headline":"<span class=\'text-voter-purple\'>First Big Idea:</span><br/>We reduce the donation limit to <span class=\'text-mint\'>$100</span>","description1":"Right now, parties only connect with a handful of donors to fundraise, relying on a small number of people to get most of the way there.","description2":"This isn\'t a radical idea — it\'s been the case in Quebec for a long time, and even <a class=\'source-citation red\' href=\'https://www.theglobeandmail.com/opinion/editorials/article-cash-for-access-was-fading-from-canadian-politics-now-its-making-a/\' target=\'_blank\'>The Globe and Mail</a> has called for a country-wide $100 limit.","citation_text":"2021 Globe and Mail editorial calling for a country-wide $100 limit","annotations":{"fundraising_focus_title":"Fundraising Focus","fundraising_focus_label":"With the current donation limits, parties only need to appeal to this many people to fundraise"}},"reducedLimitMoreDonorsAlt":{"headline":"A <span class=\'text-gold\'>$100</span> limit forces parties to connect with — and listen to — <span class=\'text-grape\'>many more voters</span> to earn donations","description":"Lower the cap to what everyday people can afford, and we eliminate the outsized influence of superdonors in political finance. Right now, the median donation is just <b>$60-90/year</b>.","annotations":{"double_the_donors_title":"Double the Donors","double_the_donors_label":"With a $100 cap, parties would need to attract twice as many donors to make the same amount of money"}},"eliminateTaxCreditQuestion":{"headline":"What about the <span class=\'text-mint\'>tax credit</span>?","description1":"With a $100 donation limit, we can <b>eliminate the tax credit</b> for political donations,","description2":" freeing up all that public money for the second big idea...","annotations":{"eliminate_tax_credit_title":"Eliminate the Tax Credit","eliminate_tax_credit_label":"We have a better idea for this money"}},"perVoteSubsidyIntroduction":{"headline":"<span class=\'text-voter-purple\'>Second Big Idea:</span><br/>We bring back the <span class=\'text-mint\'>per-vote-subsidy</span>","description":"With the tax credit eliminated from political donations, public funds should be distributed based on voter support at the ballot box.","annotations":{"per_vote_subsidy_title":"Per-Vote Subsidy","per_vote_subsidy_label":"For every vote a party gets, they get a small amount of public funding — Say around $2 per year"}},"perVoteSubsidyAlignment":{"headline":"This ensures that the public <span class=\'text-mint\'>funding</span> is aligned with the public <span class=\'text-grape\'>voting</span>","description1":"Under a per-vote subsidy, every voter becomes a donor, which means:","formula":"<i>vote distribution = taxpayer money distribution</i>"},"perVoteSubsidyImpact":{"headline":"So not only does your vote count in <span class=\'text-mint\'>choosing your MP</span>, but it also counts towards how the party you supported <span class=\'text-grape\'>fundraises</span>","description":"Parties are rewarded with more funding for every vote they earn.","annotations":{"the_current_system_title":"The Current System","the_current_system_label":"Wouldn\'t it be nice if we could all have an equal influence on the outcome of an election, instead of needing to spend a lot of money to have our voices heard?"}},"reformImpactOnEngagement":{"headline":"How might political <span class=\'text-mint\'>finance reform</span> change the way <span class=\'text-grape\'>you</span> think about political donations and voting?","description":"If parties had to fundraise by engaging a high volume of small donors and increasing voter turnout, they might be more responsive to the needs of Canadians."},"callToAction":{"description1":"Join a public interest campaign that\'s all about helping our democracy — and our politics in Canada - Grow Up!","description2":"We\'re building power and calling on our leaders to make our democracy better, so we can make better decisions about our future.","cta_link":"Get involved now to make our democracy better"},"footer":{"about_headline":"About this visualization:","data_source":"Data presented was compiled by <a class=\'text-mint\' href=\'https://www.democracywatch.ca/\' target=\'_blank\'>Democracy Watch</a> from reports published by Elections Canada, Statistics Canada, and the Canada Revenue Agency.","inclusion_note":"Donations to the Liberals, Conservatives, NDP, Greens, Bloc Quebecois, and Peoples Party have been included in the federal party visualizations, donations to smaller political parties are not included.","tax_credit_note":"The distribution of tax credits to small and large donors is an estimate made by assuming all large donors (over $1000 donated) claim the full tax credit amount.","voter_turnout_note":"Voter turnout data for years without elections uses numbers from the most recent prior year with an election.","further_reading":"Further reading:","reading_link_0":"Donations from affluent urban ridings grease the wheels of politics, new analysis suggests (IJF)","reading_link1":"The richest 10% of federal candidates now get more donations than all others combined (IJF)","reading_link2":"Federal Liberals quietly return to hosting fundraisers in private residences, breaking 2017 promise (IJF)","reading_link3":"Vancouver is a hot spot for political donations, new analysis suggests (IJF)","avo_credit":"Data visualization by"}}')},9633:e=>{e.exports=JSON.parse('{"common":{"million":"Million","average":"Moyenne"},"legend":{"title":"Légende","show_legend":"Afficher la légende","hide_legend":"Masquer la légende","each_dot_is_10k":"Chaque {{dot}} représente ~10 000 personnes","voters":"Électeurs","non_voters":"Non-électeurs","donated_1_199":"A donné de 1 $ à 199 $","donated_200_499":"A donné de 200 $ à 499 $","donated_500_999":"A donné de 500 $ à 999 $","donated_1000_plus":"A donné +1 000 $","donated_1_999":"A donné de 1 $ à 999 $","above_tax_threshold":"Au-dessus du seuil d\'imposition","below_tax_threshold":"Sous le seuil d\'imposition","all_donors":"Tous les donateurs","with_100_donor_cap":"Avec plafond de don de 100 $","money_donated":"Argent donné","tax_refunds_for_donating":"Crédits d\'impôt pour les dons","per_vote_subsidy":"Subvention par vote","major_federal_parties":"Principaux partis fédéraux","canadian_government":"Gouvernement canadien","category_eligible_voters":"Électeurs admissibles","category_major_party_donors":"Donateurs aux grands partis","category_tax_threshold":"Seuil d\'imposition","category_money_flow":"Flux monétaire","category_icons":"Icônes"},"page":{"title":"Réforme du financement des campagnes","navigation":{"logo_alt":"Logo de L\'apathie c\'est plate"}},"masthead":{"headline":"Les gros donateurs achètent l\'accès politique avec vos impôts","scroll_instruction":"Faites défiler pour savoir comment"},"voterIntroduction":{"headline":"Chaque point représente 10 000 Canadiens","description":"Ces points représentent tous les électeurs canadiens admissibles","legend":{"voters":"Électeurs","non_voters":"Électeurs admissibles qui n\'ont pas voté"},"annotations":{"all_eligible_voters":"Tous les {{voter_count}} électeurs canadiens admissibles"}},"voterTurnoutVisualization":{"headline":"Environ 2 Canadiens admissibles sur 3 votent aux élections fédérales","annotations":{"all_voters":"Tous les {{voter_count}} électeurs canadiens"}},"donorParticipationRates":{"headline":"Moins de 1 % des électeurs admissibles font des dons aux partis politiques fédéraux","description":"Depuis 2025, le don maximal qu\'un individu peut faire à un parti politique est de 1 750 $, et ce montant augmente de 25 $ par année","annotations":{"all_donors":"Tous les {{donor_count}} donateurs aux grands partis fédéraux"}},"superdonorEmphasis":{"headline":"Et seule une poignée d\'entre eux fait des dons importants","description":"Seul 0,05 % des électeurs admissibles donnent plus de 1 000 $ aux partis, mais ce petit groupe représente presque le tiers des dons totaux","financial_context":"Et ce n\'est pas surprenant, puisque 26 % des Canadiens ne peuvent pas faire face à une dépense imprévue de 500 $","annotations":{"superdonors":{"title":"Super-donateurs","label":"Voici les donateurs qui donnent plus de 1 000 $"}}},"donationBreakdownByAmount":{"headline":"Voyons de plus près comment les partis obtiennent leur financement","description":"Cette grande ligne verte montre tous les dons, allant des donateurs vers les partis","small_donations":"La majorité des donateurs font des contributions relativement modestes, entre 1 $ et 199 $","medium_donations":"Les dons plus élevés sont moins fréquents. Il y a moins de donateurs dans le groupe de 200 $ à 499 $","large_donations":", et encore moins dans le groupe de 500 $ à 999 $.","annotations":{"individual_donation_amount":"Montant du don individuel :","donors_1_199":"1 $ à 199 $","donors_200_plus":"200 $ et plus","donors_200_to_499":"200 $ à 499 $","donors_500_to_999":"500 $ à 999 $","donors_1000_plus":"1 000 $","donors_500_plus":"500$","all_donors":"Tous les donateurs","donations":"Dons","donations_label":"L\'épaisseur de cette ligne correspond au montant donné","total_donations":"Total des dons :","all_major_federal_political_parties":"Tous les grands partis politiques fédéraux","all_major_federal_political_parties_label":"Cette icône représente les partis recevant des dons de donateurs individuels","of_all_donations":"{{percentage_amount}} de tous les dons"}},"superdonorImpactOnFunding":{"headline":"Les super-donateurs donnent beaucoup","description":"Même s\'ils sont peu nombreux, les super-donateurs sont responsables d\'environ un tiers de tout l\'argent donné aux partis, ce qui a une incidence démesurée sur leurs finances","annotations":{"superdonors_make_up_just":"Les super-donateurs ne représentent que {{percentage_amount}} de l\'ensemble des donateurs","that_s":"C\'est {{count_amount}} personnes","but_contribute":"Mais contribuer {{percentage_amount}} de l\'argent total donné","that_s_money":"C\'est {{amount_amount}}"}},"partiesFocusOnSuperdonors":{"headline1":"Les partis s\'appuient sur les super-donateurs pour leur financement","headline2":"C\'est donc là qu\'ils concentrent leurs efforts de collecte de fonds","description":"Leurs principaux bailleurs de fonds ne pourraient pas remplir un stade de la LNH","annotations":{"nhl_arena_title":"18 000 places dans le stade de la LNH","nhl_arena_label":"Si chaque super-donateur au Canada allait au même match de hockey, ils rempliraient seulement 77 % des sièges","donors_1_999":"1 $ à 999 $","donors_1000_plus":"1 000 $ et plus"}},"donationsCreateAccess":{"headline":"L\'argent achète l\'accès. L\'accès peut conduire à l\'influence.","description":"Les super-donateurs entrent directement en contact avec des politiciens puissants lors de collectes de fonds privées et très lucratives.","pattern_notice":"Ces engagements s\'accompagnent d\'un prix élevé pour les participants – voyez si vous pouvez repérer la tendance dans le prix des billets","liberal_event":"Don légal maximal en 2023 : 1 700 $","conservative_event":"Don légal maximal en 2024 : 1 725 $","annotations":{"the_inner_circle_title":"Le cercle rapproché","the_inner_circle_label":"Les partis organisent fréquemment des événements privés pour les grands donateurs","on_the_outside_title":"À l\'extérieur du cercle","on_the_outside_label":"L\'écrasante majorité des donateurs ne peut pas rivaliser"}},"superdonorInnerCircle":{"headline":"Notre système actuel crée un club exclusif de super-donateurs","description":"Cette petite poignée de Canadiens exerce une influence considérable sur les priorités et les programmes des principaux partis politiques"},"majorityExcludedFromAccess":{"headline":"Laissant la plupart des Canadiens à l\'écart"},"taxCreditSystemSetup":{"headline1":"Mais ce n\'est même pas aussi simple que des super-donateurs qui achètent un accès privé","headline2":"Nous subventionnons tous leurs dons politiques","description":"Voyons comment le système fiscal profite aux super-donateurs avec notre argent"},"donationTaxCreditFlow":{"headline1":"Si vous faites un don…","headline2":"vous bénéficiez alors d\'un crédit d\'impôt","annotations":{"donations":"Dons : {{amount_amount}} $","donations_label":"Dons faits aux partis par des donateurs individuels","tax_credits":"Crédits d\'impôt : {{amount_amount}} $","tax_credits_label":"L\'argent public restitué aux donateurs par le biais du crédit d\'impôt fédéral sur les contributions politiques"}},"outOfPocketDonationCosts":{"headline":"Ainsi, seule une partie de votre don sort réellement de votre poche","description":"Vous récupérez le reste sur vos impôts","annotations":{"out_of_pocket":"Montant réel déboursé : {{amount_amount}} $","out_of_pocket_label":"Vous avez dû dépenser un peu de votre propre argent, même après le crédit d\'impôt","subsidized_amount":"Montant subventionné : {{amount_amount}} $","subsidized_amount_label":"Mais le crédit d\'impôt couvre encore une grande partie de votre don"}},"superdonorTaxCreditShare":{"headline":"On peut voir qu\'un tiers des crédits d\'impôt retourne aux super-donateurs","annotations":{"superdonor_public_money_title":"{{percentage_amount}} de l\'argent public","superdonor_public_money_label":"Environ un tiers des crédits d\'impôt va aux super-donateurs","out_of_pocket_title":"{{amount_amount}}","out_of_pocket_label":"Donc, malgré leurs gros dons, ils paient en réalité une petite partie de leur poche ({{percentage_amount}} de leur don)","subsidized_amount_title":"{{amount_amount}}","subsidized_amount_label":"Et le reste est couvert par les contribuables – subventionnant non seulement leur don, mais aussi l\'accès qu\'il leur procure"}},"reformProposalIntroduction":{"headline":"Que peut-on faire pour changer cela?","description":"Nous avons deux idées prometteuses."},"currentDonationLimitFocusAlt":{"headline":"Première grande idée : réduire la limite des dons à 100 $","description1":"Actuellement, les partis ne contactent qu\'une poignée de donateurs pour recueillir des fonds, dépendant d\'un petit nombre de personnes pour la majorité de leur financement.","description2":"Ce n\'est pas une idée radicale – c\'est déjà le cas au Québec depuis longtemps, et même The Globe and Mail a demandé une limite nationale de 100 $.","citation_text":"Éditorial de 2021 du Globe and Mail appelant à une limite nationale de 100 $","annotations":{"fundraising_focus_title":"Cible de collecte de fonds","fundraising_focus_label":"Avec les plafonds de dons actuels, les partis n\'ont besoin de s\'adresser qu\'à ce nombre de personnes pour collecter des fonds"}},"reducedLimitMoreDonorsAlt":{"headline":"Une limite de 100 $ oblige les partis à rejoindre – et écouter – beaucoup plus d\'électeurs pour récolter des dons","description":"En abaissant le plafond à un montant que les gens ordinaires peuvent se permettre, on élimine l\'influence excessive des super-donateurs dans le financement politique. Actuellement, le don médian est seulement de 60 $ à 90 $ par année","annotations":{"double_the_donors_title":"Doubler le nombre de donateurs","double_the_donors_label":"Avec une limite de 100 $, les partis devront attirer deux fois plus de donateurs pour amasser le même montant"}},"eliminateTaxCreditQuestion":{"headline":"Et le crédit d\'impôt?","description1":"En limitant les dons à 100 $, on pourrait éliminer le crédit d\'impôt pour les dons politiques,","description2":"libérant tout cet argent public pour la deuxième grande idée…","annotations":{"eliminate_tax_credit_title":"Éliminer le crédit d\'impôt","eliminate_tax_credit_label":"Nous avons une meilleure idée pour cet argent"}},"perVoteSubsidyIntroduction":{"headline":"Deuxième grande idée : rétablir la subvention par vote","description":"En éliminant le crédit d\'impôt, les fonds publics seraient redistribués selon le soutien des électeurs dans les urnes","annotations":{"per_vote_subsidy_title":"Subvention par vote","per_vote_subsidy_label":"Pour chaque vote reçu, un parti recevrait un petit montant de financement public – disons environ 2 $ par année"}},"perVoteSubsidyAlignment":{"headline":"Cela garantit que le financement public est aligné avec le soutien des électeurs","description1":"Dans le cadre d\'une subvention par vote, chaque électeur devient un donateur, ce qui signifie que :","formula":"répartition des votes = répartition de l\'argent public"},"perVoteSubsidyImpact":{"headline":"Donc, non seulement votre vote compte pour élire votre député, mais il compte aussi pour financer le parti que vous avez appuyé","description":"Les partis sont récompensés par plus de financement pour chaque vote qu\'ils reçoivent.","annotations":{"the_current_system_title":"Le système actuel","the_current_system_label":"Ne serait-ce pas bien si nous pouvions tous avoir une influence égale sur les résultats électoraux, au lieu d\'avoir à dépenser beaucoup d\'argent pour se faire entendre?"}},"reformImpactOnEngagement":{"headline":"Comment la réforme du financement politique pourrait-elle modifier votre perception des dons politiques et du vote?","description":"Si les partis devaient collecter des fonds en faisant appel à un grand nombre de petits donateurs et en augmentant la participation électorale, ils pourraient être plus sensibles aux besoins des Canadiens."},"callToAction":{"description1":"Rejoignez une campagne d\'intérêt public qui a pour but d\'aider notre démocratie – et notre politique au Canada – à grandir!","description2":"Nous renforçons notre pouvoir et demandons à nos dirigeants d\'améliorer notre démocratie afin que nous puissions prendre de meilleures décisions pour notre avenir.","cta_link":"Participez dès maintenant à l\'amélioration de notre démocratie"},"footer":{"about_headline":"À propos de cette infographie :","data_source":"Les données présentées ont été compilées par Democracy Watch à partir de rapports publiés par Élections Canada, Statistique Canada et l\'Agence du revenu du Canada.","inclusion_note":"Les dons aux libéraux, aux conservateurs, au NPD, aux Verts, au Bloc Québécois et au Peoples Party ont été inclus dans les images des partis fédéraux. Les dons aux partis politiques plus petits ne sont pas inclus.","tax_credit_note":"La répartition des crédits d\'impôt entre les petits et les grands donateurs est une estimation réalisée en supposant que tous les grands donateurs (plus de 1 000 $ de dons) demandent le montant total du crédit d\'impôt.","voter_turnout_note":"Les données sur la participation électorale pour les années sans élections utilisent les chiffres de l\'année précédente la plus récente avec une élection.","further_reading":"Pour aller plus loin :","reading_link_0":"Les dons provenant de circonscriptions urbaines aisées facilitent les rouages de la politique, selon une nouvelle analyse (IJF)","reading_link1":"Les 10 % de candidats fédéraux les plus riches reçoivent désormais plus de dons que tous les autres réunis (IJF)","reading_link2":"Les Libéraux fédéraux reprennent discrètement les collectes de fonds dans des résidences privées, brisant leur promesse de 2017 (IJF)","reading_link3":"Vancouver est un point chaud pour les dons politiques, selon une nouvelle analyse (IJF)","avo_credit":"Données infographiques par"}}')}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={id:n,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.m=e,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),o.b=document.baseURI||self.location.href,o.nc=void 0;o(8156)})();